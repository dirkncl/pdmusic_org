function Debug(e){var t=document.getElementById("debug");MyrIsDefined(t)&&(t.innerHTML=e)}function DebugWait(e){for(var t=(new Date).getTime(),r=t;t+e>r;)r=(new Date).getTime()}function SetLoadTimeOut(e,t,r){MyrIsDefined(t.loadTimer)&&clearTimeout(t.loadTimer),t.loadTimer=e.setTimeout(MyrTimeoutWait,1e3*r,t)}function MyrInitAllAtOnLoad(){var e=myrweb_version.match(/ *([^ ]+) +Build +([^ ]+) +Compiled +[^ ]+ +([^ ]+) +(\d\d?) +(\d?\d:\d?\d)[^ ]+ +(\d+) *$/);MyrWebVersion="v"+e[1]+" Build "+e[2],MyrCtx.debug=MyrCtx.faux,MyrCtx.audioFailSafe=MyrCtx.vrai,MyrCtx.buttons=[0,0,0],MyrCtx.button=0,MyrCtx.myrTab=[],MyrCtx.myrTimer={},MyrCtx.myrTimeOutLoad=20,MyrCtx.svgHeader="<svg xml:space='preserve' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' version='1.1'  text-rendering='geometricPrecision' style='overflow:hidden;' ",MyrCtx.zoomtab=[100,125,150,200,250,300],MyrCtx.myrwebLogo="<defs><path id='wsvgs1' d='M 22.5 98 C 0 78 0 58 0 50 C 0 42 0 22 25 2 C 29 2 43.75 15 50 20 C 56.25 15 71 2 75 2 C 91.5 20 91.5 44 91.5 46 C 91.5 55 91.5 68 75 83 C 85 70 85 55 85 50 C 85 42 85 35 75 15 C 56.25 30 52 33 50 33 C 48 33 43.75 30 25 15  C 6.5 30 6.5 47 6.5 50 C 6.5 54 6.5 80 22.5 98z M 50 82 L 60 90 C 57 88 53 86 50 86 C 47 86 43 88 40 90 L 50 82z '/><g id='myrwebLogo' stroke-linecap='round' stroke-linejoin='round' stroke='#000000' fill-opacity='1' transform='translate(-20 -20) scale(1.4)'><use xlink:href='#wsvgs1' fill='#0000FF' stroke='#0000FF' /><use xlink:href='#wsvgs1' transform='rotate(180 50 50)' fill='#FF0000' stroke='#FF0000'/></g></defs>",MyrPrepareThemes(MyrCtx),document.body.onmousedown=function(e){var t;"which"in(e=e||window.event)?t=3==e.which?2:1:"button"in e&&(t=e.button),3>--t&&0===MyrCtx.buttons[t]&&(++MyrCtx.buttons[t],MyrCtx.button=MyrCtx.buttons[0]+(MyrCtx.buttons[1]<<1)+(MyrCtx.buttons[2]<<2),MyrManageMouse("click"))},document.body.onmouseup=function(e){var t;"which"in(e=e||window.event)?t=3==e.which?2:1:"button"in e&&(t=e.button),3>--t&&1==MyrCtx.buttons[t]&&(--MyrCtx.buttons[t],MyrCtx.button=MyrCtx.buttons[0]+(MyrCtx.buttons[1]<<1)+(MyrCtx.buttons[2]<<2),MyrManageMouse("release"))},document.body.onmousemove=function(e){var t,r;t=(e=e||window.event).clientX,r=e.clientY;for(var o=0;o<MyrCtx.myrTab.length;o++){var a=MyrCtx.myrTab[o].unclippedFather.getBoundingClientRect();t>=a.left&&t<=a.right&&r>=a.top&&r<=a.bottom?MyrCtx.myrTab[o].mouse.inObj=MyrCtx.vrai:MyrCtx.myrTab[o].mouse.inObj=MyrCtx.faux,MyrCtx.myrTab[o].mouse.x=t-a.left,MyrCtx.myrTab[o].mouse.y=r-a.top,MyrManageMouseOnObj(MyrCtx.myrTab[o],"move")}},function(e,t,r){e.addEventListener?e.addEventListener(t,r,MyrCtx.faux):e.attachEvent&&e.attachEvent("on"+t,r)}(document,"mouseout",function(e){null!==e.relatedTarget&&null!==e.toElement||(MyrManageMouse("release"),MyrCtx.button=MyrCtx.buttons[0]=MyrCtx.buttons[1]=MyrCtx.buttons[2]=0)});var t=document.getElementsByClassName("myrweb");if(t&&t.length){for(var r=0;r<t.length;r++){var o={};console.time("Browsing page"),MyrCtx.myrTab.push(o),o.index=r,MyrMenuNew(o,"popup"),o.sync={},o.sync.displayMode="line",o.sound={},o.sound.playState=MyrCtx.STATE_STOPPED,o.sound.runtime={},o.sound.duration=0,o.sound.playMode={},o.sound.playMode.metronome={},o.sound.playMode.metronome.before=o.sound.playMode.metronome.bar=o.sound.playMode.metronome.beat=MyrCtx.faux,o.sound.playMode.metronome.volume=.5,o.sound.playMode.detune=o.sound.playMode.scheduleddetune=0,o.sound.playMode.tempo=o.sound.playMode.scheduledtempo=1,o.sound.playMode.loopMode=0,o.file=[],o.focus=MyrCtx.faux,o.toolfocus=null,o.mouse={},o.mouse.x=o.mouse.y=o.mouse.clickx=o.mouse.clicky=o.mouse.clicktime=0,o.mouse.stilldown=o.mouse.inObj=MyrCtx.faux,o.mouse.clickedtype="",o.mouse.clickeddata="",t[r].onmouseout=function(e){},t[r].oncontextmenu=function(e){return Debug("CONTEXT MENU"),!1},t[r].onmousedown=function(e){Debug("START CLICK")},t[r].onmouseup=function(e){Debug("END CLICK")},t[r].setAttribute("tabindex",1e3+r),t[r].onkeypress=function(e){return MyrManageKeyPress(this,e,"key")},t[r].onkeydown=function(e){return MyrManageKeyPress(this,e,"ctrlkey")},t[r].onfocus=function(e){return MyrManageKeyPress(this,e,"focus")},t[r].onblur=function(e){return MyrManageKeyPress(this,e,"out")},o.origwidth=o.width=t[r].clientWidth,o.origheight=o.height=t[r].clientHeight,0===o.origheight&&(o.origwidth=o.width=800,o.origheight=o.height=250,t[r].style.width=o.width+"px",t[r].style.height=o.height+"px"),o.args={},o.unclippedFather=t[r],MyrSetUndraggable(o.unclippedFather);var a=o.unclippedFather.dataset.id;if(MyrIsDefined(a)&&(o.inlinedata=window[a],window[a]=null),MyrIsDefined(o.inlinedata)||(o.inlinedata=o.unclippedFather.dataset.b64,o.unclippedFather.dataset.b64=null,MyrIsDefined(o.inlinedata)),o.inlinedata){var n=o.unclippedFather.getElementsByClassName("myrweb-b64");MyrIsDefined(n)&&(n=n[0]),MyrIsDefined(n)&&n.nodeName.match(/\bDIV\b/i)&&(o.inlinedata=n.innerText||n.textContent)}o.unclippedFather.innerHTML="",MyrCompleteStyle(o.unclippedFather,"overflow:visible;position:relative;border:solid 1px"),o.fatherDiv=MyrCreateUndraggableElement("div"),MyrCompleteStyle(o.fatherDiv,"z-index:1;overflow:hidden;position:absolute;left:0px;top:0px;width:"+o.unclippedFather.clientWidth+"px;height:"+o.unclippedFather.clientHeight+"px"),o.unclippedFather.appendChild(o.fatherDiv),o.isLoaded=MyrCtx.faux,o.isError=MyrCtx.faux,console.timeEnd("Browsing page"),MyrStartWait(o),console.time("Load"+o.index),MyrLoadMyrweb(o),SetLoadTimeOut(window,o,MyrCtx.myrTimeOutLoad)}console.timeEnd("Init")}}function MyrDisplayPlayedBar(){var e;for(i=0;i<MyrCtx.myrTab.length;i++)obj=MyrCtx.myrTab[i],obj.sound.playState===MyrCtx.STATE_PLAYING&&"none"!==obj.sync.displayMode&&(e=MyrSoundTime(obj),MyrDisplayCurrentPos(obj,e))}function readFileSync(e){let t=null;const r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(),t=r.responseText,document.title=e.split("/").pop().replace("."+e.split(".").pop(),""),t}function fext(e){return e.split(".").pop().toLowerCase()}var ls=window.location.search,myrInput="";myrInput=decodeURIComponent(ls).replace(/\+/g," ").replace("?",""),-1!=myrInput.indexOf("&")&&(myrInput=myrInput.split("&"),myrInput[1]="",myrInput=myrInput[0]),-1==myrInput.indexOf("=")&&"myr"==fext(myrInput)||(myrInput="");var myriadFile=readFileSync(myrInput||"song/Fair_As_The_Morning.myr");function MyrStopDisplayNumber(e){MyrIsDefined(e.counterDiv)&&e.counterDiv.parentElement.removeChild(e.counterDiv),e.counterDiv=null}function MyrDisplayNumber(e,t,r,o,a){var n=e.width*e.page.zoom/e.page.pagewidth;r=parseInt(r)*n,o=parseInt((o-e.page.xoffset)*n),a=parseInt((a-e.page.yoffset)*n),MyrStopDisplayNumber(e),e.counterDiv=MyrCreateUndraggableElement("div"),MyrCompleteStyle(e.counterDiv,"z-index:9999;overflow:hidden;position:absolute;left:"+(o-50)+"px;top:"+(a-50)+"px;width:100px;height:100px;");var i=e.index+"-counter",s=MyrCtx.svgHeader+"width='100' height='100' viewBox='-50 -50 100 100'><text id='"+i+"' ";s+="x='0' y='0' font-family='Verdana' font-size='"+r+"' font-weight='bold' text-anchor='middle' dominant-baseline='middle' opacity='0.4'>",s+="<animateTransform attributeType='XML' attributeName='transform' type='scale' from='0.5' to='1' begin='0s' dur='0.35s' calcMode='spline' keySplines='0.4, 0, 0.2, 1'/>",s+="<animateTransform attributeType='XML' attributeName='transform' type='scale' from='1' to='0.5' begin='0.45s' dur='0.35s' calcMode='spline' keySplines='0.4, 0, 0.2, 1' />",s+="<animate attributeName='opacity' attributeType='CSS' begin='0s' dur='0.4s' from='0' to='0.4'></animate>",s+="<animate attributeName='opacity' attributeType='CSS' begin='0.4s' dur='0.4s' from='0.4' to='0'></animate>",s+="<animate attributeName='opacity' attributeType='CSS' begin='0.8s' dur='1s' from='0' to='0'></animate>",setTimeout(MyrStopDisplayNumber,750,e),s+=t+"</text></svg>",e.counterDiv.innerHTML=s,e.pageview.div.appendChild(e.counterDiv)}function MyrDisplayCurrentPos(e,t){var r,o,a,n,i,s,l,d=e.sound.playMode.tempo;if(MyrIsDefined(d)||(d=1),t+="bar"==e.sync.displayMode?.2:MyrCtx.NB_MS_POS_MUSIQUE/1e3,e.page.div.height){var y,c;for("view"==e.page.viewType?(s=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score["+e.page.viewIndex+"].AreaList[0].Area"),y=e.sync.area,c=MyrCtx.vrai):(s=MyrSafeGet(e,"Myrweb[0].Graphics[0].Lyrics["+e.page.viewIndex+"].AreaList[0].Area"),y=e.sync.lyrics[e.page.viewIndex].area,c=MyrCtx.faux),r=0,MyrIsDefined(e.sync.lastAreaIndex)&&(0>(r=e.sync.lastAreaIndex)?r=0:r>=y.length&&(r=y.length-1),y[r].time/d>t&&(r=0));r<y.length-1&&y[r+1].time/d<=t;r++);if(MyrIsDefined(s)&&r<y.length&&y[r].time/d<=t){var u=0,f=-1;r<y.length-1&&((f=(y[r+1].time-y[r].time)/d)>0&&(u=(t-y[r].time/d)/f)),u>1?u=1:0>u&&(u=0),o=y[r].areaindex-1;for(var m=1,p=0;r>p;p++)y[p].areaindex==y[r].areaindex&&m++;if(MyrUpdateAnnotations(e,o+u,m),e.sound.lastbar=o+u,MyrIsDefined(a=s[o])){var M=a.Frame[0];if(e.sync.lastAreaIndex!=r){if(c&&M.right<=M.left?M=e.sync.lastAreaBox:e.sync.lastAreaBox=M,e.sync.lastAreaIndex=r,c){for(var g=r+1,h=MyrCtx.vrai;g<y.length&&h==MyrCtx.vrai;){var v=s[y[g].areaindex-1];MyrIsDefined(v)&&(v.Frame[0].left>=v.Frame[0].right||v.Frame[0].left==M.left&&v.Frame[0].top==M.top)?g++:h=MyrCtx.faux}g-r>1&&MyrDisplayNumber(e,g-r,35,(M.right+M.left)/2,(M.bottom+M.top)/2-25)}}else M=e.sync.lastAreaBox;(n=a.Long[0].value-1)!=e.page.currentPage&&MyrDisplayPage(e,n,MyrCtx.faux),i=e.width*e.page.zoom/e.page.pagewidth;var b,x=MyrCtx.faux;if(MyrIsDefined(e.sync.lastarea)||(e.sync.lastarea={left:-1,right:-1}),(M.left<e.sync.lastarea.left||M.top!=e.sync.lastarea.top)&&(x=MyrCtx.vrai),x!==e.sync.isImmediate)b=x?0:MyrCtx.NB_MS_POS_MUSIQUE/1e3,MyrSetTransition(e,e.page.divcursor,"all "+b+"s "+("bar"==e.sync.displayMode?"ease":"linear")),e.sync.isImmediate=x;if("bar"==e.sync.displayMode)e.sync.lastarea.left==M.left&&e.sync.lastarea.top==M.top||(MyrSetDivPos(e.page.divcursor,(n*e.page.pagewidth+M.left)*i,M.top*i),0>=(l=M.right-M.left)&&(l=2),MyrSetDivSize(e.page.divcursor,l*i,(M.bottom-M.top)*i));else if(r<y.length-1){var D,P=n*e.page.pagewidth+M.left+(M.right-M.left)*(t-y[r].time/d)/(y[r+1].time/d-y[r].time/d);D=MyrIsDefined(e.args.playmarkerwidth)?e.args.playmarkerwidth:8,MyrSetDivPos(e.page.divcursor,(P-D/2)*i,M.top*i),MyrSetDivSize(e.page.divcursor,D*i,(M.bottom-M.top)*i)}e.sync.lastarea.left=M.left,e.sync.lastarea.top=M.top,MyrAutoView(e,M)}}}e.keyboard.div.height&&MyrKbdManage(e,MyrSoundTime(e))}function MyrAutoView(e,t){var r={};if(r.left=e.page.xoffset,r.top=e.page.yoffset,r.right=r.left+e.page.pagewidth/e.page.zoom,r.bottom=r.top+e.page.pagewidth*e.pageview.div.height/(e.pageview.div.width*e.page.zoom),dleft=t.left-r.left,dright=r.right-t.right,dtop=t.top-r.top,dbottom=r.bottom-t.bottom,dleft<0||dright<0||dtop<0||dbottom<0){var o=0,a=0;dleft<0?o=dright>-dleft?dleft:(dleft-dright)/2:dright<0&&(o=dleft>-dright?-dright:(dleft-dright)/2),dtop<0?a=dbottom>-dtop?dtop:(dtop-dbottom)/2:dbottom<0&&(a=dtop>-dbottom?-dbottom:(dtop-dbottom)/2),0===o&&0===a||(e.page.xoffset+=o,e.page.yoffset+=a,MyrApplyZoomOffsetToPage(e,MyrCtx.faux,MyrCtx.faux))}var n=document.activeElement;if(!e.sync.touchedscroll&&e.sync.autoscroll&&MyrIsDefined(e.page.divcursor)&&(n==e.fatherDiv||n==e.unclippedFather)){var i=e.page.divcursor.getBoundingClientRect();if(i.top<0||i.left<0||i.bottom>(window.innerHeight||document.documentElement.clientHeight)||i.right>(window.innerWidth||document.documentElement.clientWidth)){var s=0,l=0;i.top<0?l=-i.top:i.bottom>(window.innerHeight||document.documentElement.clientHeight)&&(l=(window.innerHeight||document.documentElement.clientHeight)-i.bottom),i.left<0?s=-i.left:i.right>(window.innerWidth||document.documentElement.clientWidth)&&(s=(window.innerWidth||document.documentElement.clientWidth)-i.right),window.scrollBy(-s,-l)}var d=document.documentElement,y=(window.pageXOffset||d.scrollLeft)-(d.clientLeft||0),c=(window.pageYOffset||d.scrollTop)-(d.clientTop||0);e.sync.lastscrollposx>=0&&e.sync.lastscrollposx!=y||e.sync.lastscrollposy>=0&&e.sync.lastscrollposy!=c?e.sync.touchedscroll=MyrCtx.vrai:(e.sync.lastscrollposx=y,e.sync.lastscrollposy=c)}}function MyrDownloadData(e,t,r,o){var a=new Blob([r],{type:t}),n=navigator.userAgent.toLowerCase().indexOf("firefox")>-1;if("http"!=window.location.href.substr(0,4)&&(o=MyrCtx.faux),MyrIsDefined(o)&&o||!navigator.msSaveBlob)if(MyrIsDefined(o)&&o&&navigator.msSaveOrOpenBlob)navigator.msSaveOrOpenBlob(a,e);else{var i=URL.createObjectURL(a),s=document.createElement("a");s.type=t,s.href=i,s.style.visibility="hidden",n||MyrIsDefined(o)&&o||!MyrIsDefined(s.download)?(s.download=e,s.target="_blank"):s.download=e,document.body.appendChild(s),s.click(),document.body.removeChild(s)}else navigator.msSaveBlob(a,e)}function MyrAction(e,t){function r(e,t,r,o){MyrIsDefined(o)&&(MyrDlogAddItem(e,p,"fontWeight: bold;color: #606060"," "+r+" ","---",0,null,"newline left middle",0,0),MyrDlogAddItem(e,p,"static",o,"---",0,null,"right middle",0,0))}var o,a=t.split(" ");switch(t=a[0].trim(),MyrIsDefined(a[1])?(o=a[1].trim()).match(/^[0-9\-+]/)&&(o=o.match(/\./)?parseFloat(o):parseInt(o)):o=null,t){case"action_zoom":MyrSetPageZoom(e,o/100,MyrCtx.faux);break;case"action_page":break;case"action_displaybars":e.page.displaybars=o,MyrCreateBarNum(e);break;case"action_viewpart":MyrSetDisplayView(e,"view",o);break;case"action_viewlyrics":MyrSetDisplayView(e,"lyrics",o);break;case"action_volume":MyrSoundSetGeneralVolume(e,o);break;case"action_metronomebefore":e.sound.playMode.metronome.before^=MyrCtx.vrai;break;case"action_metronomebar":e.sound.playMode.metronome.bar^=MyrCtx.vrai,MyrSoundChangeMetronome(e);break;case"action_metronomebeat":e.sound.playMode.metronome.beat^=MyrCtx.vrai,MyrSoundChangeMetronome(e);break;case"action_detune":e.sound.playMode.scheduleddetune=o,MyrSoundChangeData(e);break;case"action_tempo":e.sound.playMode.scheduledtempo=o,MyrSoundChangeData(e);break;case"action_mixer":MyrMixAction(e,parseInt(o),a[2],parseFloat(a[3]));break;case"action_download":MyrDownloadData(e.file[o].name,e.file[o].mime,e.file[o].data,MyrCtx.faux);break;case"action_print":var n=e.page.divgraph.innerHTML,i=e.page.view[e.page.viewIndex],s=[];if(s[0]="",MyrIsDefined(o)&&o>0)for(var l=0;l<i.anno.length;l++)if(i.anno[l].alphaMusicNo>0){var d=i.anno[l].str,y=d.match(/<defs>([\s\S]*)<\/defs>/i);MyrIsDefined(y)&&(s[0]+=y[1]+"\n");var c=d.match(/<\/defs>([\s\S]*)<\/svg>/i);MyrIsDefined(c)&&(c="\x3c!-- Annotation "+(l+1)+" --\x3e\n<g opacity='"+i.anno[l].alphaMusicNo+"' transform='translate("+i.anno[l].frame.left+" "+i.anno[l].frame.top+")' >"+c[1]+"</g>\n\x3c!-- Fin Annotation "+(l+1)+" --\x3e\n",MyrIsDefined(s[i.anno[l].numPage+1])||(s[i.anno[l].numPage+1]=""),s[i.anno[l].numPage+1]+=c)}var u=DoConvertSVGtoPDF(n,e.nbPages,s);n=null;var f=MyrSafeGet(e,"Myrweb[0].Header[0].$name");MyrIsDefined(f)||(f="untitled"),MyrDownloadData(f=f.replace(/\.[^\.]*$/,"")+".pdf","application/pdf",u,MyrCtx.vrai),u=null;break;case"action_info":if((p=MyrDlogGetDlogIndexByTag(e,"system_info"))>=0)MyrDlogClose(e,"system_info");else if((p=MyrDlogNew(e,"system_info",MyrThemeGetRawIcon(e,e.theme.info,25,25,2,2,2,2,.6,2,"#000000","#E0E0E0"),MyrCtx.vrai))>=0){var m=myrweb_version.match(/ *([^ ]+) +Build +([^ ]+) +Compiled +[^ ]+ +([^ ]+) +(\d\d?) +(\d?\d:\d?\d)[^ ]+ +(\d+) *$/);MyrDlogAddItem(e,p,"fontWeight: bold","Myrweb App","mwstat",0,null,"newline center middle",0,0),MyrDlogAddItem(e,p,"static","Version: ","verstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,p,"static",m[1],"verval",0,null,"right middle",0,0),MyrDlogAddItem(e,p,"static","Build: ","buildstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,p,"static",m[2],"buildval",0,null,"right middle",0,0),MyrDlogAddItem(e,p,"static",MyrThemeGetRawIcon(e,e.theme.calendar,18,18,2,0,0,0,1,2,"#606060","#606060"),"compstat",0,null,"newline left middle",0,0),MyrDlogAddItem(e,p,"static",m[3]+" "+m[4]+" "+m[6]+", "+m[5],"compval",0,null,"right middle",0,0),MyrDlogAddItem(e,p,"fontSize: smaller",MyrWebCopyright,"copystat",0,null,"newline right middle",0,10),MyrDlogOpen(e,p,e.unclippedFather,"right top persistent",-10,e.toolheight,e.theme)}break;case"action_fileinfo":var p;if((p=MyrDlogGetDlogIndexByTag(e,"file_info"))>=0)MyrDlogClose(e,"file_info");else{var M=MyrSafeGet(e,"Myrweb[0].Header[0].$title");if(M=MyrStrLimit(M,30),(p=MyrDlogNew(e,"file_info",MyrThemeGetRawIcon(e,e.theme.fileinfo,20,20,0,-1,0,-1,.6,2,"#000000","#A0A0A0")+" "+M,MyrCtx.vrai))>=0){var g=MyrSafeGet(e,"Myrweb[0].Header[0].$composer");MyrIsDefined(g)&&MyrDlogAddItem(e,p,"static",MyrStrLimit(g,30),"---",0,null,"newline center middle",0,0);var h=MyrSafeGet(e,"Myrweb[0].Header[0].$remarks");MyrIsDefined(h)&&MyrDlogAddItem(e,p,"fontStyle:italic",MyrStrLimit(h,30),"---",0,null,"newline center middle",0,0);var v=MyrSafeGet(e,"Myrweb[0].Header[0].$email");if(MyrIsDefined(v)){if(v.indexOf("@")>0){var b=v.match(/([+\-\.0-9_A-Za-z]+@[+\-\.0-9_A-Za-z]+\.[+\-\.0-9_A-Za-z]+)/);(v=(v=v.replace(/<?[+\-\.0-9_A-Za-z]+@[+\-\.0-9_A-Za-z]+\.[+\-\.0-9_A-Za-z]+>?/,"")).replace(/[<>\'\"&]/g,"")).length<2&&(v=b[1]),v="<a href='mailto:"+b[1]+"'>"+v+"</a>"}r(e,0,"@",v)}var x=MyrSafeGet(e,"Myrweb[0].Header[0].$duration");if(MyrIsDefined(x)){var D,P,k=e.sound.playMode.tempo;MyrIsDefined(k)||(k=1),x/=1e3,x/=k,D=parseInt(x/3600),P=parseInt((x-3600*D)/60);var w="";D&&(w+=D+"h "),(D||P)&&(w+=P+"mn "),w+=parseInt(x-3600*D-60*P)+"s",r(e,0,MyrThemeGetRawIcon(e,e.theme.duration,17,17,7,2,2,2,1,2,"#606060","#606060"),w)}var F=MyrSafeGet(e,"Myrweb[0].Header[0].$soundBaseLevel");if(F>=0&&6>=F){r(e,0,MyrThemeGetRawIcon(e,e.theme.instrument,30,24,0,0,0,0,1,0,"none","#606060"),["LT","ST","XT","MP","WE","SE","Gold"][F])}if(MyrSafeGet(e,"Myrweb[0].Header[0].$audioQuality")>=0){var C=MyrThemeGetRawIcon(e,e.theme.light,20,24,2,2,2,2,1,2,"none","#606060"),S=MyrThemeGetRawIcon(e,e.theme.heavy,20,20,2,2,2,2,1,2,"#606060","#606060"),T=MyrThemeGetRawIcon(e,e.theme.square,10,10,2,2,2,7,1,2,"#606060","#606060"),I=MyrThemeGetRawIcon(e,e.theme.square,10,10,2,2,2,7,1,2,"#606060","none"),A=MyrSafeGet(e,"Myrweb[0].Header[0].$audioQuality"),L=C+" ";for(l=0;A>=l;l++)L+=T;for(;5>=l;l++)L+=I;r(e,0," MP3",L+=" "+S)}r(e,0,MyrThemeGetRawIcon(e,e.theme.track,25,25,7,2,2,2,1,1.5,"#606060","#606060"),e.sound.track.length),r(e,0,MyrThemeGetRawIcon(e,e.theme.calendar,18,18,7,0,0,0,1,2,"#606060","#606060"),MyrSafeGet(e,"Myrweb[0].Header[0].$date"));var G=MyrThemeGetRawIcon(e,e.theme.powered,18,18,4,2,2,2,1,1,"none","#606060");MyrDlogAddItem(e,p,"fontSize: smaller",G,"---",0,null,"newline left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$appName"))?MyrDlogAddItem(e,p,"fontSize: smaller",MyrSafeGet(e,"Myrweb[0].Header[0].$appName"),"---",0,null,"left middle",0,10):MyrDlogAddItem(e,p,"fontSize: smaller","??","---",0,null,"left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$appVers"))&&MyrDlogAddItem(e,p,"fontSize: smaller"," v"+MyrSafeGet(e,"Myrweb[0].Header[0].$appVers"),"---",0,null,"left middle",0,10),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].$copyright"))?MyrDlogAddItem(e,p,"fontSize: smaller",MyrSafeGet(e,"Myrweb[0].$copyright"),"copystat",0,null,"newline right middle",0,10):MyrDlogAddItem(e,p,"fontSize: smaller",MyrWebCopyright,"copystat",0,null,"newline right middle",0,10),MyrDlogOpen(e,p,e.unclippedFather,"right top persistent",-20,e.toolheight,e.theme)}}break;case"action_playstate":switch(o){case MyrCtx.STATE_PLAYING:switch(e.sound.playState){case MyrCtx.STATE_STOPPED:e.sync.touchedscroll=MyrCtx.faux,e.sync.lastscrollposx=-1,e.sync.lastscrollposy=-1,MyrSoundPlay(e);break;case MyrCtx.STATE_PAUSED:MyrSoundDepause(e);break;case MyrCtx.STATE_PLAYING:MyrSoundStop(e),MyrUpdateAnnotations(e,-1)}break;case MyrCtx.STATE_PAUSED:switch(e.sound.playState){case MyrCtx.STATE_PAUSED:MyrSoundDepause(e);break;case MyrCtx.STATE_PLAYING:MyrSoundPause(e)}break;case MyrCtx.STATE_STOPPED:e.sound.playState!=MyrCtx.STATE_STOPPED&&(MyrSoundStop(e),MyrUpdateAnnotations(e,-1))}break;case"action_playrelpos":MyrSoundRelativeJump(e,o);break;case"action_kbd_octave":e.keyboard.octaveshift=o,MyrKbdDraw(e);break;case"action_kbd_viewstaff":e.sync.staff[o]^=MyrCtx.vrai,MyrKbdDraw(e)}}function MyrManageKeyPress(e,t,r){var o,a,n=!0,i=null;for(o=0;o<MyrCtx.myrTab.length;o++)MyrCtx.myrTab[o].unclippedFather===e&&(i=MyrCtx.myrTab[o]);if(null!==i){if(a=0,"focus"==r){for(i.unclippedFather.style.boxShadow=i.theme.focusshadow,o=0;o<MyrCtx.myrTab.length;o++)MyrCtx.myrTab[o].focus=MyrCtx.faux;i.focus=MyrCtx.vrai,null!==i.toolfocus&&MyrToolbarGainFocus(i,i.toolfocus)}else"out"==r?(i.unclippedFather.style.boxShadow="",i.focus==MyrCtx.vrai&&null!==i.toolfocus&&MyrToolbarLoseFocus(i,i.toolfocus),i.focus=MyrCtx.faux):"ctrlkey"==r?8===t.keyCode||46===t.keyCode||27===t.keyCode||13===t.keyCode?n=MyrToolbarProcessKey(i,i.toolfocus,t.keyCode):a=t.keyCode:(a=t.charCode||t.key||t.keyCode||t.which,i.focus==MyrCtx.vrai&&null!==i.toolfocus&&(n=MyrToolbarProcessKey(i,i.toolfocus,a),a=0));a>0&&(a!=MyrCtx.lastCar||MyrCtx.lastCarTime+125<=(new Date).getTime())&&(MyrCtx.lastCarTime=(new Date).getTime(),MyrCtx.lastCar=a,32==a?(MyrAction(i,"action_playstate "+MyrCtx.STATE_PLAYING),MyrToolbarUpdate(i),n=!1):37==a?(i.sound.playState==MyrCtx.STATE_PLAYING?(MyrAction(i,"action_playrelpos -1"),MyrToolbarUpdate(i)):(target=i.page.currentPage-1,target<0&&(target=0),MyrDisplayPage(i,target,MyrCtx.faux)),n=!1):39==a&&(i.sound.playState==MyrCtx.STATE_PLAYING?(MyrAction(i,"action_playrelpos 1"),MyrToolbarUpdate(i)):(target=i.page.currentPage+1,target>i.nbPages-1&&(target=i.nbPages-1),MyrDisplayPage(i,target,MyrCtx.faux)),n=!1))}return!1===n&&t.preventDefault(),n}function MyrManageMouseOnObj(e,t){var r,o,a,n,i=e.mouse.x,s=e.mouse.y,l=MyrCtx.button,d="",y="";if(1==e.index&&Debug("MOUSE "+t+" X="+i+"Y="+s+" B="+l+" S="+e.mouse.stilldown),d="none",""!==(y=MyrDlogLocate(e,i,s)))d="dlog";else if(MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool)){var c=s;if(c>=0)if(c<e.title.div.height)d="title";else if((c-=e.title.div.height)<e.toolbar.div.height)for(d="tool",r=0;r<e.toolbar.tool.length;r++){var u=e.toolbar.tool[r];i>u.screenleft&&i<u.screenright&&(d="tool",y=r)}else(c-=e.toolbar.div.height)<e.pageview.div.height?(d="page",y=0):(c-=e.pageview.div.height,d="keyboard",y=0)}if("move"==t)if(e.mouse.stilldown)0===e.mouse.dragstate&&(Math.abs(i-e.mouse.clickx)>4||Math.abs(s-e.mouse.clicky)>4)&&(e.mouse.dragstate=1,e.mouse.lastdragx=e.mouse.clickx,e.mouse.lastdragy=e.mouse.clicky),"tool"==e.mouse.clickedtype?"volume"==e.toolbar.tool[e.mouse.clickeddata].tag&&MyrToolbarClickTool(e,e.mouse.clickeddata):"dlog"==e.mouse.clickedtype?(n=e.mouse.clickeddata.split(" "),0===e.mouse.dragstate&&MyrDlogProcessItem("click",e,n[0],n[1]),1==e.mouse.dragstate&&MyrDlogProcessItem("drag",e,n[0],n[1])):"page"==e.mouse.clickedtype&&1==e.mouse.dragstate&&(o=e.mouse.x-e.mouse.lastdragx,a=e.mouse.y-e.mouse.lastdragy,(o||a)&&(MyrIsDefined(e.page.xoffset)||(e.page.xoffset=e.page.yoffset=0),MyrIsDefined(e.page.zoom)||(e.page.zoom=1),o=o*e.page.pagewidth/(e.width*e.page.zoom),a=a*e.page.pagewidth/(e.width*e.page.zoom),e.page.xoffset-=o,e.page.yoffset-=a,MyrApplyZoomOffsetToPage(e,MyrCtx.faux,MyrCtx.vrai))),e.mouse.lastdragx=e.mouse.x,e.mouse.lastdragy=e.mouse.y;else if(MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool))for(r=0;r<e.toolbar.tool.length;r++)e.toolbar.tool[r].nextundermouse="tool"==d&&y==r?MyrCtx.vrai:MyrCtx.faux;if("click"==t){var f=Date.now();if(Math.abs(e.mouse.clickx-i)<4&&Math.abs(e.mouse.clicky-s)<4&&f<e.mouse.clicktime+400)return void MyrManageMouseOnObj(e,"dblclick");2==l&&"page"==d&&(MyrMenuClear(e,0),MyrAddMenuItemsZoom(e),MyrAddMenuItemsPart(e),MyrAddMenuItemsLyrics(e),MyrPopup(e)),2==l&&"keyboard"==d&&(MyrMenuClear(e,0),MyrAddMenuItemsKbd(e),MyrPopup(e)),e.mouse.clicktime=f,e.mouse.clickx=i,e.mouse.clicky=s,e.mouse.dragstate=0,e.mouse.clickedtype=d,e.mouse.clickeddata=y,e.mouse.stilldown=MyrCtx.vrai,"tool"==d?MyrToolbarClickTool(e,y):"dlog"==d?(n=e.mouse.clickeddata.split(" "),MyrDlogProcessItem("click",e,n[0],n[1])):e.toolfocus&&MyrToolbarLoseFocus(e,e.toolfocus)}else 0===l&&(e.mouse.stilldown=MyrCtx.faux);MyrToolbarUpdate(e)}function MyrInstanceHasOpenMenu(){for(var e=0;e<MyrCtx.myrTab.length;e++)if(MyrIsDefined(MyrCtx.myrTab[e].menu)&&MyrCtx.myrTab[e].menu.opened>=0)return MyrCtx.myrTab[e];return null}function MyrManageMouse(e){if("click"==e){var t=MyrInstanceHasOpenMenu();if(t&&t.menu.managemouseevt("click",t,-1))return}for(var r=0;r<MyrCtx.myrTab.length;r++)if(MyrCtx.myrTab[r].mouse.inObj)return void MyrManageMouseOnObj(MyrCtx.myrTab[r],e)}function MyrXhrError(e,t){"file:"===window.location.protocol&&alert("Could not download "+t.src+". It might be due to your browser preventing Javascript downloads on local files (file://).\nPlease retry to view pages once uploaded to an actual HTTP server."),MyrError(t,"Error loading "+t.src,e.statusText)}function MyrLoadMyrweb(e){var t,r;if(MyrParseArgs(e,e.unclippedFather.dataset.myrweb),e.src=e.args.src,!MyrIsDefined(e.src)){var o=e.inlinedata;e.inlinedata=null;var a=o.length,n={};for(n.buffer=new Uint8Array(new ArrayBuffer(a)),n.size=a,t=0;a>t;t++)n.buffer[t]=o.charCodeAt(t);return o=null,n.index=0,MyrParseChunkLevel(n,n.size,e,0,e.index)?(n.buffer=null,n=null,MyrProcessMyrwebData(e)):(n.buffer=null,n=null,MyrError(e,"Error loading inline data"))}if("html"==e.src.split(".").pop()||"htm"==e.src.split(".").pop()){r=new XMLHttpRequest;try{r.open("GET",e.src+"?nocache="+Math.random(),!0)}catch(t){return void MyrError(e,"Error getting "+e.src+":",t)}r.responseType="text",r.storage=e,r.onprogress=function(e){SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad)},r.onload=function(e){if(2===r.readyState||3===r.readyState)SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad);else if(4===r.readyState){var o,a,n=r.storage;if(200===r.status||0===r.status&&!n.isError)if(o=/varb64[\s]*=[\s]*\"([^\"]*)\"/i,(!MyrIsDefined(a=r.responseText.match(o))||!MyrIsDefined(a[1])||a[1].length<=6)&&(o=/data-b64[\s]*=[\s]*\"([^\"]*)\"/i,(!MyrIsDefined(a=r.responseText.match(o))||!MyrIsDefined(a[1])||a[1].length<=6)&&(o=/class=\"myrweb-b64\"[^>]*>([^<]*)</i,a=r.responseText.match(o))),MyrIsDefined(a)&&MyrIsDefined(a[1])&&a[1].length>6){var i=(a=window.atob(a[1].replace(/=?[\000- ]+/g,""))).length,s={};for(s.buffer=new Uint8Array(new ArrayBuffer(i)),s.size=i,t=0;i>t;t++)s.buffer[t]=a.charCodeAt(t);a=null,s.index=0,MyrParseChunkLevel(s,s.size,n,0,n.index)?(s.buffer=null,s=null,MyrProcessMyrwebData(n)):(s.buffer=null,s=null,MyrError(n,"Error parsing "+r.storage.src," data"))}else MyrError(n,"Error: "+r.storage.src," empty data")}},r.onerror=MyrCallback(MyrXhrError,r,e);try{r.send(null)}catch(t){MyrError(e,"Error loading "+e.src+":",t)}}else{r=new XMLHttpRequest;try{r.open("GET",e.src+"?nocache="+Math.random(),!0)}catch(t){return void MyrError(e,"Error getting "+e.src+":",t)}r.responseType="arraybuffer",r.storage=e,r.onprogress=function(e){SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad)},r.onload=function(e){if(2===r.readyState||3===r.readyState)SetLoadTimeOut(window,r.storage,MyrCtx.myrTimeOutLoad);else if(4===r.readyState){var t=r.storage;if(200!==r.status||0!==r.status||t.isError)MyrError(t,"Error loading "+r.storage.src,r.statusText);else{var o={};o.buffer=new Uint8Array(r.response),o.size=o.buffer.length,o.index=0,MyrParseChunkLevel(o,o.size,t,0,t.index)?(o.buffer=null,o=null,r.response=r=null,MyrProcessMyrwebData(t)):(o.buffer=null,o=null,MyrError(t,"Error loading "+r.storage.src,"Incorrect data"))}}},r.onerror=MyrCallback(MyrXhrError,r,e);try{r.send(null)}catch(t){MyrError(e,"Error loading "+e.src+":",t)}}}function MyrSetTitle(e){var t,r,o,a,n="";if(e.title.div.height>0){if(t=Math.floor(.76*e.title.div.height),e.isLoaded==MyrCtx.vrai){var i=e.sound.playMode.tempo;if(MyrIsDefined(i)||(i=1),MyrIsDefined(n=e.args.title)||(n="{name}"),null!==(a=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"))){a=Math.floor(a[a.length-1].time/i);var s=parseInt(a/3600),l=parseInt(a/60)%60,d=a%60;a=(s>0?(10>s?"0"+s:s)+"h":"")+(10>l?"0"+l:l)+"m"+(10>d?"0"+d:d)+"s"}else a="";n=(n=(n=(n=(n=n.replace("{name}",MyrSafeGet(e,"Myrweb[0].Header[0].$title"))).replace("{composer}",MyrSafeGet(e,"Myrweb[0].Header[0].$compose"))).replace("{remarks}",MyrSafeGet(e,"Myrweb[0].Header[0].$remarks"))).replace("{date}",MyrSafeGet(e,"Myrweb[0].Header[0].$date"))).replace("{duration}",a)}else n="Loading "+e.args.src;r=MyrIsDefined(e.theme.titleface)?e.theme.titleface:"normal",o=MyrIsDefined(e.theme.titleweight)?e.theme.titleweight:"normal",MyrIsDefined(e.theme.titlecolor)?color=MyrCreateGradient(e.theme.titlecolor,!1):color="",e.title.div.innerHTML="<div style='margin-left:10px;text-align: center;vertical-align:top;font-family:"+e.theme.titlefont+";font-size:"+t+"px;font-style:"+r+";font-weight:"+o+";color:"+color+"'>"+n+"</div>"}}function MyrDisplayPage(e,t,r){e.page.currentPage=t,MyrApplyZoomOffsetToPage(e,MyrCtx.vrai,r),MyrToolbarUpdate(e)}function MyrCreateBarNum(e){var t="";if("view"==e.page.viewType&&e.page.displaybars==MyrCtx.vrai){for(var r="",o=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score["+e.page.viewIndex+"].AreaList[0].Area"),a=0;a<o.length;a++){var n=o[a].Frame[0].left+e.page.pagewidth*(o[a].Long[0].value-1),i=o[a].Frame[0].top,s=o[a].Frame[0].right-o[a].Frame[0].left,l=o[a].Frame[0].bottom-o[a].Frame[0].top;r+="<text opacity='0.2' x='"+(n+s/2)+"' y='"+(i+l/2)+"'  text-anchor='middle'  font-size='"+l/6+"' font-family='sans-serif' font-weight='bolder' fill='#000000' stroke='none'>"+(a+1)+"</text>"}t=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"'>",MyrIsDefined(e.page.view[e.page.viewIndex].annotationsSvg)&&(t+=e.page.view[e.page.viewIndex].annotationsSvg),t+="<g id='MyrBar-"+e.index+"'>"+r+"</g>",t+="</svg>"}else"view"===e.page.viewType&&MyrIsDefined(e.page.view[e.page.viewIndex].annotationsSvg)&&(t=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"'>"+e.page.view[e.page.viewIndex].annotationsSvg+"</svg>");e.page.divenrich.innerHTML=t,MyrResetAnnotations(e)}function MyrApplyZoomOffsetToPage(e,t,r){var o,a,n=document.getElementById("MyrPg-"+e.index);if(MyrIsDefined(e.page.zoom)||(e.page.zoom=1),o=e.page.zoom,n&&e.page.div.height){var i,s,l=e.page.currentPage;if(MyrIsDefined(e.page.xoffset)){0>(i=e.page.xoffset)&&(i=0),0>(s=e.page.yoffset)&&(s=0),i>e.page.pagewidth-e.page.pagewidth/o&&(i=e.page.pagewidth-e.page.pagewidth/o);var d=e.page.pagewidth*e.pageview.div.height/e.width;s>d-d/o&&(s=d-d/o),e.page.xoffset=i,e.page.yoffset=s}else i=s=0;r?a="":MyrIsDefined(e.page.div.style.transition)&&""!==e.page.div.style.transition||(a="all 0.5s ease-in-out"),MyrIsDefined(a)&&MyrSetTransition(e,e.page.div,a),i=-e.width*o*(l+i/e.page.pagewidth),s=o*(-e.width*s/e.page.pagewidth),t&&(a=r?"":"all 0.5s ease-in-out",MyrSetTransition(e,e.page.divenrich,a),MyrSetTransition(e,e.page.divselect,a),MyrSetTransition(e,e.page.divgraph,a),MyrSetDivSize(e.page.divgraph,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.divenrich,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.divselect,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetDivSize(e.page.div,e.width*e.nbPages*o,e.pageview.div.height*o),MyrSetWatermark(e,e.page.divselect)),MyrSetDivPos(e.page.div,i,s)}MyrSetPageBackPict(e)}function MyrSetPageZoom(e,t,r){var o,a;o=e.page.xoffset+e.page.pagewidth/(2*e.page.zoom),a=e.page.yoffset+e.page.zoom*e.page.pageheight/(2*e.page.zoom),e.page.zoom=t,e.page.xoffset=o-e.page.pagewidth/(2*e.page.zoom),e.page.yoffset=a-e.page.zoom*e.page.pageheight/(2*e.page.zoom),MyrIsDefined(r)||(r=MyrCtx.vrai),MyrApplyZoomOffsetToPage(e,MyrCtx.vrai,r)}function MyrSetPageWindowSize(e,t,r,o){var a=r+e.title.div.height+e.toolbar.div.height+e.position.div.height+e.keyboard.div.height;MyrSetDivSize(e.unclippedFather,t,a),MyrSetDivSize(e.fatherDiv,t,a),e.page.div.height&&(MyrIsDefined(e.page.zoom)||(e.page.zoom=1),MyrSetDivSize(e.pageview.div,t,r),MyrSetDivSize(e.page.div,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divgraph,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divenrich,t*o*e.page.zoom,r*e.page.zoom),MyrSetDivSize(e.page.divselect,t*o*e.page.zoom,r*e.page.zoom),MyrSetWatermark(e,e.page.divselect)),e.keyboard.div.height&&MyrSetDivPos(e.keyboard.div,0,r+e.title.div.height+e.toolbar.div.height+e.position.div.height)}function MyrSetPageBackPict(e){var t=e.page[e.page.viewType][e.page.viewIndex];if(MyrIsDefined(t.backpict)){var r,o,a,n,i;switch(t.backpict.dupMode="fitwidth",t.backpict.scalable=1,r=t.backpict.rect.right-t.backpict.rect.left,o=t.backpict.rect.bottom-t.backpict.rect.top,a=e.width,n=e.pageview.height,MyrIsDefined(t.backpict.scalable)&&t.backpict.scalable?(r*=e.page.zoom,o*=e.page.zoom,n*=e.page.zoom,a*=e.page.zoom,i=e.page.div.style):i=e.pageview.div.style,i.backgroundImage=t.backpict.data,t.backpict.dupMode="mosaic",t.backpict.dupMode){case"fitwidth":style=a+"px auto";break;case"fitheight":style="auto "+n+"px";break;case"fitboth":style=a+"px "+n+"px";break;case"contain":style="contain";break;case"cover":style="cover";break;case"mosaic":default:style=r+"px "+o+"px"}i.backgroundSize=style}else e.pageview.div.style.backgroundImage=e.page.div.style.backgroundImage="",e.pageview.div.style.backgroundSize=e.page.div.style.backgroundSize="auto auto"}function MyrSetDisplayView(e,t,r){var o=e.page[t][r];if(!MyrIsDefined(o)){for(alert("Impossible to view "+t+" #"+r);r>0&&!MyrIsDefined(e.page[t][r]);)r--;t="view"==t?"lyrics":"view",o=e.page[t][r]}MyrIsDefined(o)&&(e.nbPages=o.nbpages,e.svgWidth=o.width,e.svgHeight=o.height,e.page.viewType=t,e.page.viewIndex=r,e.page.pagewidth=o.pagewidth,e.page.pageheight=o.height,e.page.divgraph.innerHTML=MyrCtx.svgHeader+" viewBox='0 0 "+e.nbPages*e.page.pagewidth+" "+e.svgHeight+"' id='MyrPg-"+e.index+"'><g>"+o.data+"</g></svg>",MyrCreateBarNum(e),MyrSetPageWindowSize(e,e.width,o.height*e.width/e.page.pagewidth),MyrDisplayPage(e,0,MyrCtx.vrai))}function MyrUpdateAnnotations(e,t,r){var o,a,n;if("view"===e.page.viewType)for(o=e.page.view[e.page.viewIndex],a=0;a<o.anno.length;a++)if((n=0>t?o.anno[a].alphaMusicNo:(0===o.anno[a].repeat||o.anno[a].repeat==r)&&t>=o.anno[a].firstBar-1&&t<o.anno[a].lastBar-1?o.anno[a].alphaMusicRange:o.anno[a].alphaMusicYes)!=o.anno[a].lastopacity){var i=document.getElementById(o.anno[a].idunique);MyrIsDefined(i)&&(o.anno[a].lastopacity=n,i.style.opacity=n,i.setAttribute("opacity",n))}}function MyrResetAnnotations(e){var t,r;if("view"===e.page.viewType){for(r=e.page.view[e.page.viewIndex],t=0;t<r.anno.length;t++)r.anno[t].lastopacity=-1;e.sound.playState==MyrCtx.STATE_STOPPED?MyrUpdateAnnotations(e,-1):MyrUpdateAnnotations(e,e.sound.lastbar)}}function MyrBuildOneAnnotationSvg(e,t,r,o,a){var n=MyrSafeGet(e,"SvgFile[0]");return MyrIsDefined(n)?(n=(n=(n=n.str).replace(/<svg [^>]*>/gi,"")).replace(/<\/svg[^>]*>/gi,""),0>r&&(r=0),"<g transform='translate("+(e.$frame.left+a*e.$numPage)+","+e.$frame.top+")' id='"+o+"' opacity='"+t+"' transition='all "+r+"s ease' style='transition:all "+r+"s ease'>"+n+"</g>"):""}function MyrBuildAnnotationsSvg(e,t,r,o){var a,n,i="";if(e.anno=[],null!==t&&null!==(n=MyrSafeGet(t,"Anno")))for(a=0;a<n.length;a++){for(var s in e.anno[a]={},n[a])"$"===s.substring(0,1)&&(e.anno[a][s.substring(1)]=n[a][s]);e.anno[a].idunique=r+"-"+a,e.anno[a].lastopacity=-1,e.anno[a].alphaSpeed<=0?transdur=0:transdur=(Math.max(e.anno[a].alphaMusicNo,e.anno[a].alphaMusicYes,e.anno[a].alphaMusicRange)-Math.min(e.anno[a].alphaMusicNo,e.anno[a].alphaMusicYes,e.anno[a].alphaMusicRange))/(60*e.anno[a].alphaSpeed),e.anno[a].str=MyrSafeGet(n[a],"SvgFile[0].str"),i+=MyrBuildOneAnnotationSvg(n[a],e.anno[a].alphaMusicNo,transdur,e.anno[a].idunique,o)}return i}function MyrExtractBackground(e,t){var r,o,a,n,i=MyrSafeGet(e,t);if(MyrIsDefined(i)){n={};var s,l=MyrSafeGet(i,"Frame[0]");if(null!==l&&(n.rect={left:l.left,top:l.top,right:l.right,bottom:l.bottom}),n.dupMode=i.$dupMode,n.scalable=i.$scalable,"yes"==n.scalable?n.scalable=1:"no"==n.scalable&&(n.scalable=0),n.scalable=parseInt(n.scalable),a="",null!==(s=MyrSafeGet(i,"SvgFile[0]")))o=s.str,a="svg+xml";else{if(null===(s=MyrSafeGet(i,"PngFile[0]")))return null;for(o="",r=0;r<s.data.length;r++)o+=String.fromCharCode(s.data[r]);a="png"}n.data='url("data:image/'+a+";base64,"+btoa(o)+'")'}return n}function MyrParseArgs(e,t){var r;if(MyrIsDefined(t)){r=t.split(";");for(var o={},a=0;a<r.length;a++){var n;MyrIsDefined((n=r[a].split(/=/))[0])&&MyrIsDefined(n[1])&&(n[0]=n[0].trim().toLowerCase(),"src"!=n[0]&&(n[1]=n[1].trim()),""!==n[0]&&(o[n[0]]=n[1]))}for(var i in"yes"==o.minimal&&(e.args.titleheight=8,e.args.toolheight=16,e.args.timeheight=6,e.args.scoreview="no",e.args.keyboard="no"),o)e.args[i]=o[i]}}function MyrSetWatermark(e,t){}function MyrPrepareObj(e){MyrParseArgs(e,"theme=moon;tools=default;titlebar=no;titleheight=16;toolbar=yes;toolheight=40;timebar=no;timeheight=8;scoreview=yes;keyboard=no;keyboardheight=60"),MyrParseArgs(e,MyrSafeGet(e,"Myrweb[0].Header[0].$commands")),MyrParseArgs(e,e.unclippedFather.dataset.myrweb),MyrIsDefined(e.args.playmarker)&&(e.sync.displayMode=e.args.playmarker),MyrIsDefined(e.args.autoscroll)?e.sync.autoscroll=MyrBool(e.args.autoscroll):e.sync.autoscroll=MyrCtx.true,MyrIsDefined(e.args.playmetronomestart)&&(e.sound.playMode.metronome.before=MyrBool(e.args.playmetronomestart)),MyrIsDefined(e.args.playmetronomebeat)&&(e.sound.playMode.metronome.beat=MyrBool(e.args.playmetronomebeat)),MyrIsDefined(e.args.playmetronomebar)&&(e.sound.playMode.metronome.bar=MyrBool(e.args.playmetronomebar)),MyrIsDefined(e.args.playloop)&&(e.sound.playMode.loop=MyrBool(e.args.playloop)),MyrIsDefined(e.args.playstart)&&(e.sound.playMode.start=parseFloat(e.args.playstart)),MyrIsDefined(e.args.playend)&&(e.sound.playMode.end=parseFloat(e.args.playend)),MyrIsDefined(e.args.playtempo)&&(e.sound.playMode.scheduledtempo=parseFloat(e.args.playtempo)/100),MyrIsDefined(e.args.playdetune)&&(e.sound.playMode.scheduleddetune=parseFloat(e.args.playdetune)),MyrIsDefined(e.args.useaudiofailsafe)&&(e.sound.useAudioFailSafe=MyrBool(e.args.useaudiofailsafe)),MyrIsDefined(e.args.animationratio)&&(e.animationRatio=parseFloat(e.args.animationratio)),"yes"==e.args.minimal?e.minimal=MyrCtx.vrai:e.minimal=MyrCtx.faux,e.title={},"no"!=e.args.titlebar?(MyrIsDefined(e.args.titleheight)?height=parseInt(e.args.titleheight):height=12,e.title.div=MyrCreateUndraggableElement("div",115),e.title.div.style.position="absolute",MyrSetDivPos(e.title.div,0,0),MyrSetDivSize(e.title.div,e.width,height),e.title.div.style.backgroundColor="#D8D8D8",e.fatherDiv.appendChild(e.title.div),e.title.versiondiv=MyrCreateUndraggableElement("div",116),e.title.versiondiv.style.position="absolute",MyrSetDivPos(e.title.versiondiv,200,0),MyrSetDivSize(e.title.versiondiv,e.width,height),MyrSetTransition(e,e.title.versiondiv,"all 3s ease"),MyrCompleteStyle(e.title.versiondiv,"vertical-align:middle;text-align:right;font-family:sans-serif;font-size:9px;font-weight:normal;text-shadow:1px 1px 0px rgba(255,255,255,0.8);color:rgba(0,0,0,0.4)"),e.title.versiondiv.innerHTML="Myrweb v."+MyrWebVersion+" "+MyrWebCopyright,e.title.versiondiv.onmouseover=function(e){this.style.left="0px",this.style.visibility="visible"},e.title.versiondiv.onmouseout=function(e){this.style.left="200px",this.style.visibility="hidden"},e.fatherDiv.appendChild(e.title.versiondiv)):(e.title.div={},e.title.div.height=0),MyrIsDefined(e.args.toolheight)?e.toolheight=parseInt(e.args.toolheight):e.toolheight=40,e.toolbar={},e.toolbar.div=MyrCreateUndraggableElement("div",110),e.toolbar.div.style.position="absolute",MyrSetDivPos(e.toolbar.div,0,e.title.div.height),MyrSetDivSize(e.toolbar.div,e.width,e.toolheight),e.toolbar.div.style.backgroundColor="#D8D8D8",e.fatherDiv.appendChild(e.toolbar.div),e.toolbar.background=MyrCreateUndraggableElement("div",120),MyrSetDivPos(e.toolbar.background,0,0),e.toolbar.background.style.position="absolute",MyrSetDivSize(e.toolbar.background,e.width,e.toolheight),e.toolbar.div.appendChild(e.toolbar.background),MyrInitTheme(e,e.args),MyrToolbarChange(e,!1),MyrSetTitle(e),e.position={},e.position.div={},e.position.div.height=0,MyrInitTheme(e,e.args),e.minimal?(e.pageview={},e.pageview.div={},e.pageview.div.height=0,e.page={},e.page.div={},e.page.div.height=0,e.keyboard={},e.keyboard.div={},e.keyboard.div.height=0,e.unclippedFather.style.height=e.fatherDiv.style.height=e.title.div.height+e.toolbar.div.height+e.position.div.height+"px"):("no"!=e.args.scoreview?(e.pageview={},e.pageview.div=MyrCreateUndraggableElement("div",40),e.pageview.div.style.position="absolute",MyrSetDivPos(e.pageview.div,0,e.title.div.height+e.toolbar.div.height+e.position.div.height-1),height=e.height-e.title.div.height-e.toolbar.div.height-e.position.div.height-20,height<=0&&(height=1),MyrSetDivSize(e.pageview.div,e.width,height),e.pageview.div.style.backgroundColor="#FFFF0F",MyrIsDefined(e.theme.pagebgcolor)&&MyrSetDivBackground(e.pageview.div,e.theme.pagebgcolor),e.fatherDiv.appendChild(e.pageview.div),e.page={},e.page.zoom=1,e.page.displaybars=MyrCtx.faux,e.page.xoffset=e.page.yoffset=0,e.page.div=MyrCreateUndraggableElement("div",40),e.page.div.style.position="absolute",MyrSetDivPos(e.page.div,0,0),MyrSetDivSize(e.page.div,e.width,height),e.pageview.div.appendChild(e.page.div),e.page.divgraph=MyrCreateUndraggableElement("div",50),e.page.divgraph.style.position="absolute",MyrSetDivPos(e.page.divgraph,0,0),MyrSetDivSize(e.page.divgraph,e.width,e.pageview.div.height),e.page.div.appendChild(e.page.divgraph),e.page.divselect=MyrCreateUndraggableElement("div",70),e.page.divselect.style.position="absolute",e.page.divselect.style.zIndex=3e3,MyrSetDivPos(e.page.divselect,0,0),MyrSetDivSize(e.page.divselect,e.width,e.pageview.div.height),MyrSetWatermark(e,e.page.divselect),e.pageview.div.appendChild(e.page.divselect),e.page.divcursor=MyrCreateUndraggableElement("div",80),e.page.divcursor.style.position="absolute",MyrSetDivPos(e.page.divcursor,0,0),MyrSetDivSize(e.page.divcursor,0,0),MyrIsDefined(e.args.playpositionopacity)?opacity=e.args.playpositionopacity/100:opacity=.5,MyrIsDefined(e.args.playpositioncolor)?e.page.divcursor.style.backgroundColor=MyrGetRGBA(e.args.playpositioncolor,opacity):e.page.divcursor.style.backgroundColor=MyrGetRGBA("#64FF64",opacity),MyrSetTransition(e,e.page.divcursor,"all "+MyrCtx.NB_MS_POS_MUSIQUE/1e3+"s ease"),e.page.div.appendChild(e.page.divcursor),e.page.divenrich=MyrCreateUndraggableElement("div",90),e.page.divenrich.style.position="absolute",MyrSetDivPos(e.page.divenrich,0,0),MyrSetDivSize(e.page.divenrich,e.width,e.pageview.div.height),e.page.div.appendChild(e.page.divenrich)):(e.pageview={},e.pageview.div={},e.pageview.div.height=0,e.page={},e.page.div={},e.page.div.height=0),"no"!=e.args.keyboard?(e.keyboard={},e.keyboard.div=MyrCreateUndraggableElement("div",200),height=parseInt(e.args.keyboardheight),e.keyboard.div.style.position="absolute",MyrSetDivPos(e.keyboard.div,0,e.title.div.height+e.toolbar.div.height+e.position.div.height+e.pageview.div.height),MyrSetDivSize(e.keyboard.div,e.width,height),MyrKbdDraw(e),e.fatherDiv.appendChild(e.keyboard.div)):(e.keyboard={},e.keyboard.div={},e.keyboard.div.height=0),e.page.currentPage=0,e.page.data=null),e.look=e.args.look,void 0!==e.args.volume?e.sound.generalVolume=e.args.volume/100:e.sound.generalVolume=.8,MyrApplyTheme(e)}function MyrProcessMyrwebData(e){var t,r,o,a,n,i,s,l;if(console.timeEnd("Load"+e.index),e.isLoaded=MyrCtx.vrai,MyrStopWait(e),MyrPrepareObj(e),null!==(s=MyrSafeGet(e,"Myrweb[0].FileList[0].File")))for(t=0;t<s.length;t++){var d=s[t].$type;switch(e.file[t]={},e.file[t].name=MyrSafeGet(e,"Myrweb[0].FileList[0].$name")+"."+d,d){case"xml":e.file[t].mime="application/vnd.recordare.musicxml+xml";break;case"mid":case"kar":e.file[t].mime="audio/midi";break;case"pdf":e.file[t].mime="application/pdf";break;case"myr":case"mus":e.file[t].mime="application/x-myriad-music";break;default:e.file[t].mime="application/octet-stream"}e.file[t].data=MyrSafeGet(s[t],"Data[0].data")}if(e.page.div.height>0){if(e.page.backpict=MyrExtractBackground(e,"Myrweb[0].Graphics[0].Backgr[0]"),e.page.view=[],null!==(n=MyrSafeGet(e,"Myrweb[0].Graphics[0].Score")))for(t=0;t<n.length;t++)e.page.view[t]={},e.page.view[t].nbpages=n[t].$numberOfPages,e.page.view[t].name=n[t].$name,MyrIsDefined(e.page.view[t].name)||(e.page.view[t].name="~"+(t+1)+"~"),e.page.view[t].backpict=MyrExtractBackground(n[t],"Backgr[0]"),(a=(o=MyrGetXMLValue(r=MyrSafeGet(n[t],"Picture[0].SvgFile[0].str"),"svg","viewBox")).split(" ")).length<4&&(a=o.split(",")),a.length>=4&&(e.page.view[t].height=parseInt(a[3]),e.page.view[t].width=parseInt(a[2])),e.page.view[t].pagewidth=e.page.view[t].width/e.page.view[t].nbpages,e.page.view[t].annotationsSvg=MyrBuildAnnotationsSvg(e.page.view[t],MyrSafeGet(n[t],"AnnoList[0]"),"Anno-"+e.index+"-"+t,e.page.view[t].pagewidth),r=r.replace(/<\/svg>/gi,""),e.page.view[t].data=MyrDeleteSvgHeader(r),MyrSafeDispose(n[t],"Picture[0].SvgFile[0].str");if(e.page.lyrics=[],null!==(i=MyrSafeGet(e,"Myrweb[0].Graphics[0].Lyrics")))for(t=0;t<i.length;t++)e.page.lyrics[t]={},e.page.lyrics[t].name=i[t].$name,e.page.lyrics[t].nbpages=i[t].$numberOfPages,e.page.lyrics[t].nbpages>1&&(e.page.lyrics[t].nbpages=1),e.page.lyrics[t].backpict=MyrExtractBackground(i[t],"Backgr[0]"),(a=(o=MyrGetXMLValue(r=MyrSafeGet(i[t],"Picture[0].SvgFile[0].str"),"svg","viewBox")).split(" ")).length<4&&(a=o.split(",")),a.length>=4&&(e.page.lyrics[t].height=parseInt(a[3]),e.page.lyrics[t].width=parseInt(a[2])),e.page.lyrics[t].pagewidth=e.page.lyrics[t].width/e.page.lyrics[t].nbpages,r=r.replace(/<\/svg>/gi,""),e.page.lyrics[t].data=MyrDeleteSvgHeader(r),MyrSafeDispose(i[t],"Picture[0].SvgFile[0].str");e.page.view.length>0?MyrSetDisplayView(e,"view",0):MyrSetDisplayView(e,"lyrics",0)}else MyrSetPageWindowSize(e,e.width,0,0);MyrInitSound(e),e.sound.canJump=MyrCtx.vrai,e.sound.track=[];var y=MyrSafeGet(e,"Myrweb[0].Audio[0].Track");if(null!==y){for(e.sound.nbTracks=y.length,t=0;t<e.sound.nbTracks;t++){for(var c in e.sound.track[t]={},e.sound.track[t].name=MyrSafeGet(y[t],"$name"),y[t])"MpgFile"==c?(e.sound.track[t].data=y[t].MpgFile[0].data,e.sound.track[t].mime="audio/mpeg",MyrSafeDispose(y[t],"MpgFile[0]")):"WavFile"==c?(e.sound.track[t].data=y[t].WavFile[0].data,e.sound.track[t].mime="audio/wav",MyrSafeDispose(y[t],"WavFile[0]")):"OggFile"==c&&(e.sound.track[t].data=y[t].OggFile[0].data,e.sound.track[t].mime="audio/ogg",MyrSafeDispose(y[t],"OggFile[0]"));e.sound.useAudioFailSafe&&0===e.sound.track[t].$bitRate&&(e.sound.canJump=MyrCtx.faux),e.sound.track[t].data&&(e.sound.track[t].panningtrim=MyrSafeGet(y[t],"$panning"),e.sound.track[t].panning=0,MyrInitSoundTrack(e,t,e.sound.track[t].data.buffer,e.sound.track[t].mime))}MyrSafeDispose(e,"Myrweb[0].Audio[0].Track")}if(e.sync.area=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"),MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].AreaTime[0].Time"),e.sync.staff=[],null!==(l=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Staff"))){for(t=0;t<l.length;t++)e.sync.staff[t]={},e.sync.staff[t].onKbd=MyrCtx.vrai,e.sync.staff[t].id=l[t].$uniqueId,e.sync.staff[t].panning=l[t].$panning,e.sync.staff[t].name=l[t].$name,e.sync.staff[t].note=l[t].Note,e.sync.staff[t].area=e.sync.area;MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Staff")}if(elt=MyrSafeGet(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Metronom[0]"),null!==elt?(e.sync.metronome={},e.sync.metronome.name="metronome",e.sync.metronome.note=elt.Event,MyrSafeDispose(e,"Myrweb[0].Synchro[0].Score[0].NoteList[0].Metronom[0]")):e.sync.metronome=null,e.sync.lyrics=[],null!==(l=MyrSafeGet(e,"Myrweb[0].Synchro[0].Lyrics"))){for(t=0;t<l.length;t++)e.sync.lyrics[t]={},e.sync.lyrics[t].id=l[t].$uniqueId,e.sync.lyrics[t].name=l[t].$name,e.sync.lyrics[t].area=MyrSafeGet(l[t],"AreaTime[0].Time");MyrSafeDispose(e,"Myrweb[0].Synchro[0].Lyrics")}MyrSetTitle(e),MyrToolbarChange(e)}function MyrStartWait(e){var t,r,o,a;if(!MyrIsDefined(MyrCtx.waitSvg)){var n=MyrCtx.svgHeader+" viewBox='-30 -30 160 160'>";if(MyrIsDefined(MyrCtx.myrwebLogo))n+=MyrCtx.myrwebLogo;else{n+="<defs><g id='myrwebLogo'>";for(var i=0;9>i;i++){var s=i/9*6.28;n+="<circle cx='"+(50+50*Math.cos(s))+"' cy='"+(50-50*Math.sin(s))+"' r='"+(16-16*i/9)+"' stroke='none' opacity='"+(1-i/9)+"'/>"}n+="</g></defs>"}n+="<style>",n+="@keyframes MyrWait{ 0% {transform: scale(0); fill:#00FF00;} 1% {transform: scale(1);fill:#00FF00;} 1.1% {transform: rotate(0);fill:#00FF00;} 99% {transform: rotate("+2*MyrCtx.myrTimeOutLoad*360+"deg); fill:#FF0000;} 99.1% {transform: scale(1); fill:#FF0000;} 100% {transform: scale(0); fill:#FF0000;}}",n+="</style>",n+="<g  style='strokeWidth:0;transform-origin: 50px 50px;animation: MyrWait "+4*MyrCtx.myrTimeOutLoad+"s linear;animation-fill-mode: forwards;'>",n+="<use xlink:href='#myrwebLogo'/>",n+="</g></svg>",MyrCtx.waitSvg=n}MyrIsDefined(e.waitDiv)||(e.waitDiv=MyrCreateUndraggableElement("div",1e3)),o=60,a=60,e.fatherDiv.clientWidth<60&&(o=e.fatherDiv.clientWidth),e.fatherDiv.clientHeight<60&&(a=e.fatherDiv.clientHeight),t=(e.fatherDiv.clientWidth-o)/2,r=(e.fatherDiv.clientHeight-a)/2,e.waitDiv.style.position="absolute",MyrSetDivPos(e.waitDiv,t,r),MyrSetDivSize(e.waitDiv,o,a),e.waitDiv.innerHTML=MyrCtx.waitSvg,e.fatherDiv.appendChild(e.waitDiv)}function MyrStopWait(e){MyrIsDefined(e.waitDiv)&&e.waitDiv.parentElement.removeChild(e.waitDiv),e.waitDiv=null}function MyrTimeoutWait(e){delete e.loadTimer,e.isLoaded||MyrError(e,"Impossible to load "+e.src)}function MyrGetXMLValue(e,t,r){var o,a=new RegExp("<"+t+"\\s([^>]*)","gi");return(o=a.exec(e))&&o.length>1&&((o=(a=new RegExp(r+"\\s*=\\s*[\\\"\\']([^\\\"\\']*)","gi")).exec(o[1]))&&o.length>1)?o[1]:""}function MyrError(e,t,r){var o,a,n;if(!e.isError){e.isError=MyrCtx.vrai;var i=56;e.unclippedFather.clientWidth<156&&(e.unclippedFather.style.width="156px"),e.unclippedFather.clientHeight<96?(e.unclippedFather.style.height="96px",o=e.unclippedFather.clientWidth/2,a=e.unclippedFather.clientHeight/2,n=.75,o/=.75):(n=1,o=e.unclippedFather.clientWidth/2,a=e.unclippedFather.clientHeight/2);var s=MyrCtx.svgHeader;s+="viewBox='0 0 "+e.unclippedFather.clientWidth+" "+e.unclippedFather.clientHeight+"'>",s+="<rect x='0' y='0' width='"+e.unclippedFather.clientWidth+"' height='"+e.unclippedFather.clientHeight+"' fill='#000000' opacity='0.8'/>",s+="<g transform='scale("+n+")'>",s+="<rect x='"+(o-28)+"' y='"+(a-28)+"' width='"+i+"' height='"+i+"'",s+=" stroke='#FFFFFF' stroke-width='2'  stroke-linecap='round' stroke-dasharray='4,4' opacity='0.6' fill='none' />",s+="<circle cx='"+o+"' cy='"+a+"' r='"+i/3+"' fill='#FFFFFF' opacity='0.5'/>",s+="<circle cx='"+(o-7)+"' cy='"+(a-2.8)+"' r='"+i/13+"' fill='#000000' opacity='0.6'/>",s+="<circle cx='"+(o+7)+"' cy='"+(a-2.8)+"' r='"+i/13+"' fill='#000000' opacity='0.6'/>";var l=o,d=a+28,y=i/3,c=-3.14/3,u=3.14-c;s+="<path d='M "+(l+y*Math.cos(c))+" "+(d+y*Math.sin(c))+" A "+y+" "+y+" 0 0 0 "+(l+y*Math.cos(u))+" "+(d+y*Math.sin(u))+"' stroke='#000000' stroke-width='2' opacity='0.6' fill='none'/>",s+="<text text-anchor='middle' x='"+o+"' y='"+(a+i)+"' fill='#FFFFFF' stroke='none' font-family='sans-serif' font-size='12px'>"+t+"</text>",MyrIsDefined(r)&&(s+="<text text-anchor='middle' x='"+o+"' y='"+(a+i+14)+"' fill='#FFFFFF' stroke='none' font-family='sans-serif' font-size='12px'>"+r+"</text>"),s+="</g></svg>",e.unclippedFather.clientWidth<60&&(e.unclippedFather.style.width="60px"),e.unclippedFather.clientHeight<60&&(e.unclippedFather.style.height="60px"),e.unclippedFather.innerHTML=s}}function MyrMixAction(e,t,r,o){t<e.sound.track.length&&MyrIsDefined(r)&&MyrIsDefined(o)&&("active"!=r||MyrIsDefined(e.sound.solotrack)||MyrSetTrackActive(e,t,parseInt(o)),"solo"==r&&MyrSetTrackSolo(e,t,parseInt(o)),"volume"==r?MyrSetTrackVolume(e,t,parseFloat(o)):"panning"==r&&MyrSetTrackPanning(e,t,parseFloat(o))),MyrSoundChangeData(e)}function MyrMixDoItem(e,t,r,o){var a,n,i,s,l,d;if(n=(a=r.tag.split("_"))[1],i=parseInt(a[2]),"update"==o){var y,c=!MyrIsDefined(e.sound.solotrack),u=document.getElementById("Myr-"+e.index+"-"+t.tag+"-"+r.tag),f=[];if(f[0]={},f[0].opacity=.3,f[0].bgcolor="#A0A0A0",f[0].fgcolor="#000000",f[1]={},f[1].opacity=1,f[1].bgcolor="#E0E0D0",f[1].fgcolor="#404040",f[2]={},f[2].opacity=1,f[2].fgcolor="#404040","on"==n)f[2].bgcolor="#00FF00",y=c?e.sound.track[i].active?2:1:0,u.style.fill=f[y].bgcolor,u.style.stroke=f[y].fgcolor,u.style.opacity=f[y].opacity;else if("off"==n)f[2].bgcolor="#FF0000",y=c?e.sound.track[i].active?1:2:0,u.style.fill=f[y].bgcolor,u.style.stroke=f[y].fgcolor,u.style.opacity=f[y].opacity;else if("solo"==n)f[2].bgcolor="#FF00FF",y=e.sound.solotrack==i?2:1,u.style.fill=f[y].bgcolor,u.style.stroke=f[y].fgcolor,u.style.opacity=f[y].opacity;else if("vol"==n)(s=document.getElementById("MyrThumb-"+e.index+"-"+r.tag))&&s.setAttribute("transform","translate("+e.sound.track[i].volume*r.toolscale+")"),!c&&i!=e.sound.solotrack||c&&0===e.sound.track[i].active?MyrToolSetActiveState(e,e.index+"-"+r.tag,"inactive",MyrCtx.faux):MyrToolSetActiveState(e,e.index+"-"+r.tag,"active",MyrCtx.faux);else if("pan"==n){if(s=document.getElementById("MyrThumb-"+e.index+"-"+r.tag)){var m=e.sound.track[i].panning;m=0>m?(e.sound.track[i].panningtrim+1)*(m+1)-1:1-(1-e.sound.track[i].panningtrim)*(1-m),s.setAttribute("transform","translate("+(m*r.toolscale/2+r.toolscale/2)+")")}!c&&i!=e.sound.solotrack||c&&0===e.sound.track[i].active?MyrToolSetActiveState(e,e.index+"-"+r.tag,"inactive",MyrCtx.faux):MyrToolSetActiveState(e,e.index+"-"+r.tag,"active",MyrCtx.faux)}}else"over"==o||"click"!=o&&"drag"!=o||("off"==n?MyrAction(e,"action_mixer "+i+" active 0"):"on"==n?MyrAction(e,"action_mixer "+i+" active 1"):"solo"==n?MyrAction(e,"action_mixer "+i+" solo 1"):"vol"==n?(l=e.mouse.x-t.box.left-r.x,e.mouse.y-t.box.top-r.y,0>(l=(l-(d=20*r.size.height/100))/(r.size.width-2*d))?l=0:l>1&&(l=1),MyrAction(e,"action_mixer "+i+" volume "+l)):"pan"==n&&(l=e.mouse.x-t.box.left-r.x,e.mouse.y-t.box.top-r.y,0>(l=(l-(d=20*r.size.height/100))/(r.size.width-2*d))?l=0:l>1&&(l=1),l=2*(l-.5),e.sound.track[i].panningtrim&&(l=l<e.sound.track[i].panningtrim?(l+1)/(e.sound.track[i].panningtrim+1)-1:l>e.sound.track[i].panningtrim?1-(1-l)/(1-e.sound.track[i].panningtrim):0),MyrAction(e,"action_mixer "+i+" panning "+l)),MyrDlogUpdate(e,t));console.log("MyrMixDoItem")}function MyrMixTable(e){var t=MyrDlogGetDlogIndexByTag(e,"mixer");if(t>=0)MyrDlogClose(e,"mixer");else if((t=MyrDlogNew(e,"mixer",MyrThemeGetRawIcon(e,e.theme.mixer,25,25,2,2,2,2,.7,2,"#000000","#E0E0E0"),MyrCtx.vrai))>=0){for(var r=e.dlog.list[t],o=0;o<e.sound.track.length;o++){var a=e.sound.track[o].name;MyrDlogAddItem(e,t,"static",MyrStrLimit(a=(a=a.replace(",Tempo","")).replace("Tempo,",""),20),"name"+o,0,null,"newline left middle",10,0),MyrDlogAddTool(e,t,e.theme.volume,150,23,30,0,"mixer_vol_"+o,MyrMixDoItem,"center",0,5);var n="mixer_solo_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+n;content=MyrThemeGetRawIcon(e,e.theme.mixtracksolo,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,n,0,MyrMixDoItem,"right middle",0,0),n="mixer_on_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+n,content=MyrThemeGetRawIcon(e,e.theme.mixtrackon,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,n,0,MyrMixDoItem,"right middle",0,0),n="mixer_off_"+o,i="Myr-"+e.index+"-"+r.tag+"-"+n,content=MyrThemeGetRawIcon(e,e.theme.mixtrackoff,18,18,2,5,2,2,1,2,"000000","E0E0E0",i),MyrDlogAddItem(e,t,"static",content,n,0,MyrMixDoItem,"right middle",4,0),e.sound.useAudioFailSafe||MyrDlogAddTool(e,t,e.theme.stereo,150,10,0,0,"mixer_pan_"+o,MyrMixDoItem,"newline center",0,-10)}MyrDlogOpen(e,t,e.unclippedFather,"center topquarter persistent",0,0,e.theme)}}function MyrProgressBarOpen(e,t,r){var o=MyrDlogNew(e,t,"",MyrCtx.faux,300);if(o>=0){for(var a=0;r>a;a++)MyrDlogAddItem(e,o,"static","-","txt"+a,0,null,"newline left middle",0,0),MyrDlogAddItem(e,o,"progress","-","bar"+a,0,null,"newline center middle",0,0);MyrDlogOpen(e,o,e.unclippedFather,"center middle persistent",0,e.toolheight,e.theme)}return o}function MyrProgressBarSet(e,t,r,o,a){console.log(t+" "+r+"="+o+" "+a),MyrDlogSetItemValue(e,t,"txt"+r,MyrStrLimit(o,20)),MyrDlogSetItemValue(e,t,"bar"+r,a)}function MyrProgressBarClose(e,t){MyrDlogClose(e,t)}function MyrIsDefined(e){return null!=e}function MyrBool(e){if(!MyrIsDefined(e))return MyrCtx.false;switch(e.toString().toLowerCase()){case"1":case"true":case"yes":case"y":case"on":return MyrCtx.vrai;default:return MyrCtx.faux}return MyrCtx.faux}function MyrDeleteSvgHeader(e){var t=e.indexOf("<svg ");return t>=0&&(t=e.indexOf(">",t+1))>=0?e.substr(t+1):e}function MyrReplaceSVGTokens(obj,toolindex,str,forcedwidth){var width,objindex,bgcolor,fill,stroke,both,sboth,shadow,autoshadow,hmargin,vmargin;return width=MyrIsDefined(obj.toolbar)&&MyrIsDefined(obj.toolbar.tool)&&toolindex>=0&&toolindex<obj.toolbar.tool.length?obj.toolbar.tool[toolindex].width100:MyrIsDefined(forcedwidth)?forcedwidth:100,objindex=obj.index,bgcolor=obj.theme.bgcolor,fill="stroke='none'",stroke="fill='none'",both="",shadow="fill='#000000' opacity='0.1' stroke='none'",sboth="fill='"+obj.theme.stroke+"'",autoshadow="transform='translate(7,7)' fill='#000000' opacity='0.1' stroke='none'",hmargin=parseFloat(obj.theme.hmargin),vmargin=parseFloat(obj.theme.vmargin),str.replace(/\[([^\]]+)\]/gi,function(match,val){return eval(val).toString()})}function MyrStrLimit(e,t){return e.length>t&&(e=e.substr(0,t-3)+"..."),e}function MyrToggleFullScreen(e){document.mozFullScreen||document.webkitFullScreen?document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)}function MyrSafeGet(e,t){var r,o=t.split(/[\.\[]/),a=e;for(r=0;r<o.length&&MyrIsDefined(a);r++)a=a[o[r].replace("]","")];return MyrIsDefined(a)||(a=null),a}function MyrSafeDispose(obj,path){null!==MyrSafeGet(obj,path)&&eval("obj."+path+"=null;")}function MyrSetDivSize(e,t,r){MyrIsDefined(e)&&(t>=0&&(e.width=parseFloat(t),e.style.width=t+"px"),r>=0&&(e.height=parseFloat(r),e.style.height=r+"px"))}function MyrSetDivPos(e,t,r){MyrIsDefined(e)&&(e.style.left=t+"px",e.style.top=r+"px")}function MyrSetTransition(e,t,r){if(MyrIsDefined(e.animationRatio))if(0===e.animationRatio)r="";else{r=r.replace(/([\d\.]+)s/g,function(t,r){return e.animationRatio*parseFloat(r)/100+"s"})}t.setAttribute("transition",r),t.style.transition=r}function MyrStartTimer(e,t,r){MyrIsDefined(MyrCtx.myrTimer[e])||(MyrCtx.myrTimer[e]={},MyrCtx.myrTimer[e].id=window.setInterval(t,r),MyrCtx.myrTimer[e].count=0)}function MyrStopTimer(e){window.clearInterval(MyrCtx.myrTimer[e].id),MyrCtx.myrTimer[e]=null}function MyrCallback(e){for(var t=[],r=0;r<arguments.length-1;r++)t[r]=arguments[r+1];return function(r){var o=e.apply(this,t);return console.log(o+" "+(r||window.event)),o==MyrCtx.vrai&&(r||window.event).stopPropagation(),o}}function MyrCreateUndraggableElement(e,t){var r=document.createElement(e);return r.style="overflow:hidden; -moz-user-select: -moz-none; -khtml-user-select: none; -webkit-user-select: none; -ms-user-select: none; user-select: none;",r.setAttribute("unselectable","on"),r.setAttribute("draggable","false"),MyrIsDefined(t)&&(r.style.zIndex=t),r}function MyrSetUndraggable(e){e.style.MozUserSelect="-moz-none",e.style.KhtmlUserSelect="none",e.style.WebkitUserSelect="none",e.style.MsUserSelect="none",e.style.userSelect="none",e.style.overflow="hidden",e.setAttribute("unselectable","on"),e.setAttribute("draggable","false")}function MyrCompleteStyle(e,t){if(MyrIsDefined(t)){var r=t.split(";");for(var o in r)if(r[o].length>3){var a=r[o].split(":"),n=a[0].replace(/-([a-z])/g,function(e){return e[1].toUpperCase()}).trim();e.style[n]=a[1],"transform"==n&&(n=n.substr(0,1).toUpperCase()+n.substr(1),e.style["Ms"+n]=a[1],e.style["Webkit"+n]=a[1],e.style["Moz"+n]=a[1],e.style["O"+n]=a[1])}}}function MyrGetRGBA(e,t){var r=e,o=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return o&&(r="rgba("+parseInt(o[1],16)+","+parseInt(o[2],16)+","+parseInt(o[3],16)+","+t+")"),r}function MyrCreateGradient(e,t){var r=e.split(" "),o="";if(0===r[0].indexOf("#")||0===r[0].indexOf("rgb"))return r[0];for(var a=1,n=r[a++];a<r.length;a+=3){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(r[a+1]);o+=", rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+r[a+2]+") "+r[a]}return MyrIsDefined(t)&&!1!==t?"linear-gradient("+n+"deg"+o+")":"-webkit-linear-gradient("+(90-n)+"deg"+o+");-ms-linear-gradient("+(90-n)+"deg"+o+");linear-gradient("+n+"deg"+o+")"}function MyrSetDivBackground(e,t){if(MyrIsDefined(t))if("#"==(t=MyrCreateGradient(t)).substr(0,1))e.style.backgroundColor=t;else for(var r=t.split(";"),o=0;o<r.length;o++)e.style.background=r[o];else e.style.background=e.style.backgroundColor=""}function MyrPrepareThemes(e){e.theme=[],e.theme.unknown="100 <text x='30' y='90' font-family='Helvetica,Arial,\tsans-serif' font-weight='bolder' font-size='120' [both]>?</text>",e.theme.moon={},e.theme.moon.hmargin="30",e.theme.moon.vmargin="30",e.theme.moon.focusshadow="0px 0px 5px 2px rgba(128,128,128,0.4)",e.theme.moon.overtransition="0.15s ease",e.theme.moon.notoverfill="#FFFFFF",e.theme.moon.notoverstroke="#FFFFFF",e.theme.moon.notoverstrokewidth="0",e.theme.moon.notoveropacity="0",e.theme.moon.notoverscale="0",e.theme.moon.overfill="#FFFFFF",e.theme.moon.overstroke="#FFFFFF",e.theme.moon.overstrokewidth="0",e.theme.moon.overopacity="0.4",e.theme.moon.overscale="1",e.theme.moon.over="<ellipse cx='[width/2]' cy='50' ry='[50+vmargin*0.8]'\t rx='[width/2+hmargin]' stroke='none'/>",e.theme.moon.transition="0.4s ease",e.theme.moon.pulsetransition="0.7s ease",e.theme.moon.pulsefill="#FFFFFF",e.theme.moon.inactivestroke="#A0A0A0",e.theme.moon.inactivestrokewidth="0",e.theme.moon.inactivefill="#A0A0A0",e.theme.moon.inactiveopacity="0.2",e.theme.moon.inactivescale="0.80",e.theme.moon.stroke="#707070",e.theme.moon.strokewidth="6",e.theme.moon.fill="#A0C0A0",e.theme.moon.opacity="1",e.theme.moon.scale="1",e.theme.moon.dlogclosebox="100 <rect x='10' y='10' width='80' height='80' [both] fill='#F0C0C0'/>   <path d='M 30 30 L 70 70 M 70 30 L 30 70' [stroke]/>",e.theme.moon.mixtrackoff="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='M 22 22 L 78 78 M 78 22 L 22 78' [stroke] />",e.theme.moon.mixtrackon="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='M 25 40 L 48 80 C 48 70 70 20  75 20' [stroke] />",e.theme.moon.mixtracksolo="100 <circle cx='50' cy='50' r='50' [both] />                                <path d='m 66,30 c 0,-8 -7,-13 -18,-13 -17,0 -21,7 -21,16 -0,16 45,9 45,36 -0,9 -6,15 -21,15 -15,0 -23,-3 -24,-16' [stroke] />",e.theme.moon.pgpop="100 <path d='M 50 0 L 30 20 L 30 100 L 100 100 \tL 100 0z'[both] /><path d='M 60 10 L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />\t<path d='M 50 0 L 30 20 L 50 20z' [fill] />",e.theme.moon.pgm="100 <path d='M 0 50 L 20 30 L 20 70z' [fill]/>\t<path d='M 50 0 L 30 20 L 30 100 L 100 100 L 100 0z'[both] /><path d='M 60 10\t L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />\t<path d='M 50 0 L 30 20 L 50 20z' [fill] />",e.theme.moon.pgmr="60 <path d='M 30 50 L 50 30 L 50 70z' [both]/>",e.theme.moon.pgp="100 <path d='M 100 50 L 80 30 L 80 70z' [fill]/>\t<g transform='translate(-30,0)'>\t<path d='M 50 0 L 30 20 L 30 100 L 100 100 L 100 0z'[both] />\t<path d='M 60 10 L 50 0 L 30 20 L 40 30 L 60 30z' [shadow] />\t<path d='M 50 0 L 30 20 L 50 20z' [fill] /></g>",e.theme.moon.pgpr="60 <path d='M 30 50 L 10 30 L 10 70z' [both]/>",e.theme.moon.pgfield="200 <rect x='-20' y='5' width='240' height='90' \t[both] fill='#F0F0F0'/><text id='MyrText-[objindex]-[toolindex]' x='0' y='77'\t font-family='Arial,sans-serif' font-weight='normal' font-size='65'\t stroke='none' fill='black'>-</text>",e.theme.moon.zoompop="100 <path d='M 58 72 L 83 97 \tQ 100 100 97 83 L 72 58z' [both]/>\t<circle cx='35' cy='35' r='35' [stroke]/>\t<circle cx='35' cy='35' r='40' [stroke]/>\t<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' \tstroke='none' opacity='0.6'/>",e.theme.moon.zoomm="100 <path d='M 20 35 L 50 35' [stroke]/>\t<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>\t<circle cx='35' cy='35' r='35' [stroke]/>\t<circle cx='35' cy='35' r='40' [stroke]/>\t<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' \tstroke='none' opacity='0.6'/>",e.theme.moon.zoommr="100 <g style='transform-origin:50px 50px'\t transform='scale(0.6)'>\t<path d='M 20 35 L 50 35' [stroke]/>\t<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>\t<circle cx='35' cy='35' r='35' [stroke]/>\t<circle cx='35' cy='35' r='40' [stroke]/>\t<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF'\t stroke='none' opacity='0.6'/></g>",e.theme.moon.zoomp="100 <path d='M 80 35 L 50 35 M 65 20 L 65 50'\t [stroke]/><path d='M 42 72 L 17 97 Q 0 100 3 83 L 28 58z' [both]/>\t<circle cx='65' cy='35' r='35' [stroke]/><circle cx='65' \tcy='35' r='40' [stroke]/>\t<ellipse cx='60' cy='20' rx='14' ry='10' fill='#FFFFFF' \tstroke='none' opacity='0.6'/>",e.theme.moon.zoompr="100 <g style='transform-origin:50px 50px'\t transform='scale(-0.6,0.6)'>\t<path d='M 20 35 L 50 35 M 35 20 L 35 50' [stroke]/>\t<path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>\t<circle cx='35' cy='35' r='35' [stroke]/>\t<circle cx='35' cy='35' r='40' [stroke]/>\t<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF' stroke='none'\t opacity='0.6'/></g>",e.theme.moon.zoomfield="200 <rect x='5' y='5' width='190' height='90' \t[both] fill='#F0F0F0'/>",e.theme.moon.print="100 <path d='M0 76 L 0 44 C 0 38 5 33 11 33 L 89 33\tC 95 33 100 38 100 44 L 100 76z' [both]/>\t<path d='M 28 0 L72 0 L 72 24 L 28 24z' [both]/>\t<path d='M22 76 L 22 100 L 78 100 L 78 76' [stroke]/>\t<circle cx='84' cy='45' r='5' [stroke]/>",e.theme.moon.play="100 <path d='M 0 0 L 0 100 L 100 50z' \ttransform='translate(15,0)' [both]/>",e.theme.moon.pause="100 <path d='M 10 0 L 10 100 L 40 100 L 40 0z\t M 60 0 L 60 100 L 90 100 L 90 0z' [both]/>",e.theme.moon.stop="100 <path d='M 0 0 L 0 100 L 100 100 L 100 0z' [both]/>",e.theme.moon.volume="300 <path d='M 10 40 L [width-10] 40 Q [width]\t 50 [width-10] 60 L 10 60 Q 0 50 10 40z' [both]/>\t<g id='MyrThumb-[objindex]-[toolindex]' >\t<circle cx='0' cy='50' r='25' [autoshadow]/>\t<circle cx='0' cy='50' r='25' [both]/></g>",e.theme.moon.volume2="200 <g><clipPath id='vol-[objindex]-[toolindex]'>\t<path d='M 0 75 L [width] 25 L [width] 75z' clip-rule='nonzero'/>\t</clipPath><g clip-path='url(#vol-[objindex]-[toolindex])'>\t<rect id='MyrThumb-[objindex]-[toolindex]' x='-[width]' y='0' height='100'\t width='[width]' [fill]'></g><path d='M 0 75 L [width] 25 L [width] 75z'\t [stroke]/>",e.theme.moon.mixer="100 <rect x='0' y='0' width='100' height='100' [fill]/>\t<line x1='25' y1='25' x2='25' y2='75' [stroke]/>\t<line x1='50' y1='25' x2='50' y2='75' [stroke]/>\t<line x1='75' y1='25' x2='75' y2='75' [stroke]/>\t<circle cx='25' cy='54' r='12' [both]/>\t<circle cx='50' cy='37' r='12' [both]/>\t<circle cx='75' cy='63' r='12' [both]/>",e.theme.moon.mixer2="100 <rect x='10' y='15' width='80' height='15' [both]/>\t<rect x='10' y='40' width='80' height='15' [both]/>\t<rect x='10' y='65' width='80' height='15' [both]/>",e.theme.moon.metronome="100 <path d='M10 100 L 90 100 L 60 0 L 40 0z' \tstroke-linejoin='round' [both]/> \t<path stroke-linecap='round' d='M 30 70 \tL 70 70 M 50 70 L 85 15' [stroke]/>",e.theme.moon.metronome2="100 <path d='M32 15 L 68 15 L 82 70 L 18 70z'\t fill-opacity='0.4' stroke-width='4' [both]/> \t<path d='M 10 95 L 90 95 L 80 70 L 20 70z M 34 15 Q 50 -15 66 15z' \tstroke-linejoin='round' [both]/><path d='M 50 70 L 80 20' [stroke]/>",e.theme.moon.rewind="100 <path d='M 10 50 L 50 10 L 50 50 L90 10 \tL 90 90 L 50 50 L50 90z' [both]/>",e.theme.moon.fastfw="100 <path d='M 90 50 L 50 10 L 50 50 L10 10 \tL 10 90 L 50 50 L50 90z' [both]/>",e.theme.moon.view="100 <path d='M 0 64 Q 50 -19 100 64 Q 50 94 0 64z'\t fill='white' fill-opacity='0.4' [stroke]/>\t<circle cx='50' cy='50' r='28' [both]/>\t<circle cx='50' cy='50' r='13' opacity='0.4' stroke='none' fill='#000000'/>\t<circle cx='45' cy='39' r='10' opacity='0.6' stroke='none' fill='#FFFFFF'/>",e.theme.moon.fileinfo="100 <circle cx='50' cy='50' r='40' [both]/>\t<text x='35' y='73' font-family='serif' font-size='80' font-weight='bolder'\t font-style='italic' opacity='0.8' stroke='none' fill='#FFFFFF'>i</text>",e.theme.moon.info="100 "+e.myrwebLogo+"<circle cx='50' cy='50' r='50' [both]/><g stroke-width='3' transform='translate(22 22) scale(0.56)' opacity='0.7'><use xlink:href='#myrwebLogo'/></g>",e.theme.moon.detune="60 <path d='m 0,0 5,0 0,50 c 0,7 15,6 15,0 l 0,-50 5,0\t0,52 c 0,5 -10,8 -10,8 l 0,15 c 0,0 3,1 3,5 0,4 -2.5,5.5 -5.5,5.5 C 9.5,85.5 7,84 7,80 7,76 10,75 10,75 L 10,60 C 10,60 0,57 0,52 z' [both] />",e.theme.moon.detune2="100 <g transform='rotate(-25,30,80)'>\t<ellipse cx='30' cy='80' rx='20' ry='12' [sboth]/>\t<ellipse cx='28' cy='72' rx='12' ry='5' stroke='none' [fill] opacity='0.6'/>\t</g><path d='M 49 74 L 49 0 M 80 10 L 80 90 M 70 20\t L 80 10 L 90 20 M 70 80 L 80 90 L 90 80' stroke-linecap='round' [stroke]/> ",e.theme.moon.download="100 <rect x='10' y='60' width='80' height='35' \topacity='0.5' [both]/>\t<path d='M 50 70 L 75 40 L 60 40 L 60 10 L 40 10 L 40 40 L 25 40z' \tstroke-linejoin='round' [both]/>",e.theme.moon.fast="600 <path d='M 422,2 C 392,1 421,122 408,192 c -13,49 -40,10 -178,8 -101,1 -155,125 -155,170 -88,-33 -70,114 7,67 0,0                            31,28 55,35 139,27 70,-26 160,-18 32,-6 207,77 135,-22 6,-25 54,-37 61,-98 7,-60 -4,-84 -4,-84 0,0 53,54 83,26 31,-29                            3,-110 -63,-138 0,0 29,-136 1,-135 C 481,3 472,109 462,122 c -12,-6 2,-123 -40,-120 z' [fill]/>",e.theme.moon.slow="600 <path  d='M 247,6 C 93,3 65,195 65,195 l -56,33 72,0 c 0,0 -3,72 21,88 25,16 101,11 82,-12 -18,-23 -49,-45 -34,-57                            15,-12 160,-9 200,14 40,23 10,47 29,58 18,11 67,16 67,-10 0,-26 -62,-47 -28,-52 34,-5 37,-34 52,-64 14,-29 9,-74 40,-78                            30,-3 19,31 46,28 26,-2 34,-11 32,-51 C 590,52 573,14 535,9 497,3 461,117 449,116 437,114 401,8 247,6 z' [fill]/>",e.theme.moon.tickbefore="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                    <circle cx='100' cy='100' r='50' [fill]/>",e.theme.moon.tickbar="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                    <circle cx='200' cy='100' r='50'  [fill]/>                                     <circle cx='400' cy='100' r='50' [fill]/>                                     <circle cx='600' cy='100' r='50' [fill]/>",e.theme.moon.tickbeat="600 <rect x='200' y='0' width='200' height='200' [stroke]/><rect x='400' y='0' width='200' height='200' [stroke]/>                                     <circle cx='200' cy='100' r='50' [fill]/>                                     <circle cx='300' cy='100' r='50' [fill]/>                                     <circle cx='400' cy='100' r='50' [fill]/>                                     <circle cx='500' cy='100' r='50' [fill]/>                                     <circle cx='600' cy='100' r='50' [fill]/>",e.theme.moon.magnifier="100 <path d='M 58 72 L 83 97 Q 100 100 97 83 L 72 58z' [both]/>                        \t<circle cx='35' cy='35' r='35' [stroke]/>                        \t<circle cx='35' cy='35' r='40' [stroke]/>                        \t<ellipse cx='30' cy='20' rx='14' ry='10' fill='#FFFFFF'                         \tstroke='none' opacity='0.6'/>",e.theme.moon.instrument="500 <path d='m 493,5 c 7,9 -0,13 -2,25 -14,1 -14,4 -17,8 0,9 27,8 17,20 -13,11 -14,-19 -21,-15 -2,2 -3,4 -5,7 4,10 27,9                                 12,22 -10,9 -11,-23 -18,-15 -19,23 -77,86 -86,95 2,4 34,30 12,71 -21,30 -46,27 -47,40 -21,-13 -34,1 -44,14 -9,12 -15,33 1,49                                -17,4 -11,33 -35,54 -13,10 -29,19 -48,18 -30,-4 -51,-18 -63,-29 -12,-11 -37,-44 -38,-62 -2,-20 8,-30 21,-46 13,-17 43,-20 52,-38                                15,17 32,5 44,-3 11,-8 28,-30 11,-40 15,-6 12,-21 30,-42 11,-16 52,-27 85,-2 35,-37 63,-65 78,-80 9,-8 -29,-7 -18,-21 11,-12                                17,15 24,14 3,-2 8,-6 12,-10 -1,-3 -29,-7 -16,-20 9,-8 16,20 21,14 4,-4 13,-9 12,-22 7,-4 17,-11 24,-4 z' [fill]/>",e.theme.moon.duration="100 <circle cx='50' cy='50' r='50' [stroke]/><path d='M 40 10 L 50 50 L 75 50' [stroke]/>",e.theme.moon.calendar="100 <path d='M 0 10 L 20 10 L 20 20 L 30 20 L 30 10 L 70 10 L 70 20 L 80 20 L 80 10 L 100 10 L 100 40 L 0 40z' [fill]/>                                    <path d='M 0 40 L 0 100 L 100 100 L 100 40 L 90 40 L 90 90 L 10 90 L 10 40z' [fill] />                                    <path d='M 22 0 L 22 18 L 28 18 L 28 0z'  [fill] />                                     <path d='M 72 0 L 72 18 L 78 18 L 78 0z'  [fill] />",e.theme.moon.track="100 <path d='M 0 50 L 5 50 L 10 30 L 15 70 L 20 20 L 25 80 L 30 25 L 35 75 L 40 10 L 45 90 L 50 0                                             L 55 100 L 60 15 L 65 85 L 70 40 L 75 60 L 80 45 L 85 55 L 90 50 L 100 50' [stroke]/>",e.theme.moon.light="250 <path d='M 1,280 C -2,277 21,234 21,234 14,155 54,110 94,59 L 128,79 108,46 C 149,2 218,-4 226,3                                    254,29 184,150 143,187 l -52,-9 41,22 C 92,234 82,199 34,242 23,254 5,282 1,280 z' [fill]/>",e.theme.moon.heavy="500 <path d='M 90 110 0 390 500 390 410 110z' [both]/><circle cx='250' cy='80' r='80' [stroke]/>",e.theme.moon.square="100 <rect x='0' y='0' width='100' height='100' [both]/>",e.theme.moon.powered="100 <g transform='translate(0.000000,100.000000) scale(0.1,-0.1)' [fill]>                                    <path d='M162 903 c-37 -37 -81 -95 -99 -129 -33 -61 -63 -159 -63 -201 l0 -23 500 0 500 0 0 23 c0 43 -30 140 -63 201 -35 66 -127 171 -158 181 -14 5                                         -49 -17 -135 -85 -64 -50 -122 -94 -129 -96 -8 -3 -49 21 -92 53 -43 33 -104 79 -136 102 l-58 42 -67 -68z m671 -34 c33 -33 36 -37 11 -21 -49 33 -82 37                                         -112 15 -50 -36 -56 -36 -28 0 46 60 72 61 129 6z m-717 -150 c-7 -35 -7 -55 0 -67 16 -24 86 -39 253 -54 184 -16 113 -23 -137 -13 -134 6 -175 10 -179 21                                         -5 12 60 164 70 164 2 0 -1 -23 -7 -51z'/>                                         <path d='M3 448 c11 -129 74 -272 162 -366 l50 -54 69 166 c39 91 71 166 72 166 1 0 35 -34 76 -76 l74 -76 63 76 c34 42 66 74 70 72 4 -3 36 -78 71 -167                                         l64 -163 55 61 c92 100 152 239 164 381 l4 52 -500 0 -500 0 6 -72z m411 32 c-145 -12 -261 -53 -303 -106 -25 -32 -28 -89 -7 -139 25 -58 7 -39 -20 22                                         -34 76 -54 210 -34 223 8 6 114 9 235 8 179 -1 203 -2 129 -8z m345 -234 c57 -97 68 -123 60 -138 -6 -11 -16 -17 -22 -15 -11 3 -117 249 -117 271 0 15 5 8                                         79 -118z m-261 88 c13 -9 34 -14 47 -11 l24 4 -20 -28 c-11 -16 -23 -29 -27 -29 -9 0 -72 63 -72 72 0 13 24 9 48 -8z'/>                                         </g>",e.theme.moon.powered2="60 <path d='M 0,76 0,35 C 0,0 67,0 68,33 l 0,43 z M 0,83 l 66,6 0,25 -66,0 z' [fill] />                                    <circle cx='25' cy='45' r='12' stroke='none' fill='#FFFFFF'/> <circle cx='29' cy='47' r='3' fill='#FF0000' stroke='none'/>                                    <circle cx='53' cy='45' r='12' stroke='none' fill='#FFFFFF'/> <circle cx='57' cy='47' r='3' fill='#FF0000' stroke='none'/>",e.theme.moon.overlay="50 <rect x='0' y='0' width='30' height='50' [both]/><rect x='15' y='15' width='35' height='55' opacity='0.3' stroke='none' fill='#000000'/>",e.theme.moon.note="100 <path d='m 22,152 c -48,32 -7,67 32,39 29,-20 23,-40 23,-40 C 75,16 74,0 74,0 L 70,0 72,141 c 0,0 -23,-6 -49,11 z' [fill]/>",e.theme.moon.txt="100 <path d='M  3 74 L 14 54 C 14 26 28 22 57 22 C 94 22 98 27 98 45 C 98 63 90 69 57 69 C 24 69 15 63 15 63 z' [stroke]/>",e.theme.moon.barnum="400 <rect x='0' y='20' width='200' height='160' [stroke]/><rect x='200' y='20' width='200' height='160' [stroke]/>                                <path d='M 155 200 L 155 0 L 245 200 L 245 0' fill='none' stroke-width='40' stroke='#000000'/>",e.theme.moon.stereo="100 <g id='MyrThumb-[objindex]-[toolindex]' >    \t<path d='M -25 90 L 0 10 L 25 90z' [both]/></g>",e.theme.moon.pagebgcolor="#FFFFF9",e.theme.moon.bgcolor="#E0E0F0",e.theme.moon.toolbarbackground="gradient 180 0% #000000 0.4 \t3% #FFFFFF 1 10% #FFFFFF 0.5 50% #FFFFFF 0 \t51% #000000 0 90% #000000 0.1 100% #000000 0.25",e.theme.moon.titlebackground="gradient 45 0% #FFFFFF 0.3 100% #000000 0.1",e.theme.moon.positionbackground="gradient -90 0% #FFFFFF 0.3 \t100% #000000 0.1",e.theme.moon.keyboardbackground="gradient -10 40% #000000 1 \t80% #AAAAAA 1 100% #000000 1",e.theme.moon.toolbarshadow="0px 2px 10px 2px rgba(0,0,0,0.2)",e.theme.moon.positionshadow="0px 2px 5px 2px rgba(0,0,0,0.3)",e.theme.moon.dialogbox="border-style: solid;border-width: 1px;\tborder-color:#A0A0A0;border-radius:3px;\tbox-shadow:2px 2px 3px 3px rgba(130,130,130,0.40);\tpadding:0px 0px 0px 0px;",e.theme.moon.dialogboxopen="transform:scale(1);transition:transform 0.27s ease-in-out;\ttransform-origin:50% 5%",e.theme.moon.dialogboxbgcolor="#FFF6F0",e.theme.moon.dialogboxclose="transform:scale(0.6,0)",e.theme.moon.dialogtitle="",e.theme.moon.dialogtitlebgcolor="#FFD070",e.theme.moon.titletextstyle="font-family:Lucida Grande,Lucida Sans Unicode,\tLucida Sans,Geneva,Verdana,sans-serif;font-size:16px;font-weight: bold;color:#404040",e.theme.moon.statictextstyle="font-family:Lucida Grande,Lucida Sans Unicode,\tLucida Sans,Geneva,Verdana,sans-serif;font-size:14px;color:#000000",e.theme.moon.menupanebgcolor="#F8F8FF",e.theme.moon.menupane="border-style: solid;border-width: 1px;\tborder-color:#A0A0A0;border-radius:3px;\tbox-shadow:2px 2px 3px 3px rgba(130,130,130,0.40);\tpadding:8px 24px 8px 8px;transition:transform 0.1s ease;\ttransform-origin:50% 5%",e.theme.moon.menupaneopen="transform:scale(1)",e.theme.moon.menupaneclose="transform:scale(0.6,0)",e.theme.moon.menuitem="cursor:pointer;padding-left:4px;padding-right:8px;\twidth:100%;transition:all 0.2s ease",e.theme.moon.menuitemover="background-color:#A0C0A0",e.theme.moon.menuitemidle="background:none",e.theme.moon.menufontfamily="Lucida Grande,Lucida Sans Unicode,\tLucida Sans,Geneva,Verdana,sans-serif",e.theme.moon.menufontsize=14,e.theme.moon.menufontweight="bold",e.theme.moon.menufontextra="rgba(128,128,128,0.99)",e.theme.moon.menufontidle="text-shadow:0px 0px 0px",e.theme.moon.menufontover="text-shadow:0px 0px 3px #FFFFFF",e.theme.moon.menufontdisabled="color:rgba(0,0,0,0.15)",e.theme.moon.menuseparator="stroke-width='2' stroke='black'\t opacity='0.1'",e.theme.moon.menumarksize=12.5,e.theme.moon.menumark1="<path d='M 10 40 Q 30 55 40 80 Q 55 35 95 5'\t stroke-width='20' stroke='#80C080' fill='none' />",e.theme.moon.menumark2="<circle cx='50' cy='50' r='40' fill='#FF0000'\t stroke='#B08080' stroke-width='20'/>",e.theme.moon.menumark3="<circle cx='50' cy='50' r='40' fill='#00FF00'\t stroke='#80B080' stroke-width='20'/>",e.theme.moon.titlefont="Helvetica,Arial,sans-serif",e.theme.moon.titleweight="bold",e.theme.moon.titlecolor="#F0F0F0"}function MyrApplyTheme(e){MyrIsDefined(e.toolbar)&&e.toolbar.div.height&&(MyrSetDivBackground(e.toolbar.div,e.theme.toolbarbackground),MyrIsDefined(e.theme.toolbarshadow)&&(e.toolbar.div.style.boxShadow=e.theme.toolbarshadow,e.toolbar.div.style.overflow="visible"),MyrIsDefined(e.toolbar.tool)&&MyrToolbarChange(e)),MyrIsDefined(e.title)&&e.title.div.height&&(MyrSetDivBackground(e.title.div,e.theme.titlebackground),MyrIsDefined(e.theme.titleshadow)&&(e.title.div.style.boxShadow=e.theme.titleshadow,e.title.div.style.overflow="visible")),MyrIsDefined(e.position)&&e.position.div.height&&(MyrSetDivBackground(e.position.div,e.theme.positionbackground),MyrIsDefined(e.theme.positionshadow)&&(e.position.div.style.boxShadow=e.theme.positionshadow,e.position.div.style.overflow="visible")),MyrIsDefined(e.keyboard)&&e.keyboard.div.height&&(MyrSetDivBackground(e.keyboard.div,e.theme.keyboardbackground),MyrIsDefined(e.theme.keyboardshadow)&&(e.keyboard.div.style.boxShadow=e.theme.keyboardshadow,e.keyboard.div.style.overflow="visible")),e.fatherDiv.style.backgroundColor=e.theme.bgcolor}function MyrThemeGetRawIcon(e,t,r,o,a,n,i,s,l,d,y,c,u){var f,m,p;MyrIsDefined(a)||(a=0),MyrIsDefined(n)||(n=0),MyrIsDefined(i)||(i=0),MyrIsDefined(s)||(s=0),MyrIsDefined(l)||(l=1),MyrIsDefined(d)||(d=3),MyrIsDefined(y)||(y="#404040"),MyrIsDefined(c)||(c="#000000");var M=/(^\d+) (.*$)/.exec(t);f=r/(m=parseInt(M[1])),p=parseInt(o/f),r=parseInt(r+a+i),o=parseInt(o+n+s),a=parseInt(a/f),n=parseInt(n/f),i=parseInt(i/f),s=parseInt(s/f),d/=f;var g=MyrCtx.svgHeader+"width='"+r+"' height='"+o+"'viewBox='"+-a+" "+-n+" "+(m+a+i)+" "+(p+n+s)+"'><g ";return MyrIsDefined(u)&&(g+="id='"+u+"' "),g+"style='opacity:"+l+";stroke-width:"+d+";stroke:"+y+";fill:"+c+"' >"+MyrReplaceSVGTokens(e,tag,M[2],m)+"</g></svg>"}function MyrInitTheme(e,t){var r,o=t.theme;for(r in e.theme={},MyrIsDefined(o)&&MyrIsDefined(MyrCtx.theme[o])||(o="moon"),e.themename=o,MyrCtx.theme[o])e.theme[r]=MyrCtx.theme[o][r];for(r in e.theme.unknown=MyrCtx.theme.unknown,MyrIsDefined(e.args.toolhmargin)&&(e.theme.hmargin=parseInt(e.args.toolhmargin)),MyrIsDefined(e.args.toolvmargin)&&(e.theme.vmargin=parseInt(e.args.toolvmargin)),t)0===r.indexOf("theme-")&&(e.theme[r.substr(6)]=t[r]);MyrApplyTheme(e)}function MyrToolsetAddToList(e,t){var r=t.split("-");if(MyrIsDefined(r[1])&&""!==r[1].trim()||(r[1]="std"),r[0]=r[0].trim(),r[1]=r[1].trim(),"default"!=r[0]){MyrToolsetDeleteFromList(e,r[0]);var o={};o.toolname=r[0],o.toolparam=r[1],e.push(o)}else for(var a="rewind pause play fastfw volume mixer metronome detune view page-complete zoom download print fileinfo info".split(" "),n=0;n<a.length;n++)MyrToolsetAddToList(e,a[n])}function MyrToolsetDeleteFromList(e,t){for(var r=0;r<e.length;r++)if(e[r].toolname==t)return void e.splice(r,1)}function MyrToolsetIsInList(e,t){for(var r=0;r<e.length;r++)if(e[r].toolname==t)return MyrCtx.vrai;return MyrCtx.faux}function MyrToolsetCreateList(e,t){MyrIsDefined(e.args.toolset)||(e.args.toolset="default");var r=e.args.toolset.split(" "),o=[];t&&(r=[]);for(var a=0;a<r.length;a++)MyrIsDefined(r[a])&&r[a].length>1&&("-"==r[a].substr(0,1)?MyrToolsetDeleteFromList(o,r[a].substr(1)):("+"==r[a].substr(0,1)&&(r[a]=r[a].substr(1)),MyrToolsetAddToList(o,r[a])));if(MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$protectPrint"))&&MyrToolsetDeleteFromList(o,"print"),MyrIsDefined(MyrSafeGet(e,"Myrweb[0].Header[0].$protectSave"))&&MyrToolsetDeleteFromList(o,"save"),e.isLoaded){MyrIsDefined(e.page)&&(e.page.div.height&&MyrIsDefined(e.page.view)?(0===e.page.view.length&&MyrToolsetDeleteFromList(o,"measures"),e.page.view.length+e.page.lyrics.length<=1&&MyrToolsetDeleteFromList(o,"view"),0===e.page.view.length&&0===e.page.lyrics.length&&(MyrToolsetDeleteFromList(o,"zoom"),MyrToolsetDeleteFromList(o,"page"))):(MyrToolsetDeleteFromList(o,"page"),MyrToolsetDeleteFromList(o,"view"),MyrToolsetDeleteFromList(o,"measures"),MyrToolsetDeleteFromList(o,"zoom")));var n=e.sound.nbTracks;MyrIsDefined(n)||(n=0),MyrIsDefined(e.sync.staff)&&0!==e.sync.staff.length||MyrToolsetDeleteFromList(o,"keyboard");var i=1;MyrIsDefined(e.sync.metronome)&&0!==e.sync.metronome.length||(i=0),MyrToolsetIsInList(o,"keyboard")&&n++,0===(n+=i)?(MyrToolsetDeleteFromList(o,"play"),MyrToolsetDeleteFromList(o,"stop"),MyrToolsetDeleteFromList(o,"pause"),MyrToolsetDeleteFromList(o,"fastfw"),MyrToolsetDeleteFromList(o,"rewind"),MyrToolsetDeleteFromList(o,"timeslider"),MyrToolsetDeleteFromList(o,"volume"),MyrToolsetDeleteFromList(o,"mixer"),MyrToolsetDeleteFromList(o,"keyboard")):1==n&&MyrToolsetDeleteFromList(o,"mixer"),MyrIsDefined(e.file)&&0!==e.file.length||MyrToolsetDeleteFromList(o,"download"),MyrIsDefined(e.sync)&&MyrIsDefined(e.sync.metronome)||0===n&&MyrToolsetDeleteFromList(o,"metronome")}return o}function MyrToolbarGainFocus(e,t){switch(t.tag){case"pgfield":default:t.edittext=(e.page.currentPage+1).toString()}t.updated=!1,MyrToolbarUpdate(e)}function MyrToolbarLoseFocus(e,t){if(null!==t){switch(t.tag){case"pgfield":default:t.edittext=null}e.toolfocus=null,t.updated=!1,MyrToolbarUpdate(e)}}function MyrToolbarProcessKey(e,t,r){var o,a=!0;if(t&&null!==t.edittext){if(8==r||46==r)t.edittext.length>0&&(t.edittext=t.edittext.substr(0,t.edittext.length-1)),a=!1;else if(r>=48&&57>=r)t.edittext+=(r-48).toString(),a=!1;else if(27==r)MyrToolbarLoseFocus(e,e.toolfocus),e.toolfocus=null,a=!1;else if(13==r){switch(t.tag){case"pgfield":default:1>(o=parseInt(t.edittext))?o=1:o>e.nbPages&&(o=e.nbPages),e.page.currentPage=o-1,MyrDisplayPage(e,e.page.currentPage,MyrCtx.faux)}MyrToolbarLoseFocus(e,e.toolfocus),e.toolfocus=null,a=!1}t.updated=!1,MyrToolbarUpdate(e)}return a}function MyrToolbarInitTool(e,t,r){var o,a,n,i,s,l;if(s=t.screenwidth,l=t.screenheight,MyrIsDefined(s)||(s=1),MyrIsDefined(l)||(l=1),t.tag=r,MyrIsDefined(e.theme[r])||(r="unknown"),o=e.theme[r],i=/(^\d+) (.*$)/.exec(o),t.width100=n=parseFloat(i[1]),t.width=n+2*parseFloat(e.theme.hmargin),t.height=100+2*parseFloat(e.theme.vmargin),t.nextundermouse=t.undermouse=MyrCtx.faux,s>1){o=i[2],o=MyrReplaceSVGTokens(e,t.index,o),o="<g id='Myr-"+t.tag+"-"+e.index+"-"+t.index+"' fill='"+MyrCreateGradient(e.theme.inactivefill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.inactivestroke,MyrCtx.vrai)+"' stroke-width='"+e.theme.inactivestrokewidth+"' opacity='"+e.theme.inactiveopacity+"' style='transition:all "+e.theme.transition+";transform-origin: 50% 50%; transform:scale("+e.theme.inactivescale+","+e.theme.inactivescale+")'>"+o+"</g>",a="<g id='MyrOver-"+t.tag+"-"+e.index+"-"+t.index+"' opacity='"+e.theme.notoveropacity+"' fill='"+MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai)+"' transform='scale("+e.theme.notoverscale+","+e.theme.notoverscale+")' style='transition: all "+e.theme.overtransition+";transform-origin: 50% 50%; transform:scale("+e.theme.notoverscale+","+e.theme.notoverscale+")'>"+e.theme.over+"</g>",o=(a=MyrReplaceSVGTokens(e,t.index,a))+o;var d="<style>";d+=" @keyframes MyrPulse-"+e.index+" { 0% {fill:"+MyrCreateGradient(e.theme.pulsefill,MyrCtx.vrai)+";} 100% {fill:"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+";}}",d+=" @-moz-keyframes MyrPulse-"+e.index+" { 0% {fill:"+MyrCreateGradient(e.theme.pulsefill,MyrCtx.vrai)+";} 100% {fill:"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+";}}",o=(d+=" </style>")+o,o=MyrCtx.svgHeader+"width='"+s+"' height='"+l+"' viewBox='"+-parseFloat(e.theme.hmargin)+" "+-parseFloat(e.theme.vmargin)+" "+t.width+" "+t.height+"'>"+o+"</svg>",t.svg=o,MyrIsDefined(t.div)&&(t.div.innerHTML=t.svg)}}function MyrToolbarAddTool(e,t,r,o){var a;MyrIsDefined(o)||(o=1),e.toolbar.tool[r]=a={},e.toolbar.tool[r].index=r,e.toolbar.tool[r].gap=o,MyrToolbarInitTool(e,a,t)}function MyrToolSetActiveState(e,t,r,o){var a=document.getElementById("Myr-"+t),n=document.getElementById("MyrOver-"+t);a&&("inactive"==r?(a.style.animation="",a.style.transition="all "+e.theme.transition,a.style.fill=MyrCreateGradient(e.theme.inactivefill,MyrCtx.vrai),a.style.stroke=MyrCreateGradient(e.theme.inactivestroke,MyrCtx.vrai),a.style.strokeWidth=e.theme.inactivestrokewidth,a.style.opacity=e.theme.inactiveopacity,a.style.transform="scale("+e.theme.inactivescale+","+e.theme.inactivescale+")"):"hilited"==r?(a.style.animation="MyrPulse-"+e.index+" "+e.theme.pulsetransition+" infinite alternate",a.style.fill=e.theme.pulsefill,a.style.stroke=e.theme.stroke,a.style.strokeWidth=e.theme.strokewidth,a.style.opacity=e.theme.opacity,a.style.transform="scale("+e.theme.scale+","+e.theme.scale+")"):(a.style.animation="",a.style.transition="all "+e.theme.transition,a.style.fill=e.theme.fill,a.style.stroke=e.theme.stroke,a.style.strokeWidth=e.theme.strokewidth,a.style.opacity=e.theme.opacity,a.style.transform="scale("+e.theme.scale+","+e.theme.scale+")"),n&&(o&&"inactive"!=r?(n.style.fill=MyrCreateGradient(e.theme.overfill,MyrCtx.vrai),n.style.stroke=MyrCreateGradient(e.theme.overstroke,MyrCtx.vrai),n.style.strokeWidth=e.theme.overstrokewidth,n.style.opacity=e.theme.overopacity,n.style.transform="scale("+e.theme.overscale+","+e.theme.overscale+")"):(n.style.fill=MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai),n.style.stroke=MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai),n.style.strokeWidth=e.theme.notoverstrokewidth,n.style.opacity=e.theme.notoveropacity,n.style.transform="scale("+e.theme.notoverscale+","+e.theme.notoverscale+")")))}function MyrToolbarDrawTool(e,t,r,o,a){var n=document.getElementById("Myr-"+t.tag+"-"+e.index+"-"+t.index);if(MyrInstanceHasOpenMenu()&&(o=MyrCtx.faux),n&&(t.updated==MyrCtx.faux||r!=t.state||o!=t.undermouse||a!=t.pos)){if(MyrToolSetActiveState(e,t.tag+"-"+e.index+"-"+t.index,r,o),t.pos!=a){var i=document.getElementById("MyrThumb-"+e.index+"-"+t.index);i&&i.setAttribute("transform","translate("+a*t.width100+")");var s=document.getElementById("MyrText-"+e.index+"-"+t.index);s&&(s.textContent?s.textContent=a:s.innerText=a),t.pos=a}t.state=r,t.undermouse=o,t.updated=MyrCtx.vrai}}function MyrToolbarIsToolActive(e,t){var r;if(!e.isLoaded||!MyrIsDefined(e.page))return MyrCtx.faux;switch(r=MyrIsDefined(e.sound.track)&&e.sound.track.length>0||MyrIsDefined(e.sync.metronome)&&e.sync.metronome.active,t){case"view":return MyrCtx.vrai;case"pgfield":case"pgpop":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.nbPages>1?MyrCtx.vrai:MyrCtx.faux;case"pgp":case"pgpr":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.page.currentPage<e.nbPages-1?MyrCtx.vrai:MyrCtx.faux;case"pgm":case"pgmr":return e.sound.playState!=MyrCtx.STATE_STOPPED?MyrCtx.faux:e.page.currentPage>0?MyrCtx.vrai:MyrCtx.faux;case"zoompop":case"zoomfield":return MyrCtx.vrai;case"zoomp":case"zoompr":return 100*e.page.zoom<MyrCtx.zoomtab[MyrCtx.zoomtab.length-1]-5?MyrCtx.vrai:MyrCtx.faux;case"zoomm":case"zoommr":return 100*e.page.zoom>MyrCtx.zoomtab[0]+5?MyrCtx.vrai:MyrCtx.faux;case"measures":return MyrCtx.vrai;case"volume":return r;case"play":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_PLAYING?2:r:MyrCtx.faux;case"pause":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_PAUSED?2:r:MyrCtx.faux;case"stop":return MyrAreAllTracksReady(e)?e.sound.playState==MyrCtx.STATE_STOPPED?MyrCtx.faux:r:MyrCtx.faux;case"rewind":case"fastfw":return MyrAreAllTracksReady(e)?r:MyrCtx.faux;case"mixer":return MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"view":case"download":case"print":return MyrCtx.vrai;case"metronome":return MyrIsDefined(e.sync.metronome)&&e.sync.metronome.active?2:MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"detune":return MyrAreAllTracksReady(e)?MyrCtx.vrai:MyrCtx.faux;case"info":case"fileinfo":return MyrCtx.vrai;default:return MyrCtx.faux}}function MyrToolbarGetToolList(e){var t,r="";for(t=0;t<e.length;t++)r+=e[t].toolname+"="+e[t].toolparam+"/";return r}function MyrToolbarChange(e,t){var r,o=e.toolbar.toollist,a=MyrToolsetCreateList(e,t);if(e.toolbar.toollist=MyrToolbarGetToolList(a),!MyrIsDefined(o)||o!=e.toolbar.toollist){if(MyrIsDefined(e.toolbar.tool)){for(r=0;r<e.toolbar.tool.length;r++)e.toolbar.div.removeChild(e.toolbar.tool[r].div),e.toolbar.tool[r].div=null;e.toolbar.tool=null}e.toolbar.tool=[];var n=0;for(r=0;r<a.length;r++)"page"==a[r].toolname?"complete"==a[r].toolparam?(MyrToolbarAddTool(e,"pgmr",n++,0),MyrToolbarAddTool(e,"pgfield",n++,0),MyrToolbarAddTool(e,"pgpr",n++)):"reduced"==a[r].toolparam?MyrToolbarAddTool(e,"pgpop",n++):(MyrToolbarAddTool(e,"pgm",n++),MyrToolbarAddTool(e,"pgp",n++)):"volume"==a[r].toolname?MyrToolbarAddTool(e,"volume",n++):"zoom"==a[r].toolname?"complete"==a[r].toolparam?(MyrToolbarAddTool(e,"zoommr",n++,0),MyrToolbarAddTool(e,"zoomfield",n++,0),MyrToolbarAddTool(e,"zoompr",n++)):"reduced"==a[r].toolparam?MyrToolbarAddTool(e,"zoompop",n++):(MyrToolbarAddTool(e,"zoomm",n++),MyrToolbarAddTool(e,"zoomp",n++)):"detune"==a[r].toolname?MyrIsDefined(e.sound.useAudioFailSafe)&&e.sound.useAudioFailSafe!=MyrCtx.faux||MyrToolbarAddTool(e,a[r].toolname,n++):"metronome"==a[r].toolname?MyrToolbarAddTool(e,a[r].toolname,n++):"rewind"==a[r].toolname||"fastfw"==a[r].toolname?e.sound.canJump&&MyrToolbarAddTool(e,a[r].toolname,n++):MyrToolbarAddTool(e,a[r].toolname,n++);var i,s=0;for(j=0;j<e.toolbar.tool.length;j++)s+=e.toolbar.tool[j].width100;0===s||e.minimal?i=e.toolbar.div.height:(i=100*e.width/s)>e.toolbar.div.height&&(i=e.toolbar.div.height);var l=0,d=0;for(j=0;j<e.toolbar.tool.length;j++)e.toolbar.tool[j].screenheight=i,e.toolbar.tool[j].screenwidth=i*e.toolbar.tool[j].width/e.toolbar.tool[j].height,l+=e.toolbar.tool[j].screenwidth,d+=e.toolbar.tool[j].gap;e.minimal&&(e.width=l,e.unclippedFather.style.width=e.fatherDiv.style.width=e.toolbar.div.style.width=l+"px");var y=(e.width-l)/(d+1),c=(e.toolbar.div.height-i)/2;y>i&&(y=i);var u=y;for(j=0;j<e.toolbar.tool.length;j++)e.toolbar.tool[j].screenleft=u,e.toolbar.tool[j].screenright=u+e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].screentop=c,u+=e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].div=MyrCreateUndraggableElement("div",130),e.toolbar.tool[j].div.style.position="absolute",MyrSetDivPos(e.toolbar.tool[j].div,e.toolbar.tool[j].screenleft,e.toolbar.tool[j].screentop),MyrSetDivSize(e.toolbar.tool[j].div,e.toolbar.tool[j].screenwidth,e.toolbar.tool[j].screenheight),e.toolbar.div.appendChild(e.toolbar.tool[j].div),MyrToolbarInitTool(e,e.toolbar.tool[j],e.toolbar.tool[j].tag),u+=e.toolbar.tool[j].gap*y}MyrToolbarUpdate(e,MyrCtx.vrai)}function MyrToolbarUpdate(e,t){if(MyrIsDefined(e)&&MyrIsDefined(e.toolbar)&&MyrIsDefined(e.toolbar.tool))for(var r=0;r<e.toolbar.tool.length;r++){var o,a,n=e.toolbar.tool[r];o=(o=MyrToolbarIsToolActive(e,n.tag))==MyrCtx.faux?"inactive":o==MyrCtx.vrai?"active":"hilited","volume"==n.tag?a=MyrIsDefined(e.sound.generalVolume)?e.sound.generalVolume:.8:"pgfield"==n.tag&&(a=MyrIsDefined(e.page)&&MyrIsDefined(e.page.currentPage)?e.page.currentPage+1:1),MyrIsDefined(n.edittext)&&(a=n.edittext+"|"),n.state==o&&n.pos==a&&n.nextundermouse==n.undermouse&&n.updated&&t!=MyrCtx.vrai||(t&&(n.updated=MyrCtx.faux),MyrToolbarDrawTool(e,n,o,n.nextundermouse,a))}}function MyrIsToolPresent(e,t){for(var r=0;r<e.toolbar.tool.length;r++)if(e.toolbar.tool[r].tag==t)return MyrCtx.vrai;return MyrCtx.faux}function MyrToolbarClickTool(e,t){var r,o,a,n,i=e.toolbar.tool[t];if(n=e.toolfocus,"inactive"!=i.state)if("pgm"==i.tag||"pgmr"==i.tag)0>(a=e.page.currentPage-1)&&(a=0),MyrDisplayPage(e,a,MyrCtx.faux);else if("pgp"==i.tag||"pgpr"==i.tag)(a=e.page.currentPage+1)>e.nbPages-1&&(a=e.nbPages-1),MyrDisplayPage(e,a,MyrCtx.faux);else if("volume"==i.tag){var s=(i.width,i.width100);s=i.screenwidth-i.screenwidth*(i.width100/i.width),0>(o=(e.mouse.x-i.screenleft-s)/(i.screenwidth-2*s))?o=0:o>1&&(o=1),MyrAction(e,"action_volume "+o),i.updated=MyrCtx.faux}else if("zoompop"===i.tag||"zoomfield"===i.tag||2===MyrCtx.button&&("zoomp"===i.tag||"zoompr"===i.tag||"zoomm"===i.tag||"zoommr"===i.tag))MyrIsDefined(e.page.zoom)?e.page.zoom:1,MyrMenuClear(e,0),MyrAddMenuItemsZoom(e),MyrPopup(e);else if("zoomp"==i.tag||"zoompr"==i.tag){for(MyrIsDefined(e.page.zoom)?e.page.zoom:1,r=0;r<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[r]+5;r++);r<MyrCtx.zoomtab.length-1&&MyrAction(e,"action_zoom "+MyrCtx.zoomtab[r+1])}else if("zoomm"==i.tag||"zoommr"==i.tag){for(MyrIsDefined(e.page.zoom)?e.page.zoom:1,r=0;r<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[r]+5;r++);r>0&&MyrAction(e,"action_zoom "+MyrCtx.zoomtab[r-1])}else"mixer"==i.tag?MyrMixTable(e):"play"==i.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_PLAYING):"pause"==i.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_PAUSED):"stop"==i.tag?MyrAction(e,"action_playstate "+MyrCtx.STATE_STOPPED):"fastfw"==i.tag?MyrAction(e,"action_playrelpos 1"):"rewind"==i.tag?MyrAction(e,"action_playrelpos -1"):"view"==i.tag?(MyrMenuClear(e,0),MyrAddMenuItemsPart(e),MyrAddMenuItemsLyrics(e),MyrPopup(e)):"metronome"==i.tag?(MyrMenuClear(e,0),MyrAddMenuItemsMetronome(e),MyrAddMenuItemsTempo(e),MyrPopup(e)):"detune"==i.tag?(MyrMenuClear(e,0),MyrAddMenuItemsDetune(e),MyrPopup(e)):"download"==i.tag?(MyrMenuClear(e,0),MyrAddMenuItemsDownload(e,MyrIsToolPresent(e,"print")),MyrPopup(e)):"print"==i.tag?MyrAction(e,"action_print"):"pgfield"==i.tag?e.toolfocus=i:"info"==i.tag?MyrAction(e,"action_info"):"fileinfo"==i.tag&&MyrAction(e,"action_fileinfo");e.focus&&(n!=e.toolfocus&&MyrToolbarLoseFocus(e,n),null!==e.toolfocus&&e.focus&&MyrToolbarGainFocus(e,e.toolfocus)),MyrToolbarUpdate(e)}function MyrMenuNew(e,t){MyrIsDefined(e.menu)||(e.menu={},e.menu.opened=-1),MyrIsDefined(e.menu.list)||(e.menu.list=[]);var r={};return r.tag=t,r.item=[],r.height=0,r.width=0,e.menu.list.push(r),e.menu.list.length-1}function MyrMenuAddItem(e,t,r,o,a,n){var i=e.menu.list[t];MyrIsDefined(i.item)||(i.item=[]);var s={};return s.value=o,MyrIsDefined(a)?s.tag=a:s.tag=0,MyrIsDefined(n)?s.enabled=n:s.enabled=MyrCtx.vrai,"-"==o.charAt(0)?(s.separator=MyrCtx.vrai,s.enabled=MyrCtx.faux,s.value=o.substr(1)):s.separator=MyrCtx.faux,s.mark=r,i.item.push(s),i.item.length-1}function MyrMenuClear(e,t){if(MyrIsDefined(e.menu)&&e.menu.lastopened>=0){for(var r=e.menu.list[e.menu.lastopened],o=0;o<r.item.length;o++)r.item[o].div&&e.menu.div.removeChild(r.item[o].div),r.item[o].div=null;e.menu.fatherDiv=null,e.menu.lastopened=-1}t>=0&&MyrIsDefined(e.menu)&&MyrIsDefined(e.menu.list)&&t<e.menu.list.length&&(e.menu.list[t].item=[])}function MyrMenuDelete(e,t){e.menulist[t]=null,e.menulist.splice(t,1)}function MyrMenuManage(e,t,r){var o;if(t.menu.opened>=0){if(r>=0)return o=t.menu.list[t.menu.opened].item[r],"over"==e&&o.enabled?(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.vrai),MyrCompleteStyle(o.div,t.menu.theme.menuitemover),t.menu.lastoveritem=r):"out"==e&&(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.faux),MyrCompleteStyle(o.div,t.menu.theme.menuitemidle),t.menu.lastoveritem=-1),"click"==e&&(""!==t.menu.theme.menufontidle&&MyrMenuItemSetFontStyle(o,t.menu.theme,MyrCtx.faux),MyrCompleteStyle(o.div,t.menu.theme.menuitemidle),t.menu.processclick(t,t.menu.tag,o.tag),MyrMenuClose(t),t.menu.lastoveritem=-1),MyrCtx.vrai;if("click"==e)return t.menu.lastoveritem>=0&&t.menu.processclick(t,t.menu.tag,t.menu.list[t.menu.opened].item[t.menu.lastoveritem].tag),MyrMenuClose(t),t.menu.lastoveritem=-1,MyrCtx.vrai}return MyrCtx.faux}function MyrMenuItemSetFontStyle(e,t,r){var o="font-family:"+t.menufontfamily+";font-size:"+t.menufontsize+"px;font-weight:"+t.menufontweight+";";o+=e.enabled?r?t.menufontover:t.menufontidle:t.menufontdisabled;var a=e.div.getElementsByTagName("span");MyrIsDefined(a[0])&&MyrCompleteStyle(a[0],o)}function MyrMenuItemSetContent(e,t,r,o){var a="";t.mark>0&&(a=r["menumark"+t.mark],t.enabled||(a="<g opacity=0.3>"+a+"</g>")),MyrIsDefined(a)||(a=""),a="<svg width='"+r.menumarksize+"' height='"+r.menumarksize+"' viewBox='0 0 100 100'>"+a+"</svg>";var n="font-family:"+r.menufontfamily+";font-size:"+r.menufontsize+"px;font-weight:"+r.menufontweight+";";if(n+=t.enabled?o?r.menufontover:r.menufontidle:r.menufontdisabled,t.separator){var i="",s=(e.menu.maxitemwidth-t.width)/2;console.log("line "+s),s>0&&(i="<svg width='"+s+"' height='"+r.menumarksize+"' viewBox='0 0 "+s+" "+r.menumarksize+"'><path d='M 0 "+r.menumarksize/2+" l "+s+" 0' "+r.menuseparator+"/></svg>"),t.div.innerHTML="<center><table cellpadding='0' cellspacing='0'><tr><td width='"+s+"'>"+i+"</td><td style='white-space: nowrap;"+n+"' > "+t.value+" </td><td width='"+s+"'>"+i+"</td></td></tr></table></center>"}else t.div.innerHTML="<table cellpadding='0' cellspacing='0'><tr><td><span style='white-space: nowrap;"+n+"'><img width='"+r.menumarksize+"'>"+a+"</img> "+t.value+"</span></td></tr></table>"}function MyrMenuItemSetMark(e,t,r,o){e.menu.list[t].item[r].mark=o}function MyrMenuItemSetMark(e,t,r,o){e.menu.list[t].item[r].enabled=o}function MyrMenuGetMenuIndexByTag(e,t){if(!MyrIsDefined(e.menu)||!MyrIsDefined(e.menu.list))return-1;for(var r=0;r<e.menu.list.length;r++)if(e.menu.list[r].tag==t)return r;return-1}function MyrMenuGetItemIndexByTag(e,t,r){for(var o=0;o<e.menu.list[t].item.length;o++)if(e.menu.list[t].item[o].tag==r)return o;return-1}function MyrMenuGetPaneSize(e,t,r){var o,a=document.createElement("div");a.setAttribute("unselectable","on"),a.setAttribute("draggable","false"),a.style="",MyrCompleteStyle(a,"position:absolute;width:auto;height:auto;visibility:hidden;"),MyrCompleteStyle(a,t.menupane);var n="<svg width='"+t.menumarksize+"' height='"+t.menumarksize+"' viewBox='0 0 100 100'><circle cx='50' cy='50' r='40' fill='#0000FF'/></svg>",i="font-family:"+t.menufontfamily+";font-size:"+t.menufontsize+"px;font-weight:"+t.menufontweight+";",s=[];for(o=0;o<r.item.length;o++)s[o]=document.createElement("div"),s[o].innerHTML="<table cellpadding='0' cellspacing='0'><tr><td><span style='white-space: nowrap;"+i+"'><img width='"+t.menumarksize+"'>"+n+"</img> "+r.item[o].value+"</span></td></tr></table>",MyrCompleteStyle(s[o],"position:static;width:auto;height:auto;background-color:#FF0000"),MyrCompleteStyle(s[o],t.menuitem),MyrCompleteStyle(s[o],t.menuitemidle),a.appendChild(s[o]);document.body.appendChild(a),e.menu.width=a.clientWidth,e.menu.height=a.clientHeight;var l=0;for(o=0;o<r.item.length;o++){var d=s[o].getElementsByTagName("table")[0].clientWidth;r.item[o].width=d,d>l&&(l=d);var y=s[o].getBoundingClientRect();r.item[o].height=y.bottom-y.top,r.item[o].top=y.top}e.menu.maxitemwidth=l,a.parentNode.removeChild(a)}function MyrMenuOpen(e,t,r,o,a,n,i,s){var l=e.menu.list[t];MyrMenuGetPaneSize(e,n,l),(o-=e.menu.width/2)+e.menu.width>r.clientWidth&&(o=r.clientWidth-e.menu.width),0>o&&(o=0),(a-=e.menu.height/2)+e.menu.height>r.clientHeight&&(a=r.clientHeight-e.menu.height),0>a&&(a=0),MyrIsDefined(s)||(s=MyrMenuManage),e.menu.theme=n,MyrIsDefined(e.menu.div)||(e.menu.div=document.createElement("div"),e.menu.div.setAttribute("unselectable","on"),e.menu.div.setAttribute("draggable","false"),MyrCompleteStyle(e.menu.div,"z-index:2000;position:absolute;width:auto;height:auto"),MyrCompleteStyle(e.menu.div,n.menupane),MyrSetDivBackground(e.menu.div,n.menupanebgcolor),MyrCompleteStyle(e.menu.div,n.menupaneclose),r.appendChild(e.menu.div),window.getComputedStyle(e.menu.div).transform),e.menu.processclick=i,e.menu.managemouseevt=s,MyrCompleteStyle(e.menu.div,"left:"+o+"px;top:"+a+"px;"),MyrMenuClear(e,-1);for(var d=0;d<l.item.length;d++)l.item[d].div=document.createElement("div"),MyrCompleteStyle(l.item[d].div,"position:static;width:auto;height:auto"),MyrCompleteStyle(l.item[d].div,n.menuitem),MyrCompleteStyle(l.item[d].div,n.menuitemidle),MyrMenuItemSetContent(e,l.item[d],n,MyrCtx.faux),l.item[d].div.onmouseover=MyrCallback(s,"over",e,d),l.item[d].div.onmouseout=MyrCallback(s,"out",e,d),l.item[d].div.onclick=MyrCallback(s,"click",e,d),e.menu.div.appendChild(l.item[d].div);e.menu.opened=e.menu.lastopened=t,e.menu.fatherdiv=r,MyrCompleteStyle(e.menu.div,n.menupaneopen)}function MyrMenuClose(e){e.menu.opened>=0&&(MyrCompleteStyle(e.menu.div,e.menu.theme.menupaneclose),e.menu.opened=-1)}function MyrAddMenuItemsDetune(e){var t="<path d='M 20 10 L 20 100 M 40 0 L 40 90'/><path d='M 0 37 L 60 25 M 0 73 L 60 61' stroke-width='20'/>",r="<path d='M 20 10 L 20 100 C 60 50 60 40 20 60' />",o="<path d='M 20 10 L 20 70 L 40 60 M 40 100 L 40 30 L 20 40' />";t="<svg width='14' height='20' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+t+"</g></svg>",r="<svg width='14' height='20' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+r+"</g></svg>",o="<svg width='14' height='20' viewBox='0 0 70 100'><g stroke='#404040' stroke-width='10' fill='none'>"+o+"</g></svg>",MyrMenuAddItem(e,0,0,"-Detune",""),MyrMenuAddItem(e,0,5==e.sound.playMode.detune?1:0,t+t+t+t+t,"action_detune 5"),MyrMenuAddItem(e,0,4==e.sound.playMode.detune?1:0,t+t+t+t,"action_detune 4"),MyrMenuAddItem(e,0,3==e.sound.playMode.detune?1:0,t+t+t,"action_detune 3"),MyrMenuAddItem(e,0,2==e.sound.playMode.detune?1:0,t+t,"action_detune 2"),MyrMenuAddItem(e,0,1==e.sound.playMode.detune?1:0,t,"action_detune 1"),MyrMenuAddItem(e,0,0===e.sound.playMode.detune?1:0,o,"action_detune 0"),MyrMenuAddItem(e,0,-1==e.sound.playMode.detune?1:0,r,"action_detune -1"),MyrMenuAddItem(e,0,-2==e.sound.playMode.detune?1:0,r+r,"action_detune -2"),MyrMenuAddItem(e,0,-3==e.sound.playMode.detune?1:0,r+r+r,"action_detune -3"),MyrMenuAddItem(e,0,-4==e.sound.playMode.detune?1:0,r+r+r+r,"action_detune -4"),MyrMenuAddItem(e,0,-5==e.sound.playMode.detune?1:0,r+r+r+r+r,"action_detune -5")}function MyrAddMenuItemsMetronome(e){!e.sound.useAudioFailSafe&&MyrIsDefined(e.sync)&&MyrIsDefined(e.sync.metronome)&&(MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.metronome,25,25,2,2,2,2,.3,3,"#000000","none"),""),MyrMenuAddItem(e,0,e.sound.playMode.metronome.before?1:0,MyrThemeGetRawIcon(e,e.theme.tickbefore,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebefore"),MyrMenuAddItem(e,0,e.sound.playMode.metronome.bar?1:0,MyrThemeGetRawIcon(e,e.theme.tickbar,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebar"),MyrMenuAddItem(e,0,e.sound.playMode.metronome.beat?1:0,MyrThemeGetRawIcon(e,e.theme.tickbeat,60,20,5,7,5,2,1,2,"#606060","#A06090"),"action_metronomebeat"))}function MyrAddMenuItemsTempo(e){var t=MyrThemeGetRawIcon(e,e.theme.slow,25,15,0,0,4,0,.4),r=MyrThemeGetRawIcon(e,e.theme.fast,20,19,0,0,4,0,.4);MyrMenuAddItem(e,0,0,"- "+t+r+" ",""),t=MyrThemeGetRawIcon(e,e.theme.slow,25,15,0,0,4,0,1),r=MyrThemeGetRawIcon(e,e.theme.fast,20,19,0,0,4,0,1),MyrMenuAddItem(e,0,.75==e.sound.playMode.tempo?1:0,"50% &nbsp;"+t+t+t+t,"action_tempo 0.5"),MyrMenuAddItem(e,0,.75==e.sound.playMode.tempo?1:0,"70% &nbsp;"+t+t+t,"action_tempo 0.70"),MyrMenuAddItem(e,0,.8==e.sound.playMode.tempo?1:0,"85% &nbsp;"+t+t,"action_tempo 0.80"),MyrMenuAddItem(e,0,.95==e.sound.playMode.tempo?1:0,"95% &nbsp;"+t,"action_tempo 0.95"),MyrMenuAddItem(e,0,1==e.sound.playMode.tempo?1:0,"100% &nbsp;","action_tempo 1.00"),MyrMenuAddItem(e,0,1.05==e.sound.playMode.tempo?1:0,"105% &nbsp;"+r,"action_tempo 1.05"),MyrMenuAddItem(e,0,1.15==e.sound.playMode.tempo?1:0,"115% &nbsp;"+r+r,"action_tempo 1.15"),MyrMenuAddItem(e,0,1.25==e.sound.playMode.tempo?1:0,"125% &nbsp;"+r+r+r,"action_tempo 1.25"),MyrMenuAddItem(e,0,1.25==e.sound.playMode.tempo?1:0,"150% &nbsp;"+r+r+r+r,"action_tempo 1.5")}function MyrAddMenuItemsTracks(e){for(var t=0;t<e.sound.track.length;t++)MyrMenuAddItem(e,0,e.sound.track[t].volume>0?1:0,t+1+". "+e.sound.track[t].name,"action_mixer "+t+" volume "+(e.sound.track[t].volume>0?0:1))}function MyrAddMenuItemsDownload(e,t){MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.download,25,25,2,2,2,2,.3,3,"#000000","none"),"");for(var r=0;r<e.file.length;r++)MyrMenuAddItem(e,0,0,e.file[r].name+" ("+Math.floor(e.file[r].data.length/1024)+"k)","action_download "+r)}function MyrAddMenuItemsPart(e){var t;if(e.page.view.length>0){MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.overlay,15,21,2,2,2,2,.4,2,"#404040","#808080"),"");var r=MyrThemeGetRawIcon(e,e.theme.barnum,35,18,2,2,2,2,1,2,"#808080","none");if(MyrMenuAddItem(e,0,e.page.displaybars?1:0,r,"action_displaybars "+(e.page.displaybars^MyrCtx.vrai),"view"==e.page.viewType),e.page.view.length+e.page.lyrics.length>1){var o=MyrThemeGetRawIcon(e,e.theme.note,8,16,0,2,0,2,.4,2,"none","#000000");for(MyrMenuAddItem(e,0,0,"-"+o+o+o,""),t=0;t<e.page.view.length;t++)MyrMenuAddItem(e,0,"view"==e.page.viewType&&e.page.viewIndex==t?1:0,e.page.view[t].name,"action_viewpart "+t)}return MyrCtx.vrai}return MyrCtx.faux}function MyrAddMenuItemsLyrics(e){var t;if(e.page.lyrics.length>0){if(e.page.view.length+e.page.lyrics.length>1)for(MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.txt,20,15,2,2,2,2,.4,1,"#000000","none"),""),t=0;t<e.page.lyrics.length;t++)MyrMenuAddItem(e,0,"lyrics"==e.page.viewType&&e.page.viewIndex==t?1:0,e.page.lyrics[t].name,"action_viewlyrics "+t);return MyrCtx.vrai}return MyrCtx.faux}function MyrAddMenuItemsZoom(e){var t;for(t=0;t<MyrCtx.zoomtab.length&&100*e.page.zoom>MyrCtx.zoomtab[t]+5;t++);MyrMenuAddItem(e,0,0,"-"+MyrThemeGetRawIcon(e,e.theme.magnifier,20,20,4,4,4,4,.3,3,"#000000","none"));for(var r=0;r<MyrCtx.zoomtab.length;r++)MyrMenuAddItem(e,0,r==t?1:0,MyrCtx.zoomtab[r]+"%","action_zoom "+MyrCtx.zoomtab[r])}function MyrAddMenuItemsKbd(e){var t,r,o;for(MyrMenuAddItem(e,0,0,"-Octave"),t=-4;4>t;t++)MyrMenuAddItem(e,0,t===e.keyboard.octaveshift?1:0,(t>0?" +":" ")+t.toString(),"action_kbd_octave "+t);for(MyrMenuAddItem(e,0,0,"-Staves"),t=0;t<e.sync.staff.length;t++)MyrBool(e.args.keyboardusenotecolor)==MyrCtx.vrai?o="":(r=MyrKbdGetStaffColor(e,t),o="<svg width='"+e.theme.menumarksize+"' height='"+e.theme.menumarksize+"' viewBox='0 0 100 100'><circle cx='50' cy='50' r='50' stroke='none' fill='"+r+"'></svg>"),MyrMenuAddItem(e,0,e.sync.staff[t].onKbd?1:0,e.sync.staff[t].name+" "+o,"action_kbd_viewstaff "+t)}function MyrPopup(e){MyrMenuOpen(e,0,e.unclippedFather,e.mouse.x,e.mouse.y,e.theme,MyrMenuClickProcess)}function MyrMenuClickProcess(e,t,r){MyrAction(e,r)}function MyrDlogNew(e,t,r,o,a,n){if(MyrIsDefined(a)||(a=0),MyrIsDefined(n)||(n=0),MyrIsDefined(e.dlog)||(e.dlog={}),MyrIsDefined(e.dlog.list)||(e.dlog.list=[]),MyrDlogGetDlogIndexByTag(e,t)>=0)return-1;var i={};return i.tag=t,i.item=[],i.minheight=n,i.minwidth=a,e.dlog.list.splice(0,0,i),MyrDlogAddItem(e,0,"title",r,"boxtitle",0,null,"left middle",0,0),o&&MyrDlogAddTool(e,0,e.theme.dlogclosebox,20,20,0,0,"boxclose",MyrDlogCloseBoxManage,"right middle",0,0),0}function MyrDlogAddItem(e,t,r,o,a,n,i,s,l,d){var y=e.dlog.list[t];MyrIsDefined(y.item)||(y.item=[]);var c={};return MyrIsDefined(r)?c.style=r:c.style="none",MyrIsDefined(o)?c.caption=o:c.caption="",MyrIsDefined(n)?c.value=n:c.value=0,MyrIsDefined(a)?c.tag=a:c.tag="undef",MyrIsDefined(i)?c.vectprocess=i:c.vectprocess=null,MyrIsDefined(s)?c.position=s:c.position="",MyrIsDefined(l)?c.offsetx=l:c.offsetx=0,MyrIsDefined(d)?c.offsety=d:c.offsety=0,y.item.push(c),y.item.length-1}function MyrDlogClear(e,t){if(MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list)&&MyrIsDefined(e.dlog.list[o])){for(var r=e.dlog.list[t],o=0;o<r.item.length;o++)r.item[o].div&&e.dlog.div.removeChild(r.item[o].div),r.item[o].div=null;r.box=null,r.item=[]}}function MyrDlogDelete(e,t){e.dlog.list[t]=null,e.dlog.list.splice(t,1)}function MyrDlogGetDlogIndexByTag(e,t){if(!MyrIsDefined(e.dlog)||!MyrIsDefined(e.dlog.list))return-1;for(var r=0;r<e.dlog.list.length;r++)if(e.dlog.list[r].tag==t)return r;return-1}function MyrDlogGetItemIndexByTag(e,t,r){for(var o=0;o<e.dlog.list[t].item.length;o++)if(e.dlog.list[t].item[o].tag==r)return o;return-1}function MyrDlogSetItemValue(e,t,r,o){var a=MyrDlogGetDlogIndexByTag(e,t),n=MyrDlogGetItemIndexByTag(e,a,r),i=e.dlog.list[a].item[n];if("progress"==i.style){var s=i.div.children[0],l=i.div.clientWidth;s.style.width=parseInt(l*o/100)+"px"}else i.div.innerHTML=o}function MyrDlogOpen(e,t,r,o,a,n,i){var s,l=e.dlog.list[t],d={};MyrIsDefined(l.div)||(l.div=document.createElement("div"),l.div.setAttribute("unselectable","on"),l.div.setAttribute("draggable","false"),MyrCompleteStyle(l.div,"visibility:hidden;z-index:2000;position:absolute;left:0px;top:0;width:"+r.clientWidth+"px;height:"+r.clientHeight+"px"),MyrCompleteStyle(l.div,i.dialogbox),MyrSetDivBackground(l.div,i.dialogboxbgcolor),r.appendChild(l.div),window.getComputedStyle(l.div).transform);var y,c,u,f,m={};m.y=m.lineheight=m.leftx=m.centerx=m.rightx=m.titleheight=m.line=0,MyrDlogClear(e,-1);for(var p=0;p<l.item.length;p++){if(s=l.item[p],l.div,s.div=document.createElement("div"),s.div.setAttribute("unselectable","on"),s.div.setAttribute("draggable","false"),MyrCompleteStyle(s.div,"z-index:2002;position:absolute;width:auto;height:auto;"),"progress"==s.style){MyrCompleteStyle(s.div,"display:inline-block;backgroundColor:white;border: 1px solid black;border-radius: 7px;width:"+Math.max(l.minwidth,30)+"px;height:20px;box-shadow: 0px 2px 3px rgba(0,0,0,0.3) inset;");var M=document.createElement("div");M.setAttribute("unselectable","on"),M.setAttribute("draggable","false"),MyrCompleteStyle(M,"display: inline-block;backgroundColor:#6666FF;z-index:2003;border-radius: 7px;position:absolute;left:0px;top:0px;width:0px;height:20px;box-shadow: -1px -5px 5px rgba(0,0,0,0.3) inset;"),s.div.appendChild(M)}else s.div.innerHTML=s.caption;"title"==s.style?MyrCompleteStyle(s.div,i.titletextstyle):"static"==s.style?MyrCompleteStyle(s.div,i.statictextstyle):"button"==s.style?MyrCompleteStyle(s.div,i.buttonstyle):"none"!=s.style&&(MyrCompleteStyle(s.div,i.statictextstyle),MyrCompleteStyle(s.div,s.style)),s.size={},"boxtitle"==s.tag||"boxclose"==s.tag?(MyrIsDefined(l.titlediv)||(l.titlediv=document.createElement("div"),l.titlediv.setAttribute("unselectable","on"),l.titlediv.setAttribute("draggable","false"),MyrCompleteStyle(l.titlediv,"z-index:2001;position:absolute;width:100%;height:auto;left:0px;top:0px"),MyrCompleteStyle(l.titlediv,i.dialogtitle),MyrSetDivBackground(l.titlediv,i.dialogtitlebgcolor),l.div.appendChild(l.titlediv)),l.titlediv.appendChild(s.div),s.size.width=s.div.clientWidth+4,s.size.height=s.div.clientHeight,s.size.height>m.titleheight&&(m.titleheight=s.size.height)):(l.div.appendChild(s.div),s.size.width=s.div.clientWidth+4,s.size.height=s.div.clientHeight),s.position.indexOf("newline")>=0&&(m.y+=m.lineheight,m.line++,m.leftx=m.centerx=m.rightx=m.lineheight=0),s.y=m.y+s.offsety,s.position.indexOf("center")>=0?(s.x=m.centerx,m.centerx+=s.size.width+s.offsetx):s.position.indexOf("right")>=0?(s.x=m.rightx,m.rightx+=s.size.width+s.offsetx):(s.x=m.leftx,m.leftx+=s.size.width+s.offsetx),s.size.height+s.offsety>m.lineheight&&(m.lineheight=s.size.height+s.offsety),MyrIsDefined(d[m.line])||(d[m.line]={}),d[m.line].height=m.lineheight,d[m.line].left=m.leftx,d[m.line].right=m.rightx,d[m.line].center=m.centerx,s.line=m.line}for(m.y+=m.lineheight+4,y=c=u=0,p=0;p<=m.line;p++){var g;d[p].center?((g=2*Math.max(d[p].left,d[p].right))>c&&(c=g),d[p].center>y&&(y=d[p].center)):(g=d[p].left+d[p].right)>u&&(u=g)}for((f=Math.max(y+c,u))<l.minwidth&&(f=l.minwidth),l.box={},l.position=o,o.indexOf("persistent")>=0&&MyrIsDefined(e.dlog.pos)&&MyrIsDefined(e.dlog.pos[l.tag])?(l.box.left=e.dlog.pos[l.tag].left,l.box.top=e.dlog.pos[l.tag].top):(o.indexOf("center")>=0?l.box.left=parseInt(2+(r.clientWidth-f)/2)+a:o.indexOf("right")>=0?l.box.left=r.clientWidth-f+a:l.box.left=a,o.indexOf("middle")>=0&&(l.box.top=parseInt(2+(r.clientHeight-m.y)/2)+n),o.indexOf("topquarter")>=0?l.box.top=parseInt(2+(r.clientHeight-m.y)/4)+n:o.indexOf("bottom")>=0?l.box.top=r.clientHeight-m.y+n:l.box.top=n),l.box.width=parseInt(f+4),l.box.height=Math.max(parseInt(m.y+4),l.minheight),MyrCompleteStyle(l.div,"left:"+l.box.left+"px;top:"+l.box.top+"px;width:"+l.box.width+"px;height:"+l.box.height+"px"),MyrIsDefined(l.titlediv)&&(l.titleheight=m.titleheight,MyrCompleteStyle(l.titlediv,"width:"+parseInt(f+4)+"px;height:"+m.titleheight+"px")),p=0;p<l.item.length;p++)(s=l.item[p]).position.indexOf("right")>=0?s.x=f-s.size.width-s.x:s.position.indexOf("center")>=0&&(s.x=parseInt(f/2-d[s.line].center/2+s.x)),s.position.indexOf("bottom")>=0?s.y+=d[s.line].height-s.size.height:s.position.indexOf("middle")>=0&&(s.y+=parseInt((d[s.line].height-s.size.height)/2)),s.x+=2,s.y+=2,MyrCompleteStyle(s.div,"left:"+s.x+"px;top:"+s.y+"px");MyrDlogUpdate(e,l),MyrCompleteStyle(l.div,"transform:scale(0);"),window.getComputedStyle(l.div).transform,MyrCompleteStyle(l.div,"visibility:visible"),MyrCompleteStyle(l.div,i.dialogboxopen)}function MyrDlogLocate(e,t,r){if(MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list))for(var o=0;o<e.dlog.list.length;o++){var a=e.dlog.list[o];if(MyrIsDefined(a.box)&&t>=a.box.left&&t<a.box.left+a.box.width&&r>=a.box.top&&r<a.box.top+a.box.height){t-=a.box.left,r-=a.box.top;for(var n=a.item.length-1;n>=0;n--){var i=a.item[n];if(MyrIsDefined(i.vectprocess)&&t>=i.x&&t<i.x+i.size.width&&r>=i.y&&r<i.y+i.size.height)return a.tag+" "+n}return r<a.titleheight?a.tag+" title":a.tag+" none"}}return""}function MyrDlogCloseBoxManage(e,t,r,o){"click"!=o&&"drag"!=o||MyrDlogClose(e,t.tag),console.log("ManageCloseBox")}function MyrDlogProcessItem(e,t,r,o){var a=MyrDlogGetDlogIndexByTag(t,r);if(MyrIsDefined(t)&&MyrIsDefined(t.dlog)&&MyrIsDefined(t.dlog.list[a])){var n=t.dlog.list[a];if("click"==e&&0!=a){t.dlog.list.splice(a,1),t.dlog.list.splice(0,0,n);for(var i=t.dlog.list.length-1;i>=0;i--)MyrCompleteStyle(t.dlog.list[i].div,"zIndex:"+(3e3-i));a=MyrDlogGetDlogIndexByTag(t,r)}if("title"===o){if("drag"==e){var s=t.mouse.x-t.mouse.lastdragx,l=t.mouse.y-t.mouse.lastdragy;(s||l)&&(n.box.left+=s,n.box.top+=l,n.box.left<0&&(n.box.left=0),n.box.left+n.box.width>t.fatherDiv.width&&(n.box.left=t.fatherDiv.width-n.box.width),n.box.top+n.box.height>t.fatherDiv.height&&(n.box.top=t.fatherDiv.height-n.box.height),n.box.top<0&&(n.box.top=0),MyrCompleteStyle(n.div,"left:"+n.box.left+"px;top:"+n.box.top+"px;"))}}else if("none"!==o&&(o=parseInt(o),MyrIsDefined(t.dlog.list[a].item[o]))){var d=t.dlog.list[a].item[o];return"click"!=e&&"drag"!=e||(t.mouse.clickedtype="dlog",t.mouse.clickeddata=r+" "+o),d.vectprocess&&d.vectprocess(t,t.dlog.list[a],d,e),MyrCtx.vrai}}return MyrCtx.faux}function MyrDlogClose(e,t){var r=MyrDlogGetDlogIndexByTag(e,t);if(MyrIsDefined(e)&&MyrIsDefined(e.dlog)&&MyrIsDefined(e.dlog.list[r])){var o=e.dlog.list[r];o.div.dlog=o,o.div.obj=e,MyrCompleteStyle(o.div,"transform:scale(0);"),o.div.addEventListener("transitionend",function(e){for(var t=e.target.obj,r=e.target.dlog,o=0;o<t.dlog.list.length;o++)if(r.tag==t.dlog.list[o].tag){for(var a=0;a<r.item.length;a++)MyrIsDefined(r.item[a].div)&&(r.item[a].div.parentNode.removeChild(r.item[a].div),r.item[a].div=null);MyrIsDefined(r.titlediv)&&(r.titlediv.parentNode.removeChild(r.titlediv),r.titlediv=null),MyrIsDefined(r.div)&&(r.div.parentNode.removeChild(r.div),r.div=null),MyrIsDefined(t.dlog.pos)||(t.dlog.pos={}),t.dlog.pos[r.tag]={},t.dlog.pos[r.tag].left=r.box.left,t.dlog.pos[r.tag].top=r.box.top,MyrDlogDelete(t,o)}},!1)}}function MyrDlogUpdate(e,t){if(MyrIsDefined(t.div))for(var r=0;r<t.item.length;r++){var o=t.item[r];o.vectprocess&&o.vectprocess(e,t,t.item[r],"update")}}function MyrDlogAddTool(e,t,r,o,a,n,i,s,l,d,y,c){var u,f=/(^\d+) (.*$)/.exec(r),m=a*n/100,p=a*i/100;u=parseInt(o/(a/100)),r="<g id='Myr-"+e.index+"-"+s+"' fill='"+MyrCreateGradient(e.theme.fill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.stroke,MyrCtx.vrai)+"' stroke-width='"+e.theme.strokewidth+"' opacity='"+e.theme.opacity+"' style='transition:all "+e.theme.transition+";transform-origin: 50% 50%; transform:scale("+e.theme.scale+","+e.theme.scale+")'>"+f[2]+"</g>",r=MyrReplaceSVGTokens(e,s,r+="<g id='MyrOver-"+e.index+"-"+s+"' opacity='"+e.theme.notoveropacity+"' fill='"+MyrCreateGradient(e.theme.notoverfill,MyrCtx.vrai)+"' stroke='"+MyrCreateGradient(e.theme.notoverstroke,MyrCtx.vrai)+"' transform='scale("+e.theme.notoverscale+","+e.theme.notoverscale+")' style='transition: all "+e.theme.overtransition+";transform-origin: 50% 50%; transform:scale("+e.theme.notoverscale+","+e.theme.notoverscale+")'>"+e.theme.over+"</g>",u);var M=MyrDlogAddItem(e,t,"none",r=MyrCtx.svgHeader+"width='"+parseInt(o+2*m)+"' height='"+(a+2*p)+"' viewBox='-"+n+" -"+i+" "+(u+2*n)+" "+(100+2*i)+"'>"+r+"</svg>",s,0,l,d,-m+y,-p+c);return e.dlog.list[t].item[M].toolscale=u,M}function MyrParserError(e){return e.index>e.size}function MyrParseGetUChar(e){return e.buffer[e.index++]}function MyrParseGetUShort(e){return(e.buffer[e.index++]<<8)+e.buffer[e.index++]}function MyrParseGetULong(e){return(e.buffer[e.index++]<<24)+(e.buffer[e.index++]<<16)+(e.buffer[e.index++]<<8)+e.buffer[e.index++]>>>0}function MyrParseGetLong(e){var t=MyrParseGetULong(e);return t>=2147483648&&(t=4294967296-t),t}function MyrParseGetFloat(e){var t=new ArrayBuffer(4),r=new Uint8Array(t),o=new Float32Array(t);return r[3]=MyrParseGetUChar(e),r[2]=MyrParseGetUChar(e),r[1]=MyrParseGetUChar(e),r[0]=MyrParseGetUChar(e),o[0]}function MyrParseGetTag(e){var t,r="";for(var o=0;8>o;o++)(t=e.buffer[e.index++])>0&&(r+=String.fromCharCode(t));return r}function MyrParseGetUTFString(e,t){for(var r="";t>0&&!MyrParserError(e);){var o;if(t--,192>(o=MyrParseGetUChar(e)))nbytes=0;else if(224>o)o-=192,nbytes=2;else if(240>o)o-=224,nbytes=3;else if(248>o)o-=240,nbytes=4;else if(252>o)o-=248,nbytes=5;else{if(!(254>o))return e.index+=t,r+"???";o-=252,nbytes=6}if(nbytes>t)return e.index+=t,r+"???";for(var a=o,n=1;n<nbytes;n++){if(t--,128>(o=MyrParseGetUChar(e))||o>=192)return e.index+=t,r+"???";a=(a<<6)+(63&o)>>>0}r+=String.fromCharCode(a)}return r}function MyrParseGetPascalStr(e){return MyrParseGetUTFString(e,MyrParseGetUShort(e))}function MyrParseChunkHeader(e){var t={};return t._tag=tag=MyrParseGetTag(e),t._isParent=MyrParseGetUChar(e),t._datasize=MyrParseGetULong(e),MyrParserError(e)&&(t=null),t}function MyrParseChunkLevel(e,t,r,o,a){MyrIsDefined(MyrCtx.CHUNK_STR)||(MyrCtx.CHUNK_SVG="SvgFile",MyrCtx.CHUNK_PNG="PngFile",MyrCtx.CHUNK_NUMBER="Long",MyrCtx.CHUNK_FRAME="Frame",MyrCtx.CHUNK_TIME="Time",MyrCtx.CHUNK_RANGE="Range",MyrCtx.CHUNK_NOTE="Note",MyrCtx.CHUNK_EVENT="Event",MyrCtx.CHUNK_MP3="MpgFile",MyrCtx.CHUNK_TAGGED_LONG="TagLong",MyrCtx.CHUNK_TAGGED_FLOAT="TagFloat",MyrCtx.CHUNK_TAGGED_FRAME="TagFrame",MyrCtx.CHUNK_TAGGED_RGB="TagRgb",MyrCtx.CHUNK_TAGGED_STR="TagStr",MyrCtx.counter=0);for(var i,s,l,d,y,c,u,f=e.index+t,m=MyrCtx.faux;e.index<f&&!m;){var p=MyrParseChunkHeader(e);if(null!==p)if(MyrIsDefined(r[d=p._tag])||(r[d]=[]),n=r[d].length,r[d][n]=p,1==p._isParent)MyrParseChunkLevel(e,p._datasize,p,o+1,a)||(m=MyrCtx.vrai);else if(2==p._isParent){var M,g=MyrParseGetULong(e);if(MyrParseGetULong(e)==g)(M={}).index=e.index,M.buffer=e.buffer,M.size=e.index+g,MyrParseChunkLevel(M,g,p,o+1,a)||(m=MyrCtx.vrai),e.index+=p._datasize-8,M.buffer=null;else(M={index:0}).buffer=MyrZip.UnzipBlock(e.buffer,e.index,p._datasize-8,g),M.size=g,MyrParseChunkLevel(M,g,p,o+1,a)||(m=MyrCtx.vrai),e.index+=p._datasize-8,M.buffer=null}else switch(d){case MyrCtx.CHUNK_STR:s=MyrParseGetTag(e),i=MyrParseGetUTFString(e,p._datasize-5),MyrParseGetUChar(e),p.type=s,p.str=i,r[d][s]=i;break;case MyrCtx.CHUNK_SVG:i=MyrParseGetUTFString(e,p._datasize);MyrIsDefined(a)||(a=0);var h=a+"-";p.str=i.replace(/(id *= *\"|href *= *\"#|url[\(]#)/g,"$1"+h);break;case MyrCtx.CHUNK_NUMBER:l=MyrParseGetULong(e),p.value=l;break;case MyrCtx.CHUNK_TYPED_NUMBER:s=MyrParseGetTag(e),l=MyrParseGetULong(e),p.type=s,p.value=l,r[d][s]=l;break;case MyrCtx.CHUNK_FRAME:p.left=MyrParseGetLong(e),p.top=MyrParseGetLong(e),p.right=MyrParseGetLong(e),p.bottom=MyrParseGetLong(e);break;case MyrCtx.CHUNK_TIME:p.areaindex=MyrParseGetULong(e),p.time=MyrParseGetULong(e)/1e3;break;case MyrCtx.CHUNK_RANGE:p.from=MyrParseGetULong(e),p.to=MyrParseGetULong(e);break;case MyrCtx.CHUNK_EVENT:p.time=MyrParseGetULong(e)/1e3,p.kind=MyrParseGetUChar(e);break;case MyrCtx.CHUNK_NOTE:p.timestart=MyrParseGetULong(e)/1e3,p.timeend=MyrParseGetULong(e)/1e3,p.timestart>p.timeend&&(p.timestart=p.timeend-.1),p.pitch=MyrParseGetUChar(e),p.velocity=MyrParseGetUChar(e),p.finger=MyrParseGetUChar(e),p.string=MyrParseGetUChar(e),p.fret=MyrParseGetUChar(e),p.shape=MyrParseGetUChar(e),y=MyrParseGetUChar(e),c=MyrParseGetUChar(e),u=MyrParseGetUChar(e),p.rgb=(y<<16)+(c<<8)+u;break;case MyrCtx.CHUNK_TAGGED_LONG:p._tag=MyrParseGetPascalStr(e),p.value=MyrParseGetULong(e),r["$"+p._tag]=p.value;break;case MyrCtx.CHUNK_TAGGED_FLOAT:p._tag=MyrParseGetPascalStr(e),p.value=MyrParseGetFloat(e),r["$"+p._tag]=p.value;break;case MyrCtx.CHUNK_TAGGED_FRAME:var v={};p._tag=MyrParseGetPascalStr(e),p.left=v.left=MyrParseGetFloat(e),p.top=v.top=MyrParseGetFloat(e),p.right=v.right=MyrParseGetFloat(e),p.bottom=v.bottom=MyrParseGetFloat(e),r["$"+p._tag]=v;break;case MyrCtx.CHUNK_TAGGED_RGB:var b={};p._tag=MyrParseGetPascalStr(e),p.red=b.red=MyrParseGetUShort(e),p.green=b.green=MyrParseGetUShort(e),p.blue=b.blue=MyrParseGetUShort(e),r["$"+p._tag]=b;break;case MyrCtx.CHUNK_TAGGED_STR:var x=e.index;p._tag=MyrParseGetPascalStr(e),i=MyrParseGetUTFString(e,p._datasize-(e.index-x)),r["$"+p._tag]=i;break;default:t=r[d][n]._datasize,p.data=new Uint8Array(t);for(var D=0;t>D;D++)p.data[D]=e.buffer[e.index++]}else m=MyrCtx.vrai}return!m}function MyrCreateAudioElement(e,t,r){Debug("creating Fail-safe "+r.length);for(var o="",a=0;a<r.length;a++)o+=String.fromCharCode(r[a]);var n=document.createElement("audio");return n.setAttribute("src","data:"+t+";base64,"+window.btoa(o)),e.fatherDiv.appendChild(n),n}function MyrInitSound(e){MyrIsDefined(MyrCtx.audioContext)||(MyrCtx.audioFailSafe=MyrCtx.faux,"function"==typeof window.AudioContext?MyrCtx.audioContext=new window.AudioContext:"function"==typeof window.webkitAudioContext||"object"==typeof window.webkitAudioContext?MyrCtx.audioContext=new window.webkitAudioContext:MyrCtx.audioFailSafe=MyrCtx.vrai),MyrIsDefined(e.sound.useAudioFailSafe)&&e.sound.useAudioFailSafe?e.sound.useAudioFailSafe=MyrCtx.vrai:e.sound.useAudioFailSafe=MyrCtx.audioFailSafe,e.sound.track=[],e.sound.playState=MyrCtx.STATE_STOPPED}function MyrInitSoundTrack(e,t,r,o){e.sound.track[t].active=1,e.sound.track[t].volume=1,e.sound.track[t].panning=0,console.log("Source: "+r.byteLength),console.time("Decode"+e.index+"-"+t),e.sound.useAudioFailSafe?(e.sound.track[t].audio=MyrCreateAudioElement(e,o,new Uint8Array(r)),e.sound.track[t].ready=MyrCtx.vrai,e.sound.track[t].duration=e.sound.track[t].audio.duration,e.sound.duration=Math.max(e.sound.duration,e.sound.track[t].duration),MyrToolbarChange(e)):(e.sound.track[t].ready=MyrCtx.faux,e.sound.track[t].duration=0,MyrCtx.audioContext.decodeAudioData(r,function(r){return r?(Debug(e+" --- "+t),e.sound.track[t].data=r,e.sound.track[t].originaldata=r,!e.sound.useAudioFailSafe&&r.numberOfChannels<2?(console.log("STEREO FROM MONO"+e.sound.track[t].panningtrim),e.sound.track[t].panning=e.sound.track[t].panningtrim,e.sound.track[t].panningtrim=0):(e.sound.track[t].panningtrim*=.8,console.log("STEREO FROM STEREO"+e.sound.track[t].panningtrim)),e.sound.track[t].ready=MyrCtx.vrai,e.sound.track[t].duration=r.duration,e.sound.duration=Math.max(e.sound.duration,e.sound.track[t].duration),console.timeEnd("Decode"+e.index+"-"+t),console.log("Dest: "+r.length),void MyrToolbarChange(e)):void MyrError(e,"Error decoding audio data: "+e.sound.track[t].src)}))}function MyrAreAllTracksReady(e){for(var t=0;t<e.sound.nbTracks;t++)if(!MyrIsDefined(e.sound.track[t])||!e.sound.track[t].ready)return MyrCtx.faux;return MyrCtx.vrai}function MyrSoundSetGeneralVolume(e,t){e.sound.generalVolume=t,MyrSoundUpdateLevels(e)}function MyrSetTrackActive(e,t,r){e.sound.track[t].active=r,MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackVolume(e,t,r){e.sound.track[t].volume=parseFloat(r),MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackPanning(e,t,r){e.sound.track[t].panning=r,MyrSoundUpdateTrackLevels(e,t)}function MyrSetTrackSolo(e,t,r){e.sound.solotrack==t?e.sound.solotrack=null:e.sound.solotrack=t,MyrSoundUpdateLevels(e)}function MyrSoundUpdateTrackLevels(e,t){var r,o=e.sound.track[t],a=1e-5,n=o.panning*(1-a);0===n&&(n=a),0===r&&(r=a),r=MyrIsDefined(e.sound.solotrack)?e.sound.solotrack==t?o.volume*e.sound.generalVolume:0:o.active*o.volume*e.sound.generalVolume,e.sound.useAudioFailSafe?o.audio.volume=r:(o.LLGain||o.LeftGain)&&(o.stereo?0>n?(o.LLGain.gain.value=r,o.LRGain.gain.value=a,o.RLGain.gain.value=r*-n,o.RRGain.gain.value=r*(1+n)):(o.LLGain.gain.value=r*(1-n),o.LRGain.gain.value=r*n,o.RLGain.gain.value=a,o.RRGain.gain.value=r):0>n?(o.LeftGain.gain.value=r,o.RightGain.gain.value=r*(1+n)):(o.LeftGain.gain.value=r*(1-n),o.RightGain.gain.value=r))}function MyrSoundUpdateLevels(e){var t;for(t=0;t<e.sound.track.length;t++)MyrSoundUpdateTrackLevels(e,t);e.sound.playMode.metronome.volumeNode&&(e.sound.playMode.metronome.volumeNode.gain.value=e.sound.playMode.metronome.volume*e.sound.generalVolume)}function MyrRawTimeStamp(e){return e.sound.useAudioFailSafe?e.sound.track[0].audio.currentTime:MyrCtx.audioContext.currentTime}function MyrSoundTime(e){var t=MyrRawTimeStamp(e)-e.sound.runtime.timeStampStart;if(MyrIsDefined(e.sound.playMode.end)&&e.sound.playMode.end>0){var r=e.sound.playMode.start;for(MyrIsDefined(r)&&e.sound.canJump||(r=0);t>e.sound.playMode.end;)t-=e.sound.playMode.end-r}return t}function MyrMetroMakeSound(e,t){var r,o,a,n,i=Math.floor(arguments.length-2)/3,s=[];for(l=0;i>l;l++)s[l]=arguments[3*l+3];samplerate=MyrCtx.audioContext.sampleRate,o=samplerate*e,a=(n=MyrCtx.audioContext.createBuffer(1,o,samplerate)).getChannelData(0),t=6.28*t/samplerate;for(var l=0;o>l;l++)for(a[l]=0,r=0;i>r;r++)arguments[3*r+2]<100?a[l]+=Math.sin(t*l*arguments[3*r+2])*s[r]/100:a[l]+=(2*Math.random()-1)*s[r]/100,s[r]*=(1e4-arguments[3*r+4])/1e4;return n}function MyrMetroInit(){MyrIsDefined(MyrCtx.metrobell)||(MyrCtx.metrobell=MyrMetroMakeSound(.75,4e3,.628,2,5,1,20,1.7,2,2.5,2.5,4,5,3,5,5,3,7,15,4),MyrCtx.metroclick=MyrMetroMakeSound(.45,140,1,6,58,2.53,4,58,3.43,15,60,7.18,15,55,21.78,17,42,100,23,90))}function MyrAddMetronomeSound(e,t,r){var o={};MyrMetroInit(),o.data=0===t?MyrCtx.metroclick:MyrCtx.metrobell,o.pos=r,o.source=null,MyrIsDefined(e.sound.metrobits)||(e.sound.metrobits=[]),e.sound.metrobits.push(o)}function MyrPrepareMetronome(e){var t=e.sound.playMode.tempo;if(MyrIsDefined(t)&&0!=t||(t=1),!e.sound.useAudioFailSafe&&MyrIsDefined(e.sync.metronome)&&e.sync.metronome.note.length>1&&(e.sound.playMode.metronome.before||e.sound.playMode.metronome.beat||e.sound.playMode.metronome.bar)){var r=e.sync.metronome.note;if(e.sound.metrobits=[],e.sound.playMode.metronome.before){var o=(r[1].time-r[0].time)/t;for(pos=8*-o,i=0;i<2;i++)MyrAddMetronomeSound(e,0,pos),pos+=2*o;for(i=0;i<4;i++)MyrAddMetronomeSound(e,0,pos),pos+=o}if(e.sound.playMode.metronome.beat||e.sound.playMode.metronome.bar)for(i=0;i<r.length;i++)pos=r[i].time/t,e.sound.playMode.metronome.beat&&MyrAddMetronomeSound(e,0,pos),2==r[i].kind&&e.sound.playMode.metronome.bar&&MyrAddMetronomeSound(e,1,pos)}}function MyrSoundPause(e){var t;if(MyrStopTimer("playedbar"),e.sound.runtime.timePause=MyrSoundTime(e),e.sound.useAudioFailSafe)for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.pause();else{for(e.sound.track[0].source.onended=null,t=0;t<e.sound.nbTracks;t++)e.sound.track[t].source.stop(0),e.sound.track[t].source=null;if(MyrIsDefined(e.sound.metrobits))for(t=0;t<e.sound.metrobits.length;t++)MyrIsDefined(e.sound.metrobits[t].source)&&(e.sound.metrobits[t].source.stop(0),e.sound.metrobits[t].source=null);for(t=0;t<e.sound.nbTracks;t++)MyrIsDefined(e.sound.track[t].mergerNode)&&(e.sound.track[t].mergerNode.disconnect(),e.sound.track[t].mergerNode=null),MyrIsDefined(e.sound.track[t].RightGain)&&(e.sound.track[t].RightGain.disconnect(),e.sound.track[t].RightGain=null),MyrIsDefined(e.sound.track[t].LeftGain)&&(e.sound.track[t].LeftGain.disconnect(),e.sound.track[t].LeftGain=null),MyrIsDefined(e.sound.track[t].LLGain)&&(e.sound.track[t].LLGain.disconnect(),e.sound.track[t].LLGain=null),MyrIsDefined(e.sound.track[t].RLGain)&&(e.sound.track[t].RLGain.disconnect(),e.sound.track[t].RLGain=null),MyrIsDefined(e.sound.track[t].LRGain)&&(e.sound.track[t].LRGain.disconnect(),e.sound.track[t].LRGain=null),MyrIsDefined(e.sound.track[t].RRGain)&&(e.sound.track[t].RRGain.disconnect(),e.sound.track[t].RRGain=null),MyrIsDefined(e.sound.track[t].splitterNode)&&(e.sound.track[t].splitterNode.disconnect(),e.sound.track[t].splitterNode=null),MyrIsDefined(e.sound.playMode.metronome.volumeNode)&&(e.sound.playMode.metronome.volumeNode.disconnect(),e.sound.playMode.metronome.volumeNode=null)}e.sound.playState=MyrCtx.STATE_PAUSED}function MyrSoundDepause(e){var t,r,o,a=.2;if(t=MyrIsDefined(e.sound.playMode.start)&&e.sound.canJump?e.sound.playMode.start:0,r=MyrIsDefined(e.sound.playMode.end)&&e.sound.canJump?e.sound.playMode.end:e.sound.duration,e.keyboard.div.height&&MyrKbdJumpTo(e,t),(t>(o=e.sound.runtime.timePause)||o>r)&&(o=t),e.sound.useAudioFailSafe){if(e.sound.canJump||0===o)for(e.sound.runtime.timeStampStart=0,i=0;i<e.sound.nbTracks;i++)e.sound.track[i].audio.currentTime=o;for(i=0;i<e.sound.nbTracks;i++)e.sound.track[i].audio.play()}else{if(MyrIsDefined(e.sound.metrobits)){if(0===o){var n=e.sound.metrobits[0].pos;0>n&&(a-=n)}for(e.sound.playMode.metronome.volumeNode=MyrCtx.audioContext.createGain(1),i=0;i<e.sound.metrobits.length;i++)(0===o||e.sound.metrobits[i].pos>=o)&&e.sound.metrobits[i].pos<=r&&(e.sound.metrobits[i].source=MyrCtx.audioContext.createBufferSource(),e.sound.metrobits[i].source.buffer=e.sound.metrobits[i].data,e.sound.metrobits[i].source.connect(e.sound.playMode.metronome.volumeNode));e.sound.playMode.metronome.volumeNode.connect(MyrCtx.audioContext.destination)}for(i=0;i<e.sound.nbTracks;i++)e.sound.track[i].source=MyrCtx.audioContext.createBufferSource(),e.sound.track[i].source.buffer=e.sound.track[i].data,e.sound.track[i].mergerNode=MyrCtx.audioContext.createChannelMerger(2),e.sound.track[i].data.numberOfChannels>1?(e.sound.track[i].stereo=MyrCtx.vrai,e.sound.track[i].splitterNode=MyrCtx.audioContext.createChannelSplitter(2),e.sound.track[i].source.connect(e.sound.track[i].splitterNode),e.sound.track[i].LLGain=MyrCtx.audioContext.createGain(1),e.sound.track[i].LLGain.gain.value=.01,e.sound.track[i].RLGain=MyrCtx.audioContext.createGain(1),e.sound.track[i].RLGain.gain.value=.01,e.sound.track[i].LRGain=MyrCtx.audioContext.createGain(1),e.sound.track[i].LRGain.gain.value=.01,e.sound.track[i].RRGain=MyrCtx.audioContext.createGain(1),e.sound.track[i].RRGain.gain.value=.01,e.sound.track[i].splitterNode.connect(e.sound.track[i].LLGain,0,0),e.sound.track[i].splitterNode.connect(e.sound.track[i].RLGain,1,0),e.sound.track[i].splitterNode.connect(e.sound.track[i].LRGain,0,0),e.sound.track[i].splitterNode.connect(e.sound.track[i].RRGain,1,0),e.sound.track[i].LLGain.connect(e.sound.track[i].mergerNode,0,0),e.sound.track[i].RLGain.connect(e.sound.track[i].mergerNode,0,0),e.sound.track[i].LRGain.connect(e.sound.track[i].mergerNode,0,1),e.sound.track[i].RRGain.connect(e.sound.track[i].mergerNode,0,1)):(e.sound.track[i].stereo=MyrCtx.faux,e.sound.track[i].LeftGain=MyrCtx.audioContext.createGain(),e.sound.track[i].LeftGain.gain.value=.01,e.sound.track[i].RightGain=MyrCtx.audioContext.createGain(),e.sound.track[i].RightGain.gain.value=.01,e.sound.track[i].source.connect(e.sound.track[i].LeftGain),e.sound.track[i].source.connect(e.sound.track[i].RightGain),e.sound.track[i].LeftGain.connect(e.sound.track[i].mergerNode,0,0),e.sound.track[i].RightGain.connect(e.sound.track[i].mergerNode,0,1)),e.sound.track[i].mergerNode.connect(MyrCtx.audioContext.destination),e.sound.playMode.loop&&(e.sound.track[i].source.loop=!0,e.sound.track[i].source.loopStart=t,e.sound.track[i].source.loopEnd=r),e.sound.track[i].source.start||(e.sound.track[i].source.start=e.sound.track[i].source.noteOn),e.sound.track[i].source.stop||(e.sound.track[i].source.stop=e.sound.track[i].source.noteOff);e.sound.track[0].source.onended=function(){MyrSoundStop(e)},MyrSoundUpdateLevels(e),e.sound.runtime.timeStampStart=MyrRawTimeStamp(e)+a-o,console.log("Current time "+MyrRawTimeStamp(e)),console.log("Pos in score "+o);for(var i=0;i<e.sound.nbTracks;i++)console.log("track "+i+" schedule at "+e.sound.runtime.timeStampStart),e.sound.track[i].source.start(e.sound.runtime.timeStampStart+o,o,r-t);if(MyrIsDefined(e.sound.metrobits))for(console.log("First metronome scheduled at "+e.sound.runtime.timeStampStart+e.sound.metrobits[0].pos),i=0;i<e.sound.metrobits.length;i++)MyrIsDefined(e.sound.metrobits[i].source)&&e.sound.metrobits[i].pos>=t-a&&e.sound.metrobits[i].source.start(.05+e.sound.runtime.timeStampStart+e.sound.metrobits[i].pos);console.log("all started at "+MyrRawTimeStamp(e))}MyrCtx.audioContext.resume(),e.sound.playState=MyrCtx.STATE_PLAYING,e.sound.pausedTime=0,MyrStartTimer("playedbar",MyrDisplayPlayedBar,MyrCtx.NB_MS_POS_MUSIQUE)}function MyrSoundJump(e,t){e.sound.playState==MyrCtx.STATE_STOPPED&&MyrSoundPlay(e),e.sound.playState==MyrCtx.STATE_PLAYING?(MyrSoundPause(e),e.sound.runtime.timePause=t,MyrSoundDepause(e)):(e.sound.runtime.timePause=t,MyrDisplayCurrentPos(e,t)),e.keyboard.div.height&&MyrKbdJumpTo(e,t)}function MyrSoundRelativeJump(e,t){var r=0;e.sound.playState==MyrCtx.STATE_PLAYING?r=MyrSoundTime(e):e.sound.playState==MyrCtx.STATE_PAUSED&&(r=e.sound.runtime.timePause),console.log("relative "+t),MyrSoundJump(e,r+t)}function MyrSoundStop(e){MyrSoundPause(e),e.sound.metrobits=null,e.sound.playState=MyrCtx.STATE_STOPPED,MyrKbdReleaseAll(e),MyrSetDivSize(e.page.divcursor,0,0),e.keyboard.div.height&&MyrKbdJumpTo(e,0),MyrResetAnnotations(e)}function MyrSoundChangeMetronome(e){e.sound.playState==MyrCtx.STATE_PLAYING?(MyrSoundPause(e),e.sound.metrobits=null,MyrPrepareMetronome(e),MyrSoundDepause(e)):e.sound.playState==MyrCtx.STATE_PAUSED&&(e.sound.metrobits=null,MyrPrepareMetronome(e))}function MyrSoundChangeData(e){var t;if(e.sound.playMode.tempo!=e.sound.playMode.scheduledtempo||e.sound.playMode.detune!=e.sound.playMode.scheduleddetune)if(e.sound.useAudioFailSafe)for(t=0;t<e.sound.track.length;t++)e.sound.playMode.tempo=e.sound.playMode.scheduledtempo,e.sound.playMode.detune=e.sound.playMode.scheduleddetune,e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo;else for(MyrSoundTransform.Stop(e.sound),t=0;t<e.sound.track.length;t++)if(0==e.sound.playMode.scheduleddetune&&1==e.sound.playMode.scheduledtempo)e.sound.playMode.tempo=e.sound.playMode.scheduledtempo,e.sound.playMode.detune=e.sound.playMode.scheduleddetune,e.sound.track[t].data=e.sound.track[t].originaldata;else for(var r=e.sound.track[t].originaldata.numberOfChannels,o=0;r>o;o++){var a={};a.obj=e,a.track=t,a.nbchan=r,a.chan=o;var n=e.sound.track[t].originaldata.getChannelData(o);MyrSoundTransform.Do(e.sound,n,100*e.sound.playMode.scheduleddetune,e.sound.playMode.scheduledtempo,!1,a,SoundTransformCallback)}}function SoundTransformCallback(e,t){var r=e.identifier.obj,o=e.identifier.track,a=e.identifier.nbchan,n=e.identifier.chan,i=r.sound.track[o];if(0===t)i.ready=!1,MyrToolbarChange(e.identifier.obj),0==o&&0==n&&(MyrProgressBarOpen(r,"progressbar",2),MyrProgressBarSet(r,"progressbar",0,"-",0),MyrProgressBarSet(r,"progressbar",1,"Total",0));else if(1==t){var s=Math.floor(100*e.computedPos/e.numSampsToProcess);MyrProgressBarSet(r,"progressbar",0,i.name+" "+(n+1)+"/"+a,s),MyrProgressBarSet(r,"progressbar",1,"Total",100*(o*a+n+s/100)/(r.sound.track.length*a)),r.sound.playMode.tempo=r.sound.playMode.scheduledtempo,r.sound.playMode.detune=r.sound.playMode.scheduleddetune}else if(t>=2){MyrProgressBarSet(r,"progressbar",1,"Total",100*(o*a+n+1)/(r.sound.track.length*a)),0==n&&(i.data=MyrCtx.audioContext.createBuffer(a,e.result.length,MyrCtx.audioContext.sampleRate*e.sampleRateModifier),r.sound.track[o].duration=i.data.duration),i.data.getChannelData(n).set(e.result),n==a-1&&(i.ready=!0,o==r.sound.track.length-1&&(MyrProgressBarClose(r,"progressbar"),r.sound.duration=r.sound.track[o].duration,MyrToolbarChange(e.identifier.obj)))}}function MyrSoundPlay(e){var t,r;for(t=0;t<MyrCtx.myrTab.length;t++)(r=MyrCtx.myrTab[t]).sound.playState!=MyrCtx.STATE_STOPPED&&MyrSoundStop(r);if(e.sound.useAudioFailSafe){for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.volume=0;for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.play();for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.pause();for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.volume=e.sound.track[t].active*e.sound.track[t].volume*e.sound.generalVolume,e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo}else MyrPrepareMetronome(e);if(e.sound.runtime.timePause=0,MyrSoundDepause(e),e.sound.useAudioFailSafe)for(t=0;t<e.sound.nbTracks;t++)e.sound.track[t].audio.playbackRate=e.sound.playMode.tempo}function MyrKbdInitDrawings(){MyrIsDefined(MyrCtx.kbdsvg)||(MyrCtx.kbdsvg="<defs>\t<linearGradient id='myrGradWhite' x1='00%' y1='00%' x2='100%' y2='100%'>      <stop offset='0%' style='stop-color:#FFFFD0; stop-opacity:1' />      <stop offset='55%' style='stop-color:#FFFFE0; stop-opacity:1' />      <stop offset='100%' style='stop-color:#FFFFF9; stop-opacity:1' /></linearGradient>\t<linearGradient id='myrGradWhitePress' x1='00%' y1='00%' x2='0%' y2='100%'>       <stop offset='10%' style='stop-color:white;stop-opacity:0.1' />\t  <stop offset='40%' style='stop-color:white;stop-opacity:0.2' />      <stop offset='100%' style='stop-color:black;stop-opacity:0.2' />    </linearGradient><linearGradient id='myrGradBlkPress' x1='50%' y1='100%' x2='50%' y2='0%'>\t<stop offset='0%' style='stop-color:#303030; stop-opacity:1' /> \t<stop offset='15%' style='stop-color:#808080; stop-opacity:1' /> \t<stop offset='30%' style='stop-color:#606060; stop-opacity:1' />    <stop offset='100%' style='stop-color:black; stop-opacity:1' /></linearGradient><linearGradient id='myrGradBlkRefl' x1='0%' y1='0%' x2='100%' y2='100%'>\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='80%' style='stop-color:white; stop-opacity:1' />\t <stop offset='100%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>\t<linearGradient id='myrGradBlkReflPressed' x1='00%' y1='0%' x2='140%' y2='40%'>\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='70%' style='stop-color:white; stop-opacity:1' />\t <stop offset='90%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>\t<linearGradient id='myrGradWhiteRefl' x1='0%' y1='0%' x2='100%' y2='0%'>\t<stop offset='0%' style='stop-color:white; stop-opacity:0.51' />\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='100%' style='stop-color:black; stop-opacity:0.2' /></linearGradient>\t<linearGradient id='myrGradWhiteRefl2' x1='40%' y1='0%' x2='0%' y2='100%'>\t<stop offset='40%' style='stop-color:white; stop-opacity:0' />\t<stop offset='65%' style='stop-color:white; stop-opacity:0.9' />\t<stop offset='90%' style='stop-color:white; stop-opacity:0' /></linearGradient>\t<path id='myrPathWhite' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0z' />\t<path id='myrPathWhiteRefl' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0 L 23 0 L 23 83 Q 23 88 18 88 L 7 88 Q 2 88 2 83 L 2 0z' />\t<path id='myrPathWhitePress' d='M 0 0 L -1 82 Q -1 87 4 87 L 19 87 Q 24 87 24 82 L 25 0z' /><path id='myrPathBlack' d='M 0 0 L 0 53 Q 0 58 5 58 L 7 58 Q 12 58 12 53 L 12 0z' /><path id='myrPathBlackRefl' d='M 10 0 L 10 49 Q 10 54 7 54 L 2 54'  /><path id='myrPathBlackReflPress' d='M 10 0 L 10 51 Q 10 56 7 56 L 2 56'  /><g id='myrKeyWhite'><use xlink:href='#myrPathWhite'  fill='url(#myrGradWhite)' stroke-width='0.8' stroke='#404040'/></g><g id='myrKeyWhitePress' ><use xlink:href='#myrPathWhite' fill='rgb(230,230,190)' stroke='none' /></g><g id='myrKeyBlack' transform='scale(1.2,1)'><use xlink:href='#myrPathBlack' fill='black' stroke='none' /><use xlink:href='#myrPathBlackRefl'  fill='none' stroke-width='2' stroke='url(#myrGradBlkRefl)'/></g><g id='myrKeyBlackPress'><use xlink:href='#myrPathBlack' fill='#707070' stroke='none' /></g></defs>",MyrCtx.kbdsvgComplex="<style> </style><defs><filter id='myrFilterDrop' x='-10%' y='-10%' width='150%' height='150%'>  <feGaussianBlur in='SourceAlpha' stdDeviation='1'/>  <feOffset dx='2' dy='3'/>  <feComponentTransfer>    <feFuncA type='linear' slope='0.4'/>  </feComponentTransfer>  <feMerge>     <feMergeNode/>    <feMergeNode in='SourceGraphic'/>  </feMerge></filter>\t<linearGradient id='myrGradWhite' x1='00%' y1='00%' x2='100%' y2='100%'>      <stop offset='0%' style='stop-color:white; stop-opacity:0' />      <stop offset='55%' style='stop-color:white; stop-opacity:1' />      <stop offset='100%' style='stop-color:white; stop-opacity:0.5' /></linearGradient>\t<linearGradient id='myrGradWhitePress' x1='00%' y1='00%' x2='0%' y2='100%'>       <stop offset='10%' style='stop-color:white;stop-opacity:0.1' />\t  <stop offset='40%' style='stop-color:white;stop-opacity:0.2' />      <stop offset='100%' style='stop-color:black;stop-opacity:0.2' />    </linearGradient><linearGradient id='myrGradBlkPress' x1='50%' y1='100%' x2='50%' y2='0%'>\t<stop offset='0%' style='stop-color:#303030; stop-opacity:1' /> \t<stop offset='15%' style='stop-color:#808080; stop-opacity:1' /> \t<stop offset='30%' style='stop-color:#606060; stop-opacity:1' />    <stop offset='100%' style='stop-color:black; stop-opacity:1' /></linearGradient><linearGradient id='myrGradBlkRefl' x1='0%' y1='0%' x2='100%' y2='100%'>\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='80%' style='stop-color:white; stop-opacity:1' />\t <stop offset='100%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>\t<linearGradient id='myrGradBlkReflPressed' x1='00%' y1='0%' x2='140%' y2='40%'>\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='70%' style='stop-color:white; stop-opacity:1' />\t <stop offset='90%' style='stop-color:white; stop-opacity:0.1' /></linearGradient>\t<linearGradient id='myrGradWhiteRefl' x1='0%' y1='0%' x2='100%' y2='0%'>\t<stop offset='0%' style='stop-color:white; stop-opacity:0.51' />\t<stop offset='50%' style='stop-color:white; stop-opacity:0' />    <stop offset='100%' style='stop-color:black; stop-opacity:0.2' /></linearGradient>\t<linearGradient id='myrGradWhiteRefl2' x1='40%' y1='0%' x2='0%' y2='100%'>\t<stop offset='40%' style='stop-color:white; stop-opacity:0' />\t<stop offset='65%' style='stop-color:white; stop-opacity:0.9' />\t<stop offset='90%' style='stop-color:white; stop-opacity:0' /></linearGradient>\t<path id='myrPathWhite' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0z' />\t<path id='myrPathWhiteRefl' d='M 0 0 L 0 85 Q 0 90 5 90 L 20 90 Q 25 90 25 85 L 25 0 L 23 0 L 23 83 Q 23 88 18 88 L 7 88 Q 2 88 2 83 L 2 0z' />\t<path id='myrPathWhitePress' d='M 0 0 L -1 82 Q -1 87 4 87 L 19 87 Q 24 87 24 82 L 25 0z' /><path id='myrPathBlack' d='M 0 0 L 0 53 Q 0 58 5 58 L 7 58 Q 12 58 12 53 L 12 0z' /><path id='myrPathBlackRefl' d='M 10 0 L 10 49 Q 10 54 7 54 L 2 54'  /><path id='myrPathBlackReflPress' d='M 10 0 L 10 51 Q 10 56 7 56 L 2 56'  /><g id='myrKeyWhite'><use xlink:href='#myrPathWhite' fill='rgb(230,230,190)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathWhite'  fill='url(#myrGradWhite)' opacity='0.6' stroke='none'/><use xlink:href='#myrPathWhiteRefl'  fill='url(#myrGradWhiteRefl)' stroke='none'/><use xlink:href='#myrPathWhiteRefl'  fill='url(#myrGradWhiteRefl2)' stroke='none'/></g><g id='myrKeyWhitePress' ><use xlink:href='#myrPathWhitePress' fill='rgb(230,230,190)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathWhitePress'  fill='url(#myrGradWhitePress)' stroke='none'/></g><g id='myrKeyBlack'><use xlink:href='#myrPathBlack' fill='black' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathBlackRefl'  fill='none' stroke-width='2' stroke='url(#myrGradBlkRefl)'/></g><g id='myrKeyBlackPress'><use xlink:href='#myrPathBlack' fill='url(#myrGradBlkPress)' stroke='none'  filter='url(#myrFilterDrop)'/><use xlink:href='#myrPathBlackReflPress'  fill='none' stroke-width='2' stroke='url(#myrGradBlkReflPressed)'/></g></defs>",MyrCtx.kbdDefaultColor=["#FF0000","#00FF00","#0000FF","#FFFF00","#FF00FF","#00FFFF","#FFA000","#FF00A0","#FFA0A0","#A0FF00","#00FFA0","#A0FFA0","#A000FF","#00A0FF","#A0A0FF","#FFFFA0","#FFA0FF","#A0FFFF"])}function MyrKbdGetStaffColor(e,t,r){return MyrBool(e.args.keyboardusenotecolor)==MyrCtx.vrai&&MyrIsDefined(r)&&MyrIsDefined(r.rgb)?"#"+((1<<24)+parseInt(r.rgb)).toString(16).slice(1):t>=0&&t<e.sync.staff.length&&MyrIsDefined(e.sync.staff[t].color)?e.sync.staff[t].color:MyrCtx.kbdDefaultColor[t%MyrCtx.kbdDefaultColor.length]}function MyrKbdCreateKey(e,t,r,o,a){var n,i,s,l;e.keyboard.tabSvgElm[t].white=o,o?(n=12.5,i=25*r,s="#myrKeyWhite",l=75):(i=25*r+19+a*(n=6)/2,s="#myrKeyBlack",l=35);var d=e.keyboard.tabSvgElm[t].key=document.createElementNS("http://www.w3.org/2000/svg","use");d.setAttribute("transform","translate("+i+",0)"),d.setAttributeNS("http://www.w3.org/1999/xlink","href",s),e.keyboard.drawDiv.childNodes[0].appendChild(d),(d=e.keyboard.tabSvgElm[t].circle=document.createElementNS("http://www.w3.org/2000/svg","circle")).setAttribute("transform","translate("+i+",0)"),d.setAttribute("cx",n),d.setAttribute("cy",l),d.setAttribute("r",12),d.setAttribute("fill","#FF0000"),d.setAttribute("opacity","0"),MyrSetTransition(e,d,"all 0.2s ease"),e.keyboard.drawDiv.childNodes[0].appendChild(d),(d=e.keyboard.tabSvgElm[t].finger=document.createElementNS("http://www.w3.org/2000/svg","text")).setAttribute("transform","translate("+i+",0)"),d.setAttribute("x",n),d.setAttribute("y",l+7),d.style.fontSize="20px",d.style.fontFamily="sans-serif",d.style.textAnchor="middle",d.style.fontWeight="bolder",d.setAttribute("opacity","0"),d.innerHTML=" ",e.keyboard.drawDiv.childNodes[0].appendChild(d)}function MyrKbdDraw(e){if(MyrKbdInitDrawings(),e.keyboard.div.height){var t,r,o=.9*e.keyboard.div.width,a=e.keyboard.div.height;a=90*a/100;var n=Math.floor(100*o/(25*a));n>84&&(n=84),o=n*a*25/100,MyrIsDefined(e.keyboard.drawDiv)||(e.keyboard.drawDiv=MyrCreateUndraggableElement("div",10),e.keyboard.drawDiv.style.position="absolute",MyrSetDivPos(e.keyboard.drawDiv,(e.keyboard.div.width-o)/2,e.keyboard.div.height-a),MyrSetDivSize(e.keyboard.drawDiv,o,a),e.keyboard.drawDiv.style.backgroundColor="#AAAAAA",e.keyboard.div.appendChild(e.keyboard.drawDiv)),t=MyrCtx.svgHeader+" width='"+o+"' height='"+a+"' viewBox='0 0 "+25*n+" 100'>"+MyrCtx.kbdsvg+"<svg>",(r=document.createElement("div")).innerHTML=t,e.keyboard.drawDiv.appendChild(r.childNodes[0]),r=null,e.keyboard.tabSvgElm=[];for(var i=0,s=0;n>s;s++){e.keyboard.tabSvgElm[i]={},e.keyboard.tabSvgElm[i].pressed=!1,e.keyboard.tabSvgElm[i].white=!0,e.keyboard.tabSvgElm[i++].position=s;var l=s%7;n-1>s&&(0===l||1===l||3===l||4===l||5===l)&&(e.keyboard.tabSvgElm[i]={},e.keyboard.tabSvgElm[i].pressed=!1,e.keyboard.tabSvgElm[i].white=!1,e.keyboard.tabSvgElm[i].delta=0===l||3===l?-1:1===l||5===l?1:0,e.keyboard.tabSvgElm[i++].position=s)}for(s=e.keyboard.tabSvgElm.length-1;s>=0;s--)e.keyboard.tabSvgElm[s].white&&MyrKbdCreateKey(e,s,e.keyboard.tabSvgElm[s].position,!0);for(s=e.keyboard.tabSvgElm.length-1;s>=0;s--)e.keyboard.tabSvgElm[s].white||MyrKbdCreateKey(e,s,e.keyboard.tabSvgElm[s].position,!1,e.keyboard.tabSvgElm[s].delta);var d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d","M 0 100 L 0 10 Q 0 0 10 0 L "+(25*n-10)+" 0 q 10 0 10 10 l 0 100"),d.setAttribute("fill","none"),d.setAttribute("opacity","0.2"),d.setAttribute("stroke","#000000"),d.setAttribute("stroke-width","10"),e.keyboard.drawDiv.childNodes[0].appendChild(d),(d=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M -2 100 L -2 8 Q -2 -2 10 -2 L "+(25*n+2-10)+" -2 q 10 0 10 10 l 0 102"),d.setAttribute("fill","none"),d.setAttribute("opacity","0.2"),d.setAttribute("stroke","#000000"),d.setAttribute("stroke-width","8"),e.keyboard.drawDiv.childNodes[0].appendChild(d),(d=e.keyboard.octavemark=document.createElementNS("http://www.w3.org/2000/svg","path")).setAttribute("d","M -5 100 L 5 100 L 0 95z"),d.setAttribute("fill","blue"),d.setAttribute("opacity","1"),d.setAttribute("stroke","none"),MyrIsDefined(e.keyboard.octaveshift)||(e.keyboard.octaveshift=0),d.setAttribute("transform","translate("+(7*(2+e.keyboard.octaveshift)*25+12.5)+",0)"),e.keyboard.drawDiv.childNodes[0].appendChild(d),MyrKbdTranspose(e,e.keyboard.octaveshift)}}function MyrKbdTranspose(e,t){var r=e.keyboard.tabSvgElm.length/12,o=Math.floor((r+.4)/2);e.keyboard.octaveshift=t,e.keyboard.firstkeypitch=60-12*(o-e.keyboard.octaveshift),e.keyboard.octavemark.setAttribute("transform","translate("+(7*(o+e.keyboard.octaveshift)*25+12.5)+",0)")}function MyrKbdPressKey(e,t,r,o){var a=t-e.keyboard.firstkeypitch;if(e.keyboard.div.height&&a>=0&&a<e.keyboard.tabSvgElm.length){var n=e.keyboard.tabSvgElm[a];n.pressed||(!0===n.white?n.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyWhitePress"):n.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyBlackPress"),MyrSetTransition(e,n.circle,"all 0s ease"),n.circle.setAttribute("fill",o),n.circle.setAttribute("opacity","0.7"),r>=0&&254>r&&(n.finger.innerHTML=r+1,MyrSetTransition(e,n.finger,"all 0s ease"),n.finger.setAttribute("opacity","1")),n.pressed=!0)}}function MyrKbdReleaseKey(e,t){var r=t-e.keyboard.firstkeypitch;if(e.keyboard.div.height&&r>=0&&r<e.keyboard.tabSvgElm.length){var o=e.keyboard.tabSvgElm[r];o.pressed&&(!0===o.white?o.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyWhite"):o.key.setAttributeNS("http://www.w3.org/1999/xlink","href","#myrKeyBlack"),MyrSetTransition(e,o.circle,"all 0.3s ease"),o.circle.setAttribute("opacity","0"),o.circle.setAttribute("fill","#FFFFFF"),MyrSetTransition(e,o.finger,"all 0.3s ease"),o.finger.setAttribute("opacity","0"),o.pressed=!1)}}function MyrKbdReleaseAll(e){var t;if(e.keyboard.div.height&&MyrIsDefined(e.keyboard.tabSvgElm)){t=e.keyboard.tabSvgElm.length;for(var r=0;t>r;r++)e.keyboard.tabSvgElm[r].pressed=!1;MyrKbdDraw(e)}}function MyrKbdManage(e,t){var r,o,a,n,i=e.sound.playMode.tempo;for(MyrIsDefined(i)&&0!=i||(i=1),t*=i,MyrIsDefined(e.keyboard.tabnote)||(e.keyboard.tabnote=[]),r=(a=e.keyboard.tabnote).length-1;r>=0;r--)a[r].timeend<t&&(MyrKbdReleaseKey(e,a[r].pitch),a.splice(r,1));for(r=0;r<e.sync.staff.length;r++)if(e.sync.staff[r].onKbd&&MyrIsDefined(e.sync.staff[r].note)){for(n=e.sync.staff[r].note,MyrIsDefined(o=e.sync.staff[r].curNoteIndex)||(o=0);o<n.length&&n[o].timestart<=t;){var s={};s.staffindex=r,s.pitch=n[o].pitch,s.timeend=n[o].timeend-.2,a.push(s),MyrKbdPressKey(e,n[o].pitch,n[o].finger-1,MyrKbdGetStaffColor(e,r,n[o])),o++}e.sync.staff[r].curNoteIndex=o}}function MyrKbdJumpTo(e,t){var r,o,a,n,i=e.sound.playMode.tempo;for(MyrIsDefined(i)&&0!=i||(i=1),t*=i,MyrIsDefined(e.keyboard.tabnote)||(e.keyboard.tabnote=[]),r=(a=e.keyboard.tabnote).length-1;r>=0;r--)MyrKbdReleaseKey(e,a[r].pitch);for(e.keyboard.tabnote=[],r=0;r<e.sync.staff.length;r++)if(e.sync.staff[r].curNoteIndex=0,e.sync.staff[r].onKbd&&MyrIsDefined(e.sync.staff[r].note)){for(n=e.sync.staff[r].note,o=0;o<n.length&&n[o].timestart<t;){if(n[o].timeend>t){var s={};s.staffindex=r,s.pitch=n[o].pitch,s.timeend=n[o].timeend-.2,a.push(s),MyrKbdPressKey(e,n[o].pitch,n[o].finger-1,MyrKbdGetStaffColor(e,r,n[o]))}o++}e.sync.staff[r].curNoteIndex=o}}var myrweb_version="0.2.6 Build 4 Compiled Fri Jun  7 10:28:58 2019",MyrWebVersion="unknown",MyrWebCopyright="(c) Myriad 2019";if(!MyrIsDefined(MyrCtx)){console.time("Init");var MyrCtx={};MyrCtx.vrai=MyrCtx.true=1,MyrCtx.faux=MyrCtx.false=0,MyrCtx.STATE_STOPPED=0,MyrCtx.STATE_PAUSED=1,MyrCtx.STATE_PLAYING=2,MyrCtx.NB_MS_POS_MUSIQUE=100,window.onload=function(){window.MyrInitAllAtOnLoad()}}var MyrSvgCloseBox="[X]";if(!MyrSoundTransform)var MyrSoundTransform={author:"Olivier Guillion",name:"Sound Transform"};if(function(){var e=500,t=.8;MyrSoundTransform.Do=function(r,o,a,n,i,s,l){function d(r){var o,a=(new Date).getTime();if(r.backtask.todolist.length>0){var n=r.backtask.todolist[0];if(0==n.state){for(n.fftData=y(4096),n.lastPhase=y(1025),n.sumPhase=y(1025),n.inwindow=y(h),n.outwindow=y(h),n.power=y(1025),n.phase=y(1025),n.expectedDeviation=y(1025),o=0;h>o;o++)n.inwindow[o]=-.5*Math.cos(g*o/h)+.5,n.outwindow[o]=4*n.inwindow[o]/(h*v);for(o=0;1024>=o;o++)tmp=o%v/v,tmp>.5&&tmp--,n.expectedDeviation[o]=tmp;n.computedPos=0,n.state=1,n.process(n,0)}if(n.state=1){for(;n.computedPos<n.numSampsToProcess&&(new Date).getTime()-a<=e*t;)n.process(n,1);n.callback(n,1),n.computedPos>=n.numSampsToProcess&&(n.state=2)}2==n.state&&(n.process(n,2),1==r.backtask.todolist.length?(n.callback(n,3),r.backtask.todolist=[],r.backtask.timer>=0&&window.clearInterval(r.backtask.timer),r.backtask.timer=-1):(n.callback(n,2),r.backtask.todolist.splice(0,1)))}}function y(e){var t=new Float32Array(e);return void 0===t.fill?t.clear=function(e,t,r){var o;for(void 0===t?(t=0,r=this.length):void 0===r&&(r=this.length),o=t;r>o;o++)this[o]=e}.bind(t):t.clear=t.fill,t}function c(e,t,r){var o,a,n,i,s=Math.floor(t/r),l=y(s);for(o=0;s>o;o++)i=(a=o*r)-(n=Math.floor(a)),l[o]=e[n]*(1-i)+e[n+1]*i;return l}function u(e,t,r,o,a,n,i,s){var l;for(a.clear(0),l=0;o>l;l++,t++)t>=0&&r>t&&(a[2*l]=e[t]*n[l]);for(m(a,-1),l=0;o/2>=l;l++)i[l]=2*Math.sqrt(a[2*l]*a[2*l]+a[2*l+1]*a[2*l+1]),s[l]=Math.atan2(a[2*l+1],a[2*l])/g}function f(e,t,r,o,a,n,i,s,l){for(k=0;k<=r/2;k++)o[2*k]=e[k]*Math.cos(t[k]),o[2*k+1]=e[k]*Math.sin(t[k]);for(o.clear(0,r+2,2*r),m(o,1),k=0;k<r;k++)k+i<s&&(n[k+i]+=a[k]*o[2*k])}function m(e,t){var r,o,a,n,i,s,l,d,y,c,u,f,m,p,g,h,v,b,x,D=e.length/2;if(f=2*D-2,p=2*D,"undefined"==typeof gLastBlocksize||gLastBlocksize!=D)for(gLastBlocksize=D,gFFTIndex1=new Uint16Array(D),gFFTIndex2=new Uint16Array(D),b=0,u=2;f>u;u+=2){for(m=2,g=0;p>m;m<<=1)u&m&&g++,g<<=1;g>u&&(gFFTIndex1[b]=u,gFFTIndex2[b]=g,b++)}for(f=gFFTIndex1.length,u=0;f>u;u++)g=gFFTIndex1[u],n=e[b=gFFTIndex2[u]],e[b++]=e[g],e[g++]=n,n=e[b],e[b]=e[g],e[g]=n;for(x=Math.floor(Math.log(D)/Math.log(2)+.5),b=0,h=2;x>b;b++)for(v=h,h<<=1,l=1,d=0,a=M/(v>>1),r=Math.cos(a),o=t*Math.sin(a),g=0;v>g;g+=2){for(c=(y=g)+v,u=g;2*D>u;u+=h)i=e[c]*l-e[c+1]*d,s=e[c]*d+e[c+1]*l,e[c]=e[y]-i,e[c+1]=e[y+1]-s,e[y]+=i,e[y+1]+=s,y+=h,c+=h;i=l*r-d*o,d=l*o+d*r,l=i}}var p={};const M=3.141592653589793,g=2*M,h=2048;var v=4;p.buffer=o,p.tempo=n,p.detune=a,p.identifier=s,p.callback=l,0==a&&1==n?(p.data=y(o.length),p.data.set(o),p.isLast=0==r.backtask.todolist.length,l(p,3)):(.75>n?v=5:n>1.2&&(v=3),p.state=0,p.numSampsToProcess=1,p.computedPos=0,r.backtask.todolist.push(p),i?(p.sampleRateModifier=Math.pow(1.0005777895065548,a),p.tempoRate=p.sampleRateModifier/n,p.process=function(e,t){switch(t){case 0:e.numSampsToProcess=e.buffer.length,e.result=y(Math.floor(e.numSampsToProcess*e.tempoRate));break;case 1:var r,o,a,n,i;for(n=Math.floor(1024),a=Math.floor(h/v),o=h-a,u(e.buffer,e.computedPos-o,e.numSampsToProcess,h,e.fftData,e.inwindow,e.power,e.phase),r=0;n>=r;r++)-.5>(i=e.phase[r]-e.lastPhase[r]-e.expectedDeviation[r])&&i++,i>.5&&i--,e.sumPhase[r]+=(r/v+i)*g*e.tempoRate;e.lastPhase.set(e.phase),f(e.power,e.sumPhase,h,e.fftData,e.outwindow,e.result,Math.floor(e.computedPos*e.tempoRate),e.numSampsToProcess),e.computedPos+=a}}):(p.sampleRateModifier=1,p.pitchRate=Math.pow(1.0005777895065548,a)/n,p.process=function(e,t){switch(t){case 0:e.tempo>1&&(e.buffer=c(e.buffer,e.buffer.length,e.tempo)),e.numSampsToProcess=e.buffer.length,e.result=y(e.numSampsToProcess),e.synMagn=y(h),e.synPhase=y(h);break;case 1:var r,o,a,n,i,s,l,d;for(a=Math.floor(1024),o=Math.floor(h/v),n=g*o/h,r=h-o,u(e.buffer,e.computedPos-r,e.numSampsToProcess,h,e.fftData,e.inwindow,e.power,e.phase),e.synMagn.clear(0),e.synPhase.clear(0),i=0;a>=i;i++)if(d=i*e.pitchRate,a>=(l=Math.floor(d))){for(s=e.phase[i]-e.lastPhase[i]-e.expectedDeviation[i];-.5>s;)s++;for(;s>.5;)s--;s*=v,e.synPhase[l]=(d+s*e.pitchRate)*n,e.synMagn[l]+=e.power[i]}for(i=0;a>=i;i++)e.sumPhase[i]+=e.synPhase[i];e.lastPhase.set(e.phase),f(e.synMagn,e.sumPhase,h,e.fftData,e.outwindow,e.result,e.computedPos,e.numSampsToProcess),e.computedPos+=o;break;case 2:e.tempo<1&&(e.result=c(e.result,e.result.length,e.tempo))}}),l(p,0),r.backtask.timer<0&&(d(r),p.state<2&&(r.backtask.timer=window.setInterval(function(){d(r)},e))))},MyrSoundTransform.Stop=function(e){void 0!==e.backtask&&null!==e.backtask&&e.backtask.timer>=0&&(callback(e.backtask.todolist[0],3),window.clearInterval(e.backtask.timer)),e.backtask={},e.backtask.todolist=[],e.backtask.timer=-1}}(),!MyrSvgToPdf)var MyrSvgToPdf={author:"Didier Guillion",name:"SVG to PDF Converter"};!function(){function e(e){alert("SVGtoPDF error :"+e)}function t(e,t,r,o,a){e.left=t,e.top=r,e.right=o,e.bottom=a}function o(t){e(t)}function a(e){var t="";return e.posData<e.data.length&&(t=e.data.substring(e.posData,e.posData+1)),t}function n(e){var t=a(e);return t.length>0&&e.posData++,t}function i(e){return e.search(/[0-9A-Za-z\-_\.]/)>=0}function s(e){return" "==e||"\t"==e}function l(e){return'"'==e||":"==e||","==e||")"==e||"("==e||"'"==e||"<"==e||s(e)}function d(e,t){return'"'==e?t==e:"'"==e?t==e:":"==e?";"==t:" "==t||l(t)}function y(e){var t,r="";if(""===(r=n(e)))return r;for(;r.length>0&&"<"!=r;)r=n(e);for(t=e.posData-1,r=n(e);r.length>0&&">"!=r;)r=n(e);return e.data.substring(t,e.posData)}function c(e){var t,r="",o=0;for(">"==a(e)&&e.posData++,t=e.posData,r=n(e);r.length>0&&"<"!=r;)r=n(e),o++;return e.data.substring(t,t+o)}function u(e,t){var r,o,a;if(e.length>0)do{if((r=e.search(t))>=0&&(0===r||!i(e.substring(r-1,r))&&!i(e.substring(r+t.length,r+t.length+1)))){for(r+=t.length;r<e.length&&(s(e.substring(r,r+1))||!l(e.substring(r,r+1)));)r++;if(r<e.length){for(o=e.substring(r,r+1),a=++r;r<e.length&&!1===d(o,e.substring(r,r+1));)r++;return e.substring(a,r)}}e=e.substring(r+1)}while(r>=0);return""}function f(e,t){var r=function(e,t){return u(e,t)}(e,t);return 0===r.length&&(r="0"),atof(r)}function m(e,t){return f(e,t)}function p(e,t){return e.toLowerCase().substring(0,t.length)==t.toLowerCase()}function M(e,t){var r={nbargs:0,args:[],cmd:""};for(r.pos=t;t<e.length&&l(e.slice(t,t+1));)t++;for(;t<e.length&&!l(e.slice(t,t+1));)r.cmd+=e.slice(t,t+1),t++;for(;t<e.length&&"("!=e.slice(t,t+1);){if(!l(e.slice(t,t+1)))return r.pos=t,r;t++}for(;t<e.length&&")"!=e.slice(t,t+1)&&r.nbargs<6;){for(var o="";t<e.length&&l(e.slice(t,t+1));)t++;for(;t<e.length&&")"!=e.slice(t,t+1)&&!l(e.slice(t,t+1));)o+=e.slice(t,t+1),t++;r.args[r.nbargs]=atof(o),r.nbargs++}return r.pos=t,r}function g(e,t,r,o){MyrPDF.PDFStrokeColor(e,t,o),MyrPDF.PDFFillColor(e,r,o)}function h(e,t,r,o,a,n,i,s,l){!1===s&&(MyrPDF.PDFOpacity(e,t),MyrPDF.PDFLineWidth(e,n),g(e,r,o,l),MyrPDF.PDFLineCap(e,a))}function v(e,t,r,o,a,n,i,s,l,d){var y={};y.left=Math.min(t,o)-d/2,y.top=Math.min(r,a)-d/2,y.right=Math.max(t,o)+d/2,y.bottom=Math.max(r,a)+d/2,h(e,n,i,s,l,d,0,!1,y),MyrPDF.PDFMoveTo(e,t,r),MyrPDF.PDFLineTo(e,o,a),MyrPDF.PDFStroke(e)}function b(e){for(var t="";" ">t&&e.pos<e.datalength;)t=e.data.substring(e.pos,e.pos+1),e.pos++;return t}function x(e){var t,r,o,a;for(t=b(e);" "==t;)t=b(e);for(r=e.pos-1,t=b(e);t>="0"&&"9">=t||"."==t||"-"==t;)t=b(e);return o=e.data.substring(r,e.pos),!1===l(t)&&e.pos<e.datalength&&e.pos--,a=parseFloat(o),z>0&&console.log("GetValPath :"+a),a}function D(e,t,r,o){var a=""!==r&&"none"!=r,n=""!==t&&"none"!=t;(o||a||n)&&MyrPDF.PDFComment(e,"SVGDrawPath "),o?(MyrPDF.PDFClip(e),MyrPDF.PDFEndPathNoPaint(e)):a&&n?MyrPDF.PDFFillAndStroke(e):a?MyrPDF.PDFFill(e):n&&MyrPDF.PDFStroke(e)}function P(e,t,r,o,a,n,i,s,l,d){var y={};y.left=t,y.top=r,y.right=t+o,y.bottom=r+a,h(e,n,i,s,"",l,0,d,y),MyrPDF.PDFRect(e,t,r,o,a),D(e,i,s,d)}function k(e,t,r,o,a,n,i,s,l,d){var y={};y.left=t-o,y.top=r-a,y.right=t+o,y.bottom=r+a,h(e,n,i,s,"",l,0,d,y),MyrPDF.PDFEllipse(e,t,r,o,a),D(e,i,s,d)}function w(e,t,r,o,a,n,i,s,l,d,y,c,u){var f,m=function(e){for(var t="",r=0;r<e.length;){if("&"===e.substring(r,r+1)&&"#"===e.substring(r+1,r+2)&&"x"===e.substring(r+2,r+3))for(r+=3,t+=parseInt(e.substring(r),16);r<e.length&&";"!=e.substring(r,r+1);)r++;else t+=e.substring(r,r+1);r++}return UnicodeToMacRoman(t)}(u),p=[];f=function(e,t,r){var o,a,n="";return a=strexist(e,"Times")?"Times-Roman":strexist(e,"Courier")?"Courier":strexist(e,"Helvetica")?"Helvetica":e,0>(o=MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictFonts,a))?(MyrPDF.PDFComment(null,"######################## FONT ["+a+"]########################"),MyrPDF.PDFAddFont(a,a,t,r),n=a):n=MyrPDF.PDFdictFonts[o].data,n}(o,"Type1","/Encoding /MacRomanEncoding"),MyrPDF.PDFComment(e,"SVGDrawText "+t+" "+r+" "+o+" "+n+" "+u),MyrPDF.PDFStartTextObject(e),MyrPDF.PDFTextFontNameAndSize(e,f,n),PMatrixIdentity(e,p),PMatrixTranslate(e,t,r,p),MyrPDF.PDFMatrixWrite(e,p),MyrPDF.PDFTextMoveTo(e,0,0),PMatrixIdentity(e,p),PMatrixRotate(e,d,y,c,p),a.length&&!strcmp(a,"italic")&&PMatrixSkewX(e,-10,p),MyrPDF.PDFMatrixWrite(e,p),g(e,s,l,null),MyrPDF.PDFTextShow(e,m),MyrPDF.PDFEndTextObject(e)}function F(t,r,o,a,n,i,s,l,d,y){var c,u,f,m,p,M,g,v=0,P=0,k=!0,w=!0,F={};for(F.data=r,F.datalength=r.length,F.pos=0;F.pos<F.datalength&&k;){switch(g=b(F),z>0&&console.log("SVGCvtPath :"+g),g){case" ":break;case"M":c=x(F),u=x(F),MyrPDF.PDFMoveTo(t,c,u),v=c,P=u;break;case"m":c=x(F),u=x(F),MyrPDF.PDFMoveRel(t,c,u),v+=c,P+=u;break;case"L":c=x(F),u=x(F),MyrPDF.PDFLineTo(t,c,u),v=c,P=u;break;case"l":c=x(F),u=x(F),MyrPDF.PDFLineRel(t,c,u),v+=c,P+=u;break;case"C":c=x(F),u=x(F),f=x(F),m=x(F),p=x(F),M=x(F),MyrPDF.PDFCurve(t,c,u,f,m,p,M),v=p,P=M;break;case"c":c=x(F),u=x(F),f=x(F),m=x(F),p=x(F),M=x(F),MyrPDF.PDFCurveRel(t,c,u,f,m,p,M),v+=p,P+=M;break;case"Q":c=x(F),u=x(F),f=x(F),m=x(F),MyrPDF.PDFCurve(t,v+.6666*(c-v),P+.6666*(u-P),f+.6666*(c-f),m+.6666*(u-m),f,m),v=f,P=m;break;case"q":c=x(F),u=x(F),f=x(F),m=x(F),c+=v,u+=P,f+=v,m+=P,MyrPDF.PDFCurve(t,v+.6666*(c-v),P+.6666*(u-P),f+.6666*(c-f),m+.6666*(u-m),f,m),v=f,P=m;break;case"Z":case"z":MyrPDF.PDFClosePath(t),!0;break;default:e("Command ["+g+"] unknow in path"),k=!1}w&&(w=!1,h(t,o,a,n,i,s,0,d,y))}D(t,a,n,d)}function C(e,t,r,o,a){var n,i,s,l,d=u(t,"xlink:href"),y=!0,c={};if(d.length>0){for(n=d;"#"===n.substring(0,1);)n=n.substring(1);MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictPaths,n)>=0?(""===o&&(o=u(t,"stroke")),""===a&&(a=u(t,"fill")),MyrPDF.PDFPushContext(e),h(e,"",o,a,"","",0,!1,""),i=f(t,"x"),s=f(t,"y"),PMatrixIdentity(e,c),PMatrixTranslate(e,i,s,c),MyrPDF.PDFMatrixWrite(e,c),(l=u(t,"transform")).length>0&&S(e,l),MyrPDF.PDFWriteDo(e,n),o.length>0&&"none"===a&&MyrPDF.PDFStroke(e),MyrPDF.PDFPopContext(e)):y=!1}return y}function S(e,t){var r,o=0,a=[];if(t.length>0){for(PMatrixIdentity(e,a);o<t.length;)if(o=(r=M(t,o)).pos,r.cmd.length>0&&r.nbargs>0)if(strcasecmp(r.cmd,"translate"))if(strcasecmp(r.cmd,"scale"))if(strcasecmp(r.cmd,"rotate"))if(strcasecmp(r.cmd,"skewx"))if(strcasecmp(r.cmd,"skewy")){if(!strcasecmp(r.cmd,"matrix")){if(r.nbargs<6)for(;r.nbargs<6;r.nbargs++)r.args[nbargs]=0;PMatrixMult(e,a,r.args,a)}}else PMatrixSkewY(e,r.args[0],a);else PMatrixSkewX(e,r.args[0],a);else 1==r.nbargs&&(r.args[1]=r.args[2]=0),PMatrixRotate(e,r.args[0],r.args[1],r.args[2],a);else 1==r.nbargs&&(r.args[1]=r.args[0]),PMatrixScale(e,r.args[0],r.args[1],a);else 1==r.nbargs&&(r.args[1]=0),PMatrixTranslate(e,r.args[0],r.args[1],a);MyrPDF.PDFMatrixWrite(e,a)}}function T(e,t){var r,o="",a=0;if(t.length>0){for(;a<t.length;)a=(r=M(t,a)).pos,strcasecmp(r.cmd,"skewx")&&strcasecmp(r.cmd,"skewy")?strcasecmp(r.cmd,"translate")?strcasecmp(r.cmd,"scale")?strcasecmp(r.cmd,"rotate")||(1==r.nbargs&&(r.args[1]=r.args[2]=0),o=r.cmd+"("+-r.args[0]+","+r.args[1]+","+r.args[2]+") "+o):(1==r.nbargs&&(r.args[1]=r.args[0]),o=r.cmd+"("+1/r.args[0]+","+1/r.args[1]+") "+o):(1==r.nbargs&&(r.args[1]=r.args[0]),o=r.cmd+"("+-r.args[0]+","+-r.args[1]+") "+o):o=r.cmd+"("+-r.args[0]+") "+o;S(e,o)}}function I(t,r,o,a,n){var i,s,l;if(MyrPDF.PDFPushContext(t),(i=u(r,"transform")).length>0)S(t,i);else if(o.length>0&&((s=u(o,"clip-path"))&&(l=u(s,"url")).length>0)){var d;if((d=MyrPDFDict.PDFGetDataFromId(MyrPDF.PDFdictClip,l.slice(1))).length>0){var y,c={};c.data=d,c.posData=0,(y=_(c,a,n,!0,!1)).data.length&&MyrPDF.PDFWriteNoRc(t,y.data)}else e("SVGDoG : entry "+l.slice(1)+" not found in dictionary for clipping.")}return!0}function A(e,t,r,a,n,i){var s,l,d,y,c,f=64738;if(u(t,"xlink:href").length>0&&(d=t.indexOf("base64,"))>=0){if(0>(y=(s=t.substring(d+7)).indexOf("'"))&&(y=s.indexOf('"')),y>=0&&(s=s.substring(0,y)),l=atob(s),MyrPDF.PDFComment(null,"######################## IMAGE ########################"),(c=PNGDecode(l)).data.length>0){var m,p;if(f=MyrPDF.PDFAddPosObject(),c.colorType==PNG_COLOR_TYPE_TRUECOLOR||c.colorType==PNG_COLOR_TYPE_TRUECOLOR_ALPHA)if((m=MyrLZ77.inflate(c.data,2)).length>0)if((p=PNGDecodeIDAT(m,c.aire.right,c.aire.bottom,c.colorType)).length>0)if(c.colorType==PNG_COLOR_TYPE_TRUECOLOR_ALPHA){var M;M=PNGSplitRGBandAlpha(p,c.aire.right,c.aire.bottom),MyrPDF.PDFWriteStreamImageAndFreeSource(null,M.rgbdata,c.aire.right,c.aire.bottom,!0,f+1),MyrPDF.PDFEndPosObject(),MyrPDF.PDFAddPosObject(),MyrPDF.PDFWriteStreamImageAndFreeSource(null,M.maskdata,c.aire.right,c.aire.bottom,!1,0)}else p=MyrPNG.CvtUint8toString(p),MyrPDF.PDFWriteStreamImageAndFreeSource(null,p,c.aire.right,c.aire.bottom,!0,0);else o("PNG error: decoding error, the file is corrupted.");else o("PNG error: can't unzip data chunk");else o("PNG error: PNG color format not managed");MyrPDF.PDFEndPosObject()}else o("PNG error: not a valid PNG file : "+messErr);var g,h,v;g=n/c.aire.right,h=i/c.aire.bottom,g=h=Math.min(g,h),v=a+i/2,r=r+n/2-(n=c.aire.right*g)/2,a=v-(i=c.aire.bottom*h)/2,MyrPDF.PDFWriteImage(e,f,void 0,r,a,n,i)}}function L(e,t,r,o,a,n,i,s,l,d){var y,c=u(t,"id"),f=null;if(c.length>0&&!0===d){var m,p,M,g={};MyrPDF.PDFClearBBox(),g.data=t,g.posData=0,M=_(g,o,a,!1,!1),MyrPDF.PDFComment(null,"######################## PATH ["+c+"]########################"),m=MyrPDF.PDFAddPosObject(),y=MyrPDF.PDFWriteForm(null,M.data),MyrPDF.PDFEndPosObject(),p=(f=MyrPDF.PDFGetBBox(f)).left+" "+f.top+" "+f.right+" "+f.bottom,MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictPaths,c,p,m,y)}else{var h=u(t,"d");h.length>0&&((strexist(a,"url(")||strexist(o,"url("))&&(f=function(e){var t={data:""};return MyrPDF.PDFClearBBox(),F(t,e,1,"","","","",0,null),MyrPDF.PDFGetBBox()}(h)),F(e,h,r,o,a,n,i,0,l,f))}return!0}function G(e,t,r,o,a){var n,i=u(r,"id"),s=!0,l="",d="";if(i.length>0&&!0===a){for(;""!==r&&!0===s;)if(console.log(r),p(r,"</linearGradient"))s=!1;else{if(p(r,"<linearGradient")&&(f(r,"x1"),f(r,"y1"),n=f(r,"x2"),f(r,"y2")),p(r,"<stop"))0===f(r,"offset")?l=u(r,"style"):d=u(r,"style");r=y(e)}var c;if(l.length>0&&d.length>0)c=n>0?"horiz":"vert",MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictSVGGradients,i,c,l,d)}return r.length>0}function E(e){var r=0,o={};if(e=e.match("<svg.*>")){if(r=f(e=e[0],"width"),height=f(e,"height"),0>=r||height<=0){var a=e.match(/viewBox\s*=\s*\"\s*([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)[,\s]+([\-\+0-9\.]+)\s*\"/),n=a[1],i=a[2],s=a[3],l=a[4];r=s-n,height=l-i}t(o,0,0,r,height)}return o}function _(r,o,a,n,i){var s,l,d,M,h=!0,b=0,x={},D="",F="",_="",z={},H="",W="",j="",K="",$="";for(z.data="",t(x,0,0,0,0),s=y(r);""!==s&&!0===h;){if(R>0&&console.log("["+s+"]"),!0===p(s,"<svg")){var V;l=(V=E(s)).right/N,x.right=N,x.bottom=V.bottom,O.right=N,O.bottom=x.bottom}else if(!0===p(s,"</svg"))h=!1;else if(p(s,"<clipPath"))F="",i&&(F=u(s,"id"));else if(p(s,"</clipPath"))F.length>0&&(D.length>0&&(MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictClip,F,D,0,0),D=""),F="");else if(F.length>0)D+=s;else{var Q;if((Q=u(s,"stroke")).length>0&&(j=Q),(Q=u(s,"fill")).length>0&&(K=Q),(Q=u(s,"opacity")).length>0&&($=Q),(Q=u(s,"stroke-width")).length>0&&(W=Q),(Q=u(s,"stroke-linecap")).length>0&&(H=Q),(Q=u(s,"stroke-linejoin")).length>0&&Q,(_=u(s,"style")).length>0&&((Q=u(_,"stroke")).length>0&&(j=Q),(Q=u(_,"fill")).length>0&&(K=Q),(Q=u(_,"opacity")).length>0&&($=Q),(Q=u(_,"stroke-width")).length>0&&(W=Q),(Q=u(_,"stroke-linecap")).length>0&&(H=Q),(Q=u(_,"stroke-linejoin")).length>0&&Q),p(s,"<linearGradient"))h=G(r,0,s,0,i);else if(p(s,"<line"))v(z,f(s,"x1"),f(s,"y1"),f(s,"x2"),f(s,"y2"),$,j||o,K||a,H,W);else if(p(s,"<text")){var Y=c(r);if(Y.length>0){var X=u(_,"font-family"),Z=u(s,"font-style"),J=u(s,"transform");if(d=f(s,"x"),M=f(s,"y"),J.length>0){var q=J.search("rotate");if(q>=0)for(;"("!=J.substring(q,q+1);)q++}K=u(s,"fill"),j=u(s,"stroke"),w(z,d,M,X,Z,m(_,"font-size"),0,j||o,K||a,0,0,0,Y)}}else if(p(s,"<path"))L(z,s,$,j||o,K||a,H,W,0,n,i);else if(p(s,"<rect")){S(z,u(s,"transform")),P(z,d=f(s,"x"),M=f(s,"y"),f(s,"width"),f(s,"height"),$,j||o,K||a,W,n),T(z,u(s,"transform"))}else p(s,"<ellipse")?k(z,f(s,"cx"),f(s,"cy"),f(s,"rx"),f(s,"ry"),$,j||o,K||a,W,n):p(s,"<image")?A(z,s,f(s,"x"),f(s,"y"),f(s,"width"),f(s,"height")):p(s,"<use")?C(z,s,0,j,K):p(s,"<g")?(I(z,s,_,j,K),g(z,j=u(s,"stroke"),K=u(s,"fill"),null)):p(s,"</g")&&MyrPDF.PDFPopContext(z)}if(s.indexOf(B)>=0){var ee=s.indexOf(B)+B.length;t(x,3e5,3e5,-3e5,-3e5),x.left=parseInt(s.substring(ee)),ee=(s=s.substring(ee+1)).indexOf(" "),x.top=parseInt(s.substring(ee)),ee=(s=s.substring(ee+1)).indexOf(" "),x.right=parseInt(s.substring(ee)),ee=(s=s.substring(ee+1)).indexOf(" "),x.bottom=parseInt(s.substring(ee)),ee=(s=s.substring(ee+1)).indexOf(" "),(x.left>=x.right||x.top>=x.bottom)&&(e("SVG Encoding error on MyriadPageStartpage "+b+"/"+l),h=!1),MyrPDF.PDFSetOffset(-x.left,-x.top),t(O,0,0,x.right-x.left,x.bottom-x.top),MyrPDF.PDFOpenPage(O),b++}else s.indexOf(U)>=0&&(MyrPDF.PDFClosePage(MyrPDF.PDFWritePageContent(z,O)),z.data="");s=y(r)}return MyrPDF.PDFFill(z),z}var z=0,R=0,N=1e3,O={};const B="MyriadPageStart",U="MyriadPageEnd";var H="!!Myriad Page ";MyrSvgToPdf.DoConvertSVGtoPDF=function(e,t,o){var a,n,i,s={},l={},d=(new Date).getTime(),y="";if("string"==typeof e)y=e;else{for(n=0,i=e.length;i>n;n++)y+=String.fromCharCode(e[n]);e=null}if(N=1e3,(null==t||1>t)&&(t=0),r=E(y),r.right>0&&(y=function(e,t,o,a){var n=0;0===t&&(t=Math.floor(o/N));var i=o/t;if(!1===strexist(e,B)){var s=new RegExp("\x3c!-- *"+H+".+>");if(e.search(s)>=0)for(e=e.replace(s,"\x3c!-- MyriadPageStart "+i*n+" 0 "+i*(n+1)+" "+r.bottom+" --\x3e\n"),n++;e.search(s)>=0;)e=e.replace(s,"\x3c!-- MyriadPageEnd--\x3e\n\x3c!-- MyriadPageStart "+i*n+" 0 "+i*(n+1)+" "+r.bottom+" --\x3e\n"),n++;else{for(var l=[],d=(s=/<clipPath\s+id=[\"\']([^\"\']*)[\"\']\s*><rect\s+x=[\"\']([^\"\']*)[\"\'].*<\/clipPath>/gi).exec(e);null!==d;){var y=Math.floor(d[2]/i);void 0!==l[y]&&null!==l[y]||(l[y]=d[1]),d=s.exec(e)}e=e.replace(/<\/defs>/i,"</defs>\n\x3c!-- MyriadPageStart 0 0 "+i+" "+r.bottom+" --\x3e");for(var c=1;c<l.length;c++)s=new RegExp("(<g .*url\\(#"+l[c]+".*>)","i"),e=e.replace(s,"\x3c!-- MyriadPageEnd--\x3e\n\x3c!-- MyriadPageStart "+i*c+" 0 "+i*(c+1)+" "+r.bottom+" --\x3e\n$1")}e=e.replace("</svg>","\x3c!-- MyriadPageEnd--\x3e\n</svg>")}return e}(y,t,r.right,r.bottom)),null!=o){void 0!==o[0]&&null!==o[0]&&(y=y.replace("</defs>",o[0]+"</defs>")),n=1;var c=new RegExp("(\x3c!-- MyriadPageStart.* --\x3e)","g");y=y.replace(c,function(e){return void 0!==o[n]&&null!==o[n]?e+"\n<g transform='translate("+N*(n-1)+" 0)' >\n"+o[n++]+"</g>":(n++,e)})}for(MyrPDF.PDFInit(),s.data=y,s.posData=0,l=_(s,"","",!1,!0),y=null,s.data=null,s=null,a=MyrPDF.PDFValidate(l),l=null,MyrPDF.PDFDispose(),console.log("Conversion done in "+((new Date).getTime()-d)/1e3+" seconds"),buff=new Uint8Array(a.length),n=0,i=a.length;i>n;n++)buff[n]=a.charCodeAt(n);return a=null,buff[10]=128,buff[11]=129,buff[12]=130,buff[13]=131,buff},MyrSvgToPdf.SetBigRect=t}(),DoConvertSVGtoPDF=MyrSvgToPdf.DoConvertSVGtoPDF,SetBigRect=MyrSvgToPdf.SetBigRect;var PDF_MATRIX_VERBOSE=0;if(!MyrPDFMatrix)var MyrPDFMatrix={author:"Didier Guillion",name:"Matrix"};if(function(){function e(e,t,r){if(PDF_MATRIX_VERBOSE>0){var o=t+" "+r[0]+" "+r[1]+" "+r[2]+" "+r[3]+" "+r[4]+" "+r[5];console.log(o)}}function t(e,t){var r;for(r=0;6>r;r++)t[r]=e[r]}function r(t,r,o,a,n,i,s,l){l[0]=r,l[1]=o,l[2]=a,l[3]=n,l[4]=i,l[5]=s,e(0,"PMatrixSet",l)}function o(r,o,a,n){var i=[];e(0,"PMatrixMult",o),e(0,"x",a),i[0]=o[0]*a[0]+o[2]*a[1],i[2]=o[0]*a[2]+o[2]*a[3],i[4]=o[0]*a[4]+o[2]*a[5]+o[4],i[1]=o[1]*a[0]+o[3]*a[1],i[3]=o[1]*a[2]+o[3]*a[3],i[5]=o[1]*a[4]+o[3]*a[5]+o[5],t(i,n),e(0,"=",n)}function a(e,t,a,n){var i=[];r(0,1,0,0,1,t,a,i),o(0,n,i,n)}MyrPDFMatrix.PMatrixDump=e,MyrPDFMatrix.PMatrixCopy=t,MyrPDFMatrix.PMatrixSet=r,MyrPDFMatrix.PMatrixMult=o,MyrPDFMatrix.PMatrixIdentity=function(e,t){r(0,1,0,0,1,0,0,t)},MyrPDFMatrix.PMatrixTranslate=a,MyrPDFMatrix.PMatrixScale=function(e,t,a,n){var i=[];r(0,t,0,0,a,0,0,i),o(0,n,i,n)},MyrPDFMatrix.PMatrixRotate=function(e,t,n,i,s){var l=[];t=3.141592653525*t/180,(n||i)&&a(0,n,i,s),r(0,Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t),0,0,l),o(0,s,l,s),(n||i)&&a(0,-n,-i,s)},MyrPDFMatrix.PMatrixSkewX=function(e,t,a){var n=[];t=3.141592653525*t/180,r(0,1,0,Math.tan(t),1,0,0,n),o(0,a,n,a)},MyrPDFMatrix.PMatrixSkewY=function(e,t,a){var n=[];t=3.141592653525*t/180,r(0,1,tan(t),0,1,0,0,n),o(0,a,n,a)}}(),PMatrixDump=MyrPDFMatrix.PMatrixDump,PMatrixCopy=MyrPDFMatrix.PMatrixCopy,PMatrixSet=MyrPDFMatrix.PMatrixSet,PMatrixMult=MyrPDFMatrix.PMatrixMult,PMatrixIdentity=MyrPDFMatrix.PMatrixIdentity,PMatrixTranslate=MyrPDFMatrix.PMatrixTranslate,PMatrixScale=MyrPDFMatrix.PMatrixScale,PMatrixRotate=MyrPDFMatrix.PMatrixRotate,PMatrixSkewX=MyrPDFMatrix.PMatrixSkewX,PMatrixSkewY=MyrPDFMatrix.PMatrixSkewY,!MyrPDFDict)var MyrPDFDict={author:"Didier Guillion",name:"Dictionnaries"};if(function(){function e(e){return e.length}function t(t){return e(t)}function r(t,r){var o,a=e(t);for(o=0;a>o;o++)if(t[o].id===r)return o;return-1}function o(e,o,a,n,i){var s=r(e,o);0>s&&(s=t(e)),e[s]={id:o,data:a,val1:n,val2:i}}MyrPDFDict.PDFNbEntryDict=e,MyrPDFDict.PDFAddDict=function(t,r){var a,n=e(t);for(a=0;n>a;a++)o(r,t[a].id,t[a].data,t[a].val1,t[a].val2)},MyrPDFDict.PDFDumpDict=function(t){var r,o=e(t);for(console.log("Dumping array "+o+" items."),r=0;o>r;r++)console.log(r+" "+t[r].id+" "+t[r].data+" "+t[r].val1+" "+t[r].val2)},MyrPDFDict.PDFDisposeDict=function(e){e.splice(0)},MyrPDFDict.PDFSortDictById=function(e){e.sort(function(e,t){return e.id>t.id})},MyrPDFDict.PDFNewEntry=t,MyrPDFDict.PDFSearchEntry=r,MyrPDFDict.PDFSearchDataEntry=function(t,r){var o,a=e(t);for(o=0;a>o;o++)if(t[o].data===r)return o;return-1},MyrPDFDict.PDFGetDataFromId=function(e,t){var o=r(e,t);return o>=0?e[o].data:""},MyrPDFDict.PDFAddEntry=o}(),!MyrPDF)var MyrPDF={author:"Didier Guillion",name:"PDF file format"};if(function(){function e(e,t){e<Z.left&&(Z.left=e),e>Z.right&&(Z.right=e),t<Z.top&&(Z.top=t),t>Z.bottom&&(Z.bottom=t)}function t(){return Z}function r(e,t){V=e,t}function o(e){return null===e&&(e=ie),e}function a(e,t){o(e).data+=t,R>0&&console.log(t)}function n(e,t){a(e,t+"\n")}function s(e,t){z>0&&n(e,"% "+t)}function l(e){s(e,"PDFPushContext level "+X),X++,function(e,t){for(var r=[],o=0;6>o;o++)r[o]=t[o];e.push(r)}(le,se),n(e,"q")}function d(e){s(e,"PDFPopContext level "+--X),se=function(e){for(var t=[],r=0;6>r;r++)t[r]=e[e.length-1][r];return e.pop(),t}(le),n(e,"Q")}function y(e,t,r){var o=t.toString(),n=o.indexOf(".");n>0&&(o=o.substring(0,n+r+1)),a(e,o+" ")}function c(e,t){y(e,t,2)}function u(){return n(null,++Q+" 0 obj"),Q}function f(){n(null,"endobj"),n(null,"")}function m(e,t){o(t).data+=e}function p(e,t){n(e,"stream"),m(t,e),n(e,""),n(e,"endstream")}function M(e,t,r,o){var a={};return null!==t&&"none"!=t&&t.length>5&&("#"==t.substring(0,1)&&(t=t.substring(1)),"url"==t.substring(0,3)?(function(e,t,r,o){var a,i;t=t.substring(t.indexOf("#")+1,t.indexOf(")")),s(e,"PDFStrokeGradient "+t),(a=MyrPDFDict.PDFSearchEntry(MyrPDF.PDFdictSVGGradients,t))>=0?(id=v(null,t,MyrPDF.PDFdictSVGGradients[a].data,MyrPDF.PDFdictSVGGradients[a].val1,MyrPDF.PDFdictSVGGradients[a].val2,r,o),i="Gradient_"+t+"_"+id,n(e,o?"/Pattern cs":"/Pattern CS"),s(e,"Current Matrix: ["+se[0]+" "+se[1]+" "+se[2]+" "+se[3]+" "+se[4]+" "+se[5]+"]"),n(e,o?"/"+i+" scn":"/"+i+" SCN"),MyrPDFDict.PDFAddEntry(MyrPDF.PDFdictGradients,i,id,id,"")):Collapse("PDFStrokeGradient: gradient ["+t+"] not found")}(e,t,r,o),!1):(strexist(t,"rgb(")?(t=t.substring(t.indexOf("(")+1),a.red=atof(t),t=t.substring(t.indexOf(",")+1),a.green=atof(t),t=t.substring(t.indexOf(",")+1),a.blue=atof(t)):a=function(e){var t={};return t.red=parseInt(e.substring(0,2),16),t.green=parseInt(e.substring(2,4),16),t.blue=parseInt(e.substring(4,6),16),t}(t),isNaN(a.red)&&(a.red=0),isNaN(a.green)&&(a.green=0),isNaN(a.blue)&&(a.blue=0),c(e,a.red/255),c(e,a.green/255),c(e,a.blue/255),!0))}function g(e,t){s(e,"PDFMatrixWrite data"),y(e,t[0],4),y(e,t[1],4),y(e,t[2],4),y(e,t[3],4),c(e,t[4]),c(e,t[5]),n(e,"cm"),se=function(e,t){var r,o,a,n=[],i=[],s=[],l=[];for(r=0;3>r;r++)i[r]=[],s[r]=[],l[r]=[];for(a=0,r=0;3>r;r++)for(o=0;2>o;o++)i[o][r]=e[a],s[o][r]=t[a],a++;for(i[2][0]=i[2][1]=s[2][0]=s[2][1]=0,i[2][2]=s[2][2]=1,r=0;3>r;r++)for(o=0;3>o;o++)for(l[r][o]=0,a=0;3>a;a++)l[r][o]+=i[r][a]*s[a][o];return n[0]=l[0][0],n[1]=l[1][0],n[2]=l[0][1],n[3]=l[1][1],n[4]=l[0][2],n[5]=l[1][2],n}(se,t)}function h(t,r,o){s(t,"PDFMoveTo "+r+" "+o),c(t,r),c(t,o),n(t,"m"),K=r,$=o,e(r,o)}function v(e,t,r,o,a,i,s){var l,d,y;return"vert"==r?i.left=i.right:i.top=i.bottom,MyrPDF.PDFComment(null,"######################## Gradient ["+t+"]########################"),l=MyrPDF.PDFAddPosObject(),n(e," << "),n(e," /FunctionType 2"),n(e,"/Domain [0.0 1.0]"),n(e,"/N 1"),n(e,"/C0 ["),M(e,o,"",s),n(e,"]"),n(e,"/C1 ["),M(e,a,""),n(e,"]"),n(e," >>"),MyrPDF.PDFEndPosObject(),d=MyrPDF.PDFAddPosObject(),n(e," <<"),n(e,"/ShadingType 2"),n(e,"/ColorSpace /DeviceRGB"),n(e,"/Function "+l+" 0 R"),n(e,"/Coords ["+i.left+" "+i.top+" "+i.right+" "+i.bottom+"]"),n(e,"/Extend [true true]"),n(e," >>"),MyrPDF.PDFEndPosObject(),y=MyrPDF.PDFAddPosObject(),n(e," <<"),n(e,"/Type /Pattern"),n(e,"/PatternType 2"),n(e,"/Shading "+d+" 0 R"),n(e,"/Matrix [ "+se[0]+" "+se[1]+" "+se[2]+" "+se[3]+" "+se[4]+" "+se[5]+" ]"),n(e," >>"),MyrPDF.PDFEndPosObject(),y}function b(e){s(e,"PDFStroke"),n(e,"S")}function x(t,r,o,a,i,l,d){s(t,"PDFCurve"),c(t,r),c(t,o),c(t,a),c(t,i),c(t,l),c(t,d),n(t,"c"),e(r,o),e(a,i),e(l,d),K=l,$=d}function D(e,t){n(e,"/"+t+" Do")}function P(e,t){for(;ie.data.indexOf(e)>=0;)ie.data=ie.data.replace(e,t)}function k(e,t){P(e,t.toString())}function w(e,t,r,o){var a,i=MyrPDFDict.PDFNbEntryDict(e),l={data:""};if(i>0){for(n(l,"/"+t+" << "),a=0;i>a;a++)n(l,"/"+(!0===o?e[a].data:e[a].id)+" "+e[a].val1+" 0 R ");n(l," >> "),s(l,"End dict "+t)}P(r,l.data)}function F(e){var t;for(0>e&&(e=4294967295+e+1),t=e.toString(16).toUpperCase();t.length<2;)t="0"+t;return t}function C(e,t){var r;return t===B?r=e:t===U&&(r=function(e,t){for(var r="",o=0;o<e.length;){for(i=0;i<t&&o<e.length;i++,o++)r+=F(e.charCodeAt(o));o<e.length&&(r+=" ")}return r}(e,3)),r}function S(e,t){var r,o,a={},i=[];return s(null,"######################## PAGE CONTENT ########################"),o=u(),a.data="",PMatrixIdentity(e,i),PMatrixTranslate(e,V*O,t.bottom*O,i),PMatrixScale(e,.6,-.6,i),g(a,i),m(e.data,a),n(null,"<< /Length "+(r=C(a.data,H)).length+" "+H+" >> "),p(null,r),f(),o}function T(e,t){var r,o=-1,a={};return a.data=e,a.posData=0,(r=SVGConvertDataToPDF(a,"","",!1,!0)).data.length&&(o=S(r,t)),o}function I(e){var t;return s(null,"######################## PAGE ########################"),t=u(),ne.push(t),n(null,"<< /Type /Page "),n(null,"/Parent $POSPAGES$ 0 R "),s(null,"Real media size "+e.right+"x"+e.bottom),n(null,"/MediaBox [ 0 0 "+e.right*O+" "+e.bottom*O+" ]"),n(null,"/Contents $POSCONTENTS$ 0 R "),n(null," >> "),f(),se=[O,0,0,-.6,V*O,e.bottom*O],t}function A(e){k("$POSCONTENTS$",e)}function L(e,t){var r,a,i=function(){for(var e=[],t=0,r=0,o=ie.data;r<o.length;){if(" obj"==o.substring(r,r+4)){for(var a=r,n=!0,i=0;o.substring(r-1,r)>=" "&&r>=0&&n;)" "===o.substring(r,r+1)?++i>2&&(n=!1):o.substring(r,r+1)<"0"?n=!1:o.substring(r,r+1)>"9"&&(n=!1),r--;n&&(e.push(r),t++),r=a}r++}return t!=Q&&console.log("PDFRebuildXRef err, number of objects don't match."),e}();for(s(null,"######################## XREF ########################"),r=function(e){return o(e).data.length}(null),n(null,"xref"),n(null,"0 "+(Q+1)),n(null,"0000000000 65535 f "),a=0;Q>a;a++)n(null,i[a]+" 00000 n ");n(null,"trailer << "),n(null,"/Size "+(Q+1)+" "),n(null,"/Root "+e+" 0 R "),t&&n(null,"/Info "+t+" 0 R "),n(null," >> "),n(null,"startxref"),n(null,r),n(null,"%%EOF")}function G(){MyrPDFDict.PDFDisposeDict(J),MyrPDFDict.PDFDisposeDict(q),MyrPDFDict.PDFDisposeDict(ee),MyrPDFDict.PDFDisposeDict(te),MyrPDFDict.PDFDisposeDict(re),MyrPDFDict.PDFDisposeDict(oe),MyrPDFDict.PDFDisposeDict(ae)}function E(e){s(null,"######################## FOOTER ########################"),L(function(e){var t;return s(null,"######################## CATALOG ########################"),t=u(),n(null,"<< /Type /Catalog "),n(null,"/Pages "+e+" 0 R >> "),s(null,"End catalog"),f(),t}(function(){var e,t;for(s(null,"######################## PAGES LIST ########################"),t=u(),n(null,"<< /Type /Pages "),n(null,"/Count "+ne.length+" "),a(null,"/Kids ["),e=0;e<ne.length;e++)a(null,ne[e]+" 0 R ");return n(null,"] "),n(null,"/Resources << /ProcSet [/PDF /Text /ImageC /ImageI /ImageB ] "),n(null,"$FONTDICT$ "),n(null,"$XOBJECTS$ "),n(null,"$PATTERN$ "),n(null," >> "),n(null," >> "),f(),k("$POSPAGES$",t),k("$POSRESOURCES$",Q-1),MyrPDFDict.PDFAddDict(q,re),w(J,"Font","$FONTDICT$",!0),w(re,"XObject","$XOBJECTS$",!1),w(ee,"Pattern","$PATTERN$",!1),t}()),e),n(null,"%____ SvgToPdf Javascript converter "+N+" ____"),n(null,"%____ (c) MYRIAD Software myriad-online.com 2018 ____"),n(null,"%____ "+Date()+" ____")}function _(e,t){n(null,"/"+e+" ("+t+")")}var z=!0,R=0,N="1.0.1";const O=.6,B="",U="/Filter /ASCIIHexDecode",H=B,W=U,j=B;var K,$,V,Q,Y,X,Z={},J=[],q=[],ee=[],te=[],re=[],oe=[],ae=[],ne=[],ie={},se=[1,0,0,1,0,0],le=[];MyrPDF.PDFInit=function(){G(),Q=0,Y=0,K=$=0,r(0,0),X=0,K=$=0,(ie={}).name="PDF Stream",ie.data="",ne=[],n(null,"%PDF-1.4"),n(null,"%####")},MyrPDF.PDFValidate=function(e){return E(function(){var e;return s(null,"######################## INFOS ########################"),e=u(),n(null,"<< "),_("Creator","SvgToPdf"),_("Keywords","music myriad svgtopdf myrweb"),n(null,">> "),f(),e}()),ie.data},MyrPDF.PDFAddPosObject=u,MyrPDF.PDFBuildPage=function(e,t){var r;return I(t),A(r=T(e,t)),r>=0},MyrPDF.PDFBuildPageContent=T,MyrPDF.PDFOpenPage=I,MyrPDF.PDFClosePage=A,MyrPDF.PDFDispose=function(){G(),ne=[],ie.data=""},MyrPDF.PDFBuildFooter=E,MyrPDF.PDFComment=s,MyrPDF.PDFAddFont=function(e,t,r,o){var a;return a=u(),function(e,t,r,o,a){s(e,"Font definition : "+t),n(e,"<< /Type /Font /Subtype /"+o+" /Name /"+r+" /BaseFont /"+t+" "+a+" >> ")}(null,e,t,r,o),MyrPDFDict.PDFAddEntry(J,e,t,a,0),f(),a},MyrPDF.PDFStartTextObject=function(e){s(e,"PDFStartTextObject"),l(e),n(e,"BT")},MyrPDF.PDFTextFontNameAndSize=function(e,t,r){s(e,"PDFTextFontNameAndSize ("+t+")  size : "+r),t.length&&n(e,"/"+t+" "+r+" Tf")},MyrPDF.PDFTextMoveTo=function(e,t,r){s(e,"PDFTextMoveTo"+t+" "+r),n(e,"1 0 0 -1 "+t+" "+r+" Tm")},MyrPDF.PDFTextShow=function(e,t){t=function(e){for(var t="",r=0;r<e.length;){switch(e.substring(r,r+1)){case 10:t+="\\n";break;case 13:t+="\\r";break;case 9:t+="\\t";break;case"(":t+="\\(";break;case")":t+="\\)";break;case"\\":t+="\\\\";break;default:t+=e.substring(r,r+1)}r++}return t}(t),s(e,"PDFTextShow ("+t+")"),n(e,"("+t+") Tj")},MyrPDF.PDFEndTextObject=function(e){s(e,"PDFEndTextObject"),n(e,"ET"),d(e)},MyrPDF.PDFFillColor=function(e,t,r){M(e,t,r,!0)&&(s(e,"PDFFillColor "+t),n(e,"rg"))},MyrPDF.PDFStrokeColor=function(e,t,r){M(e,t,r,!1)&&(s(e,"PDFStrokeColor "+t),n(e,"RG"))},MyrPDF.PDFPushContext=l,MyrPDF.PDFPushContext=l,MyrPDF.PDFPopContext=d,MyrPDF.PDFOpacity=function(e,t){"none"!=t&&t.length},MyrPDF.PDFClearBBox=function(){Z.left=Z.top=9999999,Z.right=Z.bottom=-9999999},MyrPDF.PDFGetBBox=t,MyrPDF.PDFSetOffset=r,MyrPDF.PDFLineWidth=function(e,t){"none"!=t&&t.length>0&&(s(e,"PDFLineWidth "+t),n(e,t+" w"))},MyrPDF.PDFLineCap=function(e,t){t&&t.length>0&&(s(e,"PDFLineCap "+t),stricmp(t,"butt")||n(e,"0 J"),stricmp(t,"round")||n(e,"1 J"),stricmp(t,"square")||n(e,"2 J"))},MyrPDF.PDFMoveTo=h,MyrPDF.PDFMoveRel=function(t,r,o){s(t,"PDFMoveRel "+r+" "+o),$+=o,c(t,K+=r),c(t,$),n(t,"m"),e(K,$)},MyrPDF.PDFLineTo=function(t,r,o){s(t,"PDFLineTo "+r+" "+o),c(t,r),c(t,o),n(t,"l"),K=r,$=o,e(r,o)},MyrPDF.PDFLineRel=function(t,r,o){s(t,"PDFLineRel "+r+" "+o),$+=o,c(t,K+=r),c(t,$),n(t,"l"),e(K,$)},MyrPDF.PDFCurve=x,MyrPDF.PDFCurveRel=function(t,r,o,a,i,l,d){s(t,"PDFCurveRel"),c(t,K+r),c(t,$+o),c(t,K+a),c(t,$+i),c(t,K+l),c(t,$+d),n(t,"c"),e(K+r,$+o),e(K+a,$+i),e(K+l,$+d),K+=l,$+=d},MyrPDF.PDFStroke=b,MyrPDF.PDFClip=function(e){s(e,"PDFClip"),n(e,"W")},MyrPDF.PDFEndPathNoPaint=function(e){s(e,"PDFEndPathNoPaint"),n(e,"n")},MyrPDF.PDFFillAndStroke=function(e){s(e,"PDFFillAndStroke"),n(e,"B")},MyrPDF.PDFFill=function(e){s(e,"PDFFill"),n(e,"f")},MyrPDF.PDFStroke=b,MyrPDF.PDFForgetPath=function(e){s(e,"PDFForgetPath"),n(e,"n")},MyrPDF.PDFRect=function(e,t,r,o,a){s(e,"PDFRect "+t+" "+r+" "+o+" "+a),c(e,t),c(e,r),c(e,o),c(e,a),n(e,"re")},MyrPDF.PDFEllipse=function(e,t,r,o,a){var n,i,l,d,y,c;s(e,"PDFEllipse "+t+" "+r+" "+o+" "+a),t=parseInt(t),r=parseInt(r),l=t-(o=parseInt(o)),d=r-(a=parseInt(a)),y=t+o,c=r+a,n=parseInt(t),i=parseInt(r),o=.552284749831*parseInt(o),a=.552284749831*parseInt(a),h(e,n,d),x(e,n+o,d,y,i-a,y,i),x(e,y,i+a,n+o,c,n,c),x(e,n-o,c,l,i+a,l,i),x(e,l,i-a,n-o,d,n,d)},MyrPDF.PDFClosePath=function(e){s(e,"PDFClosePath"),n(e,"h")},MyrPDF.PDFEndPosObject=f,MyrPDF.PDFMatrixWrite=g,MyrPDF.PDFWriteDo=D,MyrPDF.PDFWritePageContent=S,MyrPDF.PDFWriteNoRc=a,MyrPDF.PDFWriteForm=function(e,r){var o,a;return o=t(),n(e,"<</Length "+(a=C(r,j)).length+" /Type /XObject /Subtype /Form /BBox ["+o.left+" "+o.top+" "+o.right+" "+o.bottom+" ] /Matrix [1 0 0 1 0 0]   >> "),p(e,a),0},MyrPDF.PDFWriteGradient=v,MyrPDF.PDFWriteStreamImageAndFreeSource=function(e,t,r,o,a,i){encoded=C(t,W),n(e,"<</Length "+encoded.length+" /Type /XObject /Subtype /Image /Width "+r+" /Height "+o+" /BitsPerComponent 8 "+W),n(e,a?"/ColorSpace /DeviceRGB ":"/ColorSpace /DeviceGray "),i&&n(e,"/SMask "+i+" 0 R"),n(e," >> "),p(e,encoded)},MyrPDF.PDFWriteImage=function(e,t,r,o,a,n,i){var s,y=[];s="Image"+ ++Y,MyrPDFDict.PDFAddEntry(re,s,s,t,0),l(e),PMatrixSet(e,n,0,0,-i,o,a+i,y),g(e,y),D(e,s),d(e)},MyrPDF.PDFdictFonts=J,MyrPDF.PDFdictPaths=q,MyrPDF.PDFdictGradients=ee,MyrPDF.PDFdictSVGGradients=te,MyrPDF.PDFdictClip=oe}(),!MyrZip)var MyrZip={author:"Myriad"};MyrZip.UnzipBlock=function(e,t,r,o){"use strict";function a(e,t){for(e.bitbuf=32==t?0:e.bitbuf<<t>>>0;t>e.bitcount;)e.bitbuf|=e.subbitbuf<<(t-=e.bitcount)>>>0,e.ridx!=e.rsize?e.subbitbuf=e.rdata[e.ridx++]:e.subbitbuf=0,e.bitcount=f;e.bitbuf|=e.subbitbuf>>>(e.bitcount-=t),e.bitbuf>>>=0}function n(e,t){var r;return 0===t?0:(r=e.bitbuf>>>p-t,a(e,t),r)}function i(e,t,r,o,a){var n,i,s,l,d,y,c,u,f,m,p=[],M=[],g=[];for(s=1;16>=s;s++)p[s]=0;for(s=0;t>s;s++)p[r[s]]++;for(g[1]=0,s=1;16>=s;s++)g[s+1]=g[s]+(p[s]<<16-s&65535)&65535;for(0!==g[17]&&alert("Bad table"),c=16-o,s=1;o>=s;s++)g[s]>>=c,M[s]=1<<o-s&65535;for(;16>=s;)M[s]=1<<16-s&65535,s++;if(65536!=(s=g[o+1]>>c))for(l=1<<o&65535;s!=l;)a[s++]=0;for(u=t,m=1<<15-o,y=0;t>y;y++)if(0!==(d=r[y])){if(f=g[d]+M[d]>>>0,o>=d)for(s=g[d];f>s;s++)a[s]=y;else{for(n=a,i=(l=g[d])>>>c,s=d-o;0!==s;)0===n[i]&&(e.right[u]=e.left[u]=0,n[i]=u++),l&m?(i=n[i],n=e.right):(i=n[i],n=e.left),l=l<<1>>>0,s--;n[i]=y}g[d]=f}}function s(e,t,r,o){var s,l,d,y;if(0===(d=n(e,r))){for(l=n(e,r),s=0;t>s;s++)e.pt_len[s]=0;for(s=0;256>s;s++)e.pt_table[s]=l}else{for(s=0;d>s;){if(7==(l=e.bitbuf>>>p-3))for(y=1<<p-1-3>>>0;y&e.bitbuf;)y>>>=1,l++;if(a(e,7>l?3:l-3),e.pt_len[s++]=l,s==o)for(l=n(e,2);--l>=0;)e.pt_len[s++]=0}for(;t>s;)e.pt_len[s++]=0;i(e,t,e.pt_len,8,e.pt_table)}}function l(e){var t,r;if(0===e.blocksize&&(e.blocksize=n(e,16),s(e,x,P,3),function(e){var t,r,o,s;if(0===(o=n(e,v))){for(r=n(v),t=0;h>t;t++)e.c_len[t]=0;for(t=0;4096>t;t++)e.c_table[t]=r}else{for(t=0;o>t;){if((r=e.pt_table[e.bitbuf>>>p-8])>=x){s=1<<p-1-8>>>0;do{r=e.bitbuf&s?e.right[r]:e.left[r],s>>>=1}while(r>=x)}if(a(e,e.pt_len[r]),2>=r)for(r=0===r?1:1===r?n(e,4)+3:n(e,v)+20;--r>=0;)e.c_len[t++]=0;else e.c_len[t++]=r-2}for(;h>t;)e.c_len[t++]=0;i(e,h,e.c_len,12,e.c_table)}}(e),s(e,b,D,-1)),e.blocksize--,(t=e.c_table[e.bitbuf>>>p-12])>=h){r=1<<p-1-12>>>0;do{t=e.bitbuf&r?e.right[t]:e.left[t],r>>>=1}while(t>=h)}return a(e,e.c_len[t]),t}function d(e){var t,r;if((t=e.pt_table[e.bitbuf>>>p-8])>=b){r=1<<p-1-8>>>0;do{t=e.bitbuf&r?e.right[t]:e.left[t],r>>>=1}while(t>=b)}return a(e,e.pt_len[t]),0!==t&&(t=(1<<t-1)+n(e,t-1)>>>0),t}function y(e,t){var r;for(r=0;t>r&&--e.j>=0;)e.buffer[r]=e.buffer[e.i],e.i=e.i+1&M-1,r++;for(;t>r;)if(e.c=l(e),e.c<=m)e.buffer[r]=e.c,r++;else for(e.j=e.c-(m+1-g),e.i=r-d(e)-1&M-1;t>r&&--e.j>=0;)e.buffer[r]=e.buffer[e.i],e.i=e.i+1&M-1,r++;return r}var c,u={},f=8,m=255,p=4*f,M=8192,g=3,h=m+256+2-g,v=9,b=14,x=19,D=4,P=5;for(c=x>b?x:b,u.rdata=e,u.ridx=t,u.rsize=r+t,u.wdata=new Uint8Array(o),u.widx=0,u.wsize=o,u.buffer=new Uint8Array(M),u.j=u.i=0,u.left=new Int16Array(2*h-1),u.right=new Int16Array(2*h-1),u.c_len=new Uint8Array(h),u.pt_len=new Uint8Array(c),u.blocksize=0,u.c_table=new Int16Array(4096),u.c_code=new Int16Array(h),u.pt_table=new Int16Array(256),function(e){(function(e){e.bitbuf=0,e.subbitbuf=0,e.bitcount=0,a(e,p)})(e),e.blocksize=0}(u);u.widx<u.wsize;){var k=u.wsize-u.widx>M?M:u.wsize-u.widx;if(y(u,k),k==M)u.wdata.set(u.buffer,u.widx),u.widx+=k;else for(var w=0;k>w;w++)u.wdata[u.widx++]=u.buffer[w]}u.buffer=null,u.left=null,u.right=null,u.c_len=null,u.pt_len=null,u.c_table=null,u.c_code=null;var F=u.wdata;return u.ridx==u.rsize&&u.widx==u.wsize||alert("Error unzipblock"),u=null,F};var PNG_COLOR_TYPE_GREYSCALE=0,PNG_COLOR_TYPE_TRUECOLOR=2,PNG_COLOR_TYPE_INDEXEDCOLOR=3,PNG_COLOR_TYPE_GREYSCALE_ALPHA=4,PNG_COLOR_TYPE_TRUECOLOR_ALPHA=6,PNG_FILTER_NONE=0,PNG_FILTER_SUB=1,PNG_FILTER_UP=2,PNG_FILTER_AVERAGE=3,PNG_FILTER_PAETH=4;if(!MyrPNG)var MyrPNG={author:"Didier Guillion",name:"PNG file format"};if(function(){function e(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function t(e){var t,r=new Uint8Array(e.length);for(t=0;t<e.length;t++)r[t]=e.charCodeAt(t);return r}function r(e,t){var r,o=new Uint8Array(t);for(r=0;t>r;r++)o[r]=e.data[e.pos],e.pos++;return o}function o(e){return r(e,1)[0]}function a(e){var t,r=0;for(t=0;4>t;t++)r=256*r+o(e);return r}function n(e){var t;for(t=0;8>t;t++)if(e[t]!=i[t])return!1;return!0}var i=[137,80,78,71,13,10,26,10],s=1229472850,l=1347175749,d=1229209940,y=1229278788,c=1883789683,u=1936292453;MyrPNG.PNGSplitRGBandAlpha=function(t,r,o){var a,n,i,s,l={},d=0;for(i=new Uint8Array(r*o*3),s=new Uint8Array(r*o*1),n=0;o>n;n++)for(a=0;r>a;a++)i[3*n*r+3*a]=t[d++],i[3*n*r+3*a+1]=t[d++],i[3*n*r+3*a+2]=t[d++],s[n*r+a]=t[d++];return l.rgbdata=e(i),l.maskdata=e(s),l},MyrPNG.PNGDecodeIDAT=function(e,t,r,o){var a,n,i,s,l,d,y,c,u,f,m,p,M,g,h="",v=0;for(g=(M=function(e){switch(e){case PNG_COLOR_TYPE_GREYSCALE:return 1;case PNG_COLOR_TYPE_TRUECOLOR:return 3;case PNG_COLOR_TYPE_INDEXEDCOLOR:return 1;case PNG_COLOR_TYPE_GREYSCALE_ALPHA:return 3;case PNG_COLOR_TYPE_TRUECOLOR_ALPHA:return 4}return 0}(o))*t,h=new Uint8Array(g*r),n=0;r>n;n++)for(i=e[v++],l=g*n,a=0;g>a;a++){switch(s=e[v++],i){case PNG_FILTER_NONE:break;case PNG_FILTER_SUB:a>=M&&(s+=h[l-M]);break;case PNG_FILTER_UP:n>0&&(s+=h[l-g]);break;case PNG_FILTER_AVERAGE:s+=((d=a>=M?h[l-M]:0)+(y=n>0?h[l-g]:0))/2;break;case PNG_FILTER_PAETH:u=(d=a>=M?h[l-M]:0)+(y=n>0?h[l-g]:0)-(c=a>=M&&n>0?h[l-g-M]:0),f=abs(u-d),m=abs(u-y),p=abs(u-c),s+=m>=f&&p>=f?d:p>=m?y:c;break;default:return h}h[l++]=s}return h},MyrPNG.PNGDecode=function(e){var i,f,m={},p=0,M=!0,g={};if(m.data="",m.uncompressedDataSize=-1,m.aire={},SetBigRect(m.aire,0,0,0,0),m.colorType=0,m.bitDepth=0,m.palette=null,m.messErr="",m.interlaceMethod=0,m.compressionMethod=0,m.filterMethod=0,g.data=t(e),g.pos=0,n(r(g,8)))for(;g.pos<g.data.length&&p!=y&&!0===M;){switch(f=a(g),p=a(g),i=g.pos,p){case s:m.aire.right=a(g),m.aire.bottom=a(g),m.bitDepth=o(g),8!=m.bitDepth&&1!=m.bitDepth&&4!=m.bitDepth&&(m.messErr="bad bitDepth: "+bitDepth,M=!1),m.colorType=o(g),m.compressionMethod=o(g),m.filterMethod=o(g),m.interlaceMethod=o(g),0!==m.interlaceMethod&&(m.messErr="bad interlace",M=!1);break;case d:m.data=r(g,f);break;case l:m.palette=r(g,f);break;case c:a(g),a(g),o(g);break;case u:m.uncompressedDataSize=a(g)}g.pos=i+f,a(g)}else m.messErr="bad header";return m.colorType==PNG_COLOR_TYPE_INDEXEDCOLOR&&null===m.palette&&(m.messErr="PNG_COLOR_TYPE_INDEXEDCOLOR with no PLTE chunk"),m},MyrPNG.IsPNGSignature=n,MyrPNG.CvtUint8toString=e,MyrPNG.CvtStringToUint8=t}(),PNGSplitRGBandAlpha=MyrPNG.PNGSplitRGBandAlpha,PNGDecodeIDAT=MyrPNG.PNGDecodeIDAT,PNGDecode=MyrPNG.PNGDecode,IsPNGSignature=MyrPNG.IsPNGSignature,!MyrLZ77)var MyrLZ77={author:"LZ77"};if(function(){var e,t,r,o,a,n,i,s,l,d,y,c,u,f,m,p,M,g=32768,h=null,v=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535),b=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0),x=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99),D=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577),P=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13),k=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15),w=function(){this.next=null,this.list=null},F=function(){this.e=0,this.b=0,this.n=0,this.t=null},C=function(e,t,r,o,a,n){this.BMAX=16,this.N_MAX=288,this.status=0,this.root=null,this.m=0;var i,s,l,d,y,c,u,f,m,p,M,g,h,v,b,x,D,P=new Array(this.BMAX+1),k=new Array(this.BMAX+1),C=new F,S=new Array(this.BMAX),T=new Array(this.N_MAX),I=new Array(this.BMAX+1);for(D=this.root=null,c=0;c<P.length;c++)P[c]=0;for(c=0;c<k.length;c++)k[c]=0;for(c=0;c<S.length;c++)S[c]=null;for(c=0;c<T.length;c++)T[c]=0;for(c=0;c<I.length;c++)I[c]=0;s=t>256?e[256]:this.BMAX,m=e,p=0,c=t;do{P[m[p]]++,p++}while(--c>0);if(P[0]==t)return this.root=null,this.m=0,void(this.status=0);for(u=1;u<=this.BMAX&&0==P[u];u++);for(f=u,u>n&&(n=u),c=this.BMAX;0!=c&&0==P[c];c--);for(d=c,n>c&&(n=c),v=1<<u;c>u;u++,v<<=1)if((v-=P[u])<0)return this.status=2,void(this.m=n);if((v-=P[c])<0)return this.status=2,void(this.m=n);for(P[c]+=v,I[1]=u=0,m=P,p=1,h=2;--c>0;)I[h++]=u+=m[p++];m=e,p=0,c=0;do{0!=(u=m[p++])&&(T[I[u]++]=c)}while(++c<t);for(t=I[d],I[0]=c=0,m=T,p=0,y=-1,g=k[0]=0,M=null,b=0;d>=f;f++)for(i=P[f];i-- >0;){for(;f>g+k[1+y];){if(g+=k[1+y],y++,b=(b=d-g)>n?n:b,(l=1<<(u=f-g))>i+1)for(l-=i+1,h=f;++u<b&&!((l<<=1)<=P[++h]);)l-=P[h];for(g+u>s&&s>g&&(u=s-g),b=1<<u,k[1+y]=u,M=new Array(b),x=0;b>x;x++)M[x]=new F;(D=null==D?this.root=new w:D.next=new w).next=null,D.list=M,S[y]=M,y>0&&(I[y]=c,C.b=k[y],C.e=16+u,C.t=M,u=(c&(1<<g)-1)>>g-k[y],S[y-1][u].e=C.e,S[y-1][u].b=C.b,S[y-1][u].n=C.n,S[y-1][u].t=C.t)}for(C.b=f-g,p>=t?C.e=99:m[p]<r?(C.e=m[p]<256?16:15,C.n=m[p++]):(C.e=a[m[p]-r],C.n=o[m[p++]-r]),l=1<<f-g,u=c>>g;b>u;u+=l)M[u].e=C.e,M[u].b=C.b,M[u].n=C.n,M[u].t=C.t;for(u=1<<f-1;0!=(c&u);u>>=1)c^=u;for(c^=u;(c&(1<<g)-1)!=I[y];)g-=k[y],y--}this.m=k[1],this.status=0!=v&&1!=d?1:0},S=function(e){for(;e>i;)n|=(p.length==M?-1:p[M++])<<i,i+=8},T=function(e){return n&v[e]},I=function(e){n>>=e,i-=e},A=function(r,o,a){var n,i,l;if(0==a)return 0;for(l=0;;){for(S(f),n=(i=c.list[T(f)]).e;n>16;){if(99==n)return-1;I(i.b),S(n-=16),n=(i=i.t[T(n)]).e}if(I(i.b),16!=n){if(15==n)break;for(S(n),d=i.n+T(n),I(n),S(m),n=(i=u.list[T(m)]).e;n>16;){if(99==n)return-1;I(i.b),S(n-=16),n=(i=i.t[T(n)]).e}for(I(i.b),S(n),y=t-i.n-T(n),I(n);d>0&&a>l;)d--,y&=g-1,t&=g-1,r[o+l++]=e[t++]=e[y++];if(l==a)return a}else if(t&=g-1,r[o+l++]=e[t++]=i.n,l==a)return a}return s=-1,l},L=function(r,o,a){var l;if(I(l=7&i),S(16),l=T(16),I(16),S(16),l!=(65535&~n))return-1;for(I(16),d=l,l=0;d>0&&a>l;)d--,t&=g-1,S(8),r[o+l++]=e[t++]=T(8),I(8);return 0==d&&(s=-1),l},G=function(e,t,n){if(null==h){var i,s,l=new Array(288);for(i=0;144>i;i++)l[i]=8;for(;256>i;i++)l[i]=9;for(;280>i;i++)l[i]=7;for(;288>i;i++)l[i]=8;if(0!=(s=new C(l,288,257,b,x,o=7)).status)return alert("HufBuild error: "+s.status),-1;for(h=s.root,o=s.m,i=0;30>i;i++)l[i]=5;if((s=new C(l,30,0,D,P,a=5)).status>1)return h=null,alert("HufBuild error: "+s.status),-1;r=s.root,a=s.m}return c=h,u=r,f=o,m=a,A(e,t,n)},E=function(e,t,r){var o,a,n,i,s,l,d,y,p,M=new Array(316);for(o=0;o<M.length;o++)M[o]=0;if(S(5),d=257+T(5),I(5),S(5),y=1+T(5),I(5),S(4),l=4+T(4),I(4),d>286||y>30)return-1;for(a=0;l>a;a++)S(3),M[k[a]]=T(3),I(3);for(;19>a;a++)M[k[a]]=0;if(0!=(p=new C(M,19,19,null,null,f=7)).status)return-1;for(c=p.root,f=p.m,i=d+y,o=n=0;i>o;)if(S(f),a=(s=c.list[T(f)]).b,I(a),16>(a=s.n))M[o++]=n=a;else if(16==a){if(S(2),a=3+T(2),I(2),o+a>i)return-1;for(;a-- >0;)M[o++]=n}else if(17==a){if(S(3),a=3+T(3),I(3),o+a>i)return-1;for(;a-- >0;)M[o++]=0;n=0}else{if(S(7),a=11+T(7),I(7),o+a>i)return-1;for(;a-- >0;)M[o++]=0;n=0}if(p=new C(M,d,257,b,x,f=9),0==f&&(p.status=1),0!=p.status)return p.status,-1;for(c=p.root,f=p.m,o=0;y>o;o++)M[o]=M[o+d];return p=new C(M,y,0,D,P,m=6),u=p.root,0==(m=p.m)&&d>257?-1:(p.status,0!=p.status?-1:A(e,t,r))},_=function(){null==e&&(e=new Array(2*g)),t=0,n=0,i=0,s=-1,l=!1,d=y=0,c=null},z=function(r,o,a){var n,i;for(n=0;a>n;){if(l&&-1==s)return n;if(d>0){if(0!=s)for(;d>0&&a>n;)d--,y&=g-1,t&=g-1,r[o+n++]=e[t++]=e[y++];else{for(;d>0&&a>n;)d--,t&=g-1,S(8),r[o+n++]=e[t++]=T(8),I(8);0==d&&(s=-1)}if(n==a)return n}if(-1==s){if(l)break;S(1),0!=T(1)&&(l=!0),I(1),S(2),s=T(2),I(2),c=null,d=0}switch(s){case 0:i=L(r,o+n,a-n);break;case 1:i=null!=c?A(r,o+n,a-n):G(r,o+n,a-n);break;case 2:i=null!=c?A(r,o+n,a-n):E(r,o+n,a-n);break;default:i=-1}if(-1==i)return l?0:-1;n+=i}return n};MyrLZ77.inflate=function(e,t){var r,o;_(),p=e,M=t;for(var a=new Uint8Array(1024),n=[],i=0;(r=z(a,0,a.length))>0;){i+=r;var s=new Uint8Array(r);if(1024==r)s.set(a,0);else for(o=0;r>o;o++)s[o]=a[o];n.push(s)}p=null,a=null;var l=new Uint8Array(i),d=0;for(r=0;r<n.length;r++)l.set(n[r],d),d+=n[r].length,n[r]=null;return l}}(),!MyrStdLib)var MyrStdLib={author:"Didier Guillion",name:"CLib"};if(function(){MyrStdLib.abs=function(e){return e>0?e:-e},MyrStdLib.atol=function(e){return parseInt(e)},MyrStdLib.atof=function(e){return parseFloat(e)},MyrStdLib.strstr=function(e,t){alert("strstr not implemented use strexist (or other)")},MyrStdLib.strexist=function(e,t){return e.indexOf(t)>=0},MyrStdLib.strcmp=function(e,t){return e!=t},MyrStdLib.stricmp=function(e,t){return e.toUpperCase()!=t.toUpperCase()},MyrStdLib.strncmp=function(e,t,r){return e.substring(0,r)!=t.substring(0,r)},MyrStdLib.strcasecmp=function(e,t){return e.toLowerCase()!=t.toLowerCase()}}(),abs=MyrStdLib.abs,atol=MyrStdLib.atol,atof=MyrStdLib.atof,strstr=MyrStdLib.strstr,strexist=MyrStdLib.strexist,strcmp=MyrStdLib.strcmp,stricmp=MyrStdLib.stricmp,strncmp=MyrStdLib.strncmp,strcasecmp=MyrStdLib.strcasecmp,!MyrUnicode)var MyrUnicode={author:"Didier Guillion",name:"Unicode Converter"};!function(){function e(e){var r;if(128>e)return e;for(r=0;r<t.length;r++)if(t[r]===e)return r+128;return"?"}const t=[196,197,199,201,209,214,220,225,224,226,228,227,229,231,233,232,234,235,237,236,238,239,241,243,242,244,246,245,250,249,251,252,8224,176,162,163,167,8226,182,223,174,169,8482,180,168,8800,198,216,8734,177,8804,8805,165,181,8706,8721,8719,960,8747,170,186,937,230,248,191,161,172,8730,402,8776,8710,171,187,8230,160,192,195,213,338,339,8211,8212,8220,8221,8216,8217,247,9674,255,376,8260,8364,8249,8250,64257,64258,8225,183,8218,8222,8240,194,202,193,203,200,205,206,207,204,211,212,63743,210,218,219,217,305,710,732,175,728,729,730,184,733,731,711];MyrUnicode.CharUnicodeToMacRoman=e,MyrUnicode.UnicodeToMacRoman=function(t){var r,o="";for(r=0;r<t.length;r++)o+=String.fromCharCode(e(t.charCodeAt(r)));return o}}(),CharUnicodeToMacRoman=MyrUnicode.CharUnicodeToMacRoman,UnicodeToMacRoman=MyrUnicode.UnicodeToMacRoman;//# sourceMappingURL=http://192.168.0.5/Developt/Maps/myrweb.map